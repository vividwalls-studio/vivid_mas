{% comment %}
  VividWalls Main Product Page Template
  Based on Figma Design: main-product-page
  Generated from Figma file: Zyf3Jzlno3N8bopTsGnpZH
{% endcomment %}

<style>
  /* Import Figma Design System Colors */
  :root {
    --vw-bg-primary: #fafafa;
    --vw-text-primary: #000000;
    --vw-text-secondary: #71717a;
    --vw-text-muted: #525252;
    --vw-accent: #09090b;
    --vw-border: #d4d4d4;
    --vw-button-bg: #262626;
    --vw-button-text: #ffffff;
    --vw-tag-bg: #404040;
    --vw-footer-bg: #000000;
    --vw-footer-text: #e5e5e5;
  }

  /* Container Layout - Based on Figma Frame */
  .vw-product-container {
    max-width: 1658px;
    margin: 0 auto;
    padding: 0 279px;
    background-color: var(--vw-bg-primary);
  }

  /* Product Layout Grid */
  .vw-product-grid {
    display: flex;
    gap: 88px;
    margin-bottom: 59px;
  }

  /* Artwork Container */
  .vw-artwork-container {
    flex: 1;
    max-width: 600px;
  }

  .vw-artwork-image {
    width: 100%;
    height: auto;
    border-radius: 8px;
  }

  /* Product Details */
  .vw-product-details {
    flex: 1;
    max-width: 496px;
  }

  .vw-product-title {
    font-family: 'Inter', sans-serif;
    font-size: 40px;
    font-weight: 400;
    line-height: 48.41px;
    color: var(--vw-text-primary);
    margin-bottom: 16px;
  }

  .vw-artist-info {
    font-family: 'Inter', sans-serif;
    font-size: 16px;
    line-height: 19.36px;
    color: var(--vw-text-secondary);
    margin-bottom: 24px;
  }

  .vw-artist-name {
    font-weight: 400;
  }

  .vw-artist-label {
    font-style: italic;
  }

  /* Product Tags */
  .vw-product-tags {
    display: flex;
    gap: 8px;
    margin-bottom: 24px;
  }

  .vw-tag {
    background-color: var(--vw-accent);
    color: var(--vw-tag-bg);
    padding: 6px 16px;
    border-radius: 4px;
    font-size: 14px;
    font-weight: 500;
  }

  /* Product Description */
  .vw-product-description {
    font-family: 'Inter', sans-serif;
    font-size: 16px;
    line-height: 24px;
    color: var(--vw-tag-bg);
    margin-bottom: 24px;
  }

  .vw-read-more {
    color: var(--vw-text-primary);
    text-decoration: underline;
    cursor: pointer;
  }

  /* Product Dimensions */
  .vw-dimensions {
    display: flex;
    gap: 16px;
    font-size: 14px;
    color: var(--vw-text-muted);
    margin-bottom: 24px;
  }

  /* Product Options */
  .vw-option-group {
    margin-bottom: 24px;
  }

  .vw-option-label {
    font-size: 14px;
    font-weight: 500;
    color: var(--vw-text-primary);
    margin-bottom: 8px;
  }

  .vw-option-selector {
    display: flex;
    gap: 12px;
  }

  .vw-option-button {
    padding: 12px 24px;
    border: 1px solid var(--vw-border);
    background: var(--vw-bg-primary);
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .vw-option-button:hover {
    border-color: var(--vw-text-primary);
  }

  .vw-option-button.selected {
    background: var(--vw-accent);
    color: white;
    border-color: var(--vw-accent);
  }

  /* Quantity Selector */
  .vw-quantity-selector {
    display: flex;
    align-items: center;
    border: 1px solid var(--vw-border);
    border-radius: 4px;
    width: fit-content;
    margin-bottom: 24px;
  }

  .vw-quantity-btn {
    width: 40px;
    height: 40px;
    background: none;
    border: none;
    cursor: pointer;
    font-size: 18px;
  }

  .vw-quantity-input {
    width: 60px;
    text-align: center;
    border: none;
    border-left: 1px solid var(--vw-border);
    border-right: 1px solid var(--vw-border);
    font-size: 16px;
  }

  /* Purchase Buttons */
  .vw-purchase-actions {
    display: flex;
    flex-direction: column;
    gap: 12px;
    margin-bottom: 24px;
  }

  .vw-add-to-cart {
    background: var(--vw-button-bg);
    color: var(--vw-button-text);
    padding: 16px 32px;
    border: none;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 500;
    cursor: pointer;
    transition: opacity 0.2s ease;
  }

  .vw-add-to-cart:hover {
    opacity: 0.9;
  }

  .vw-buy-now {
    background: #4f46e5;
    color: white;
    padding: 16px 32px;
    border: none;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 500;
    cursor: pointer;
  }

  /* Price Display */
  .vw-price-display {
    font-size: 30px;
    font-weight: 500;
    color: var(--vw-text-primary);
    margin-bottom: 8px;
  }

  /* Stock Info */
  .vw-stock-info {
    font-size: 14px;
    color: var(--vw-text-muted);
    margin-bottom: 16px;
  }

  /* Mobile Responsive */
  @media (max-width: 1200px) {
    .vw-product-container {
      padding: 0 40px;
    }
  }

  @media (max-width: 768px) {
    .vw-product-grid {
      flex-direction: column;
      gap: 40px;
    }

    .vw-product-container {
      padding: 0 20px;
    }

    .vw-product-title {
      font-size: 32px;
      line-height: 40px;
    }
  }
</style>

<div class="vw-product-container">
  <!-- Product Grid Layout -->
  <div class="vw-product-grid">
    <!-- Artwork Container -->
    <div class="vw-artwork-container">
      {% if product.featured_image %}
        {{ product.featured_image | image_url: width: 1200 | image_tag:
          class: 'vw-artwork-image',
          loading: 'lazy',
          alt: product.title
        }}
      {% endif %}
      
      <!-- Additional Product Images Gallery -->
      {% if product.images.size > 1 %}
        <div class="vw-image-gallery">
          {% for image in product.images %}
            <div class="vw-gallery-thumb" data-image-id="{{ image.id }}">
              {{ image | image_url: width: 100 | image_tag: loading: 'lazy' }}
            </div>
          {% endfor %}
        </div>
      {% endif %}
    </div>

    <!-- Product Details -->
    <div class="vw-product-details">
      <!-- Product Title -->
      <h1 class="vw-product-title">{{ product.title }}</h1>

      <!-- Artist Information -->
      {% if product.vendor %}
        <div class="vw-artist-info">
          <span class="vw-artist-label">by</span>
          <span class="vw-artist-name">{{ product.vendor }}</span>
        </div>
      {% endif %}

      <!-- Product Tags -->
      {% if product.tags.size > 0 %}
        <div class="vw-product-tags">
          {% for tag in product.tags limit: 3 %}
            <span class="vw-tag">{{ tag }}</span>
          {% endfor %}
        </div>
      {% endif %}

      <!-- Product Description -->
      <div class="vw-product-description">
        {{ product.description | truncate: 200 }}
        <a href="#" class="vw-read-more" data-toggle="description">Read more</a>
        <div class="vw-full-description" style="display: none;">
          {{ product.description }}
        </div>
      </div>

      <!-- Product Dimensions -->
      {% for variant in product.variants %}
        {% if variant == product.selected_or_first_available_variant %}
          <div class="vw-dimensions">
            <span>Width: {{ variant.option1 }}</span>
            <span class="vw-separator">|</span>
            <span>Height: {{ variant.option2 }}</span>
          </div>
        {% endif %}
      {% endfor %}

      <!-- Price Display -->
      <div class="vw-price-display">
        {{ product.price | money }}
      </div>

      <!-- Stock Information -->
      <div class="vw-stock-info">
        {% if product.available %}
          <span>✓ In Stock - Ships within 2-3 business days</span>
        {% else %}
          <span>Out of Stock</span>
        {% endif %}
      </div>

      <!-- Product Form -->
      {% form 'product', product, class: 'vw-product-form' %}
        <!-- Variant Options -->
        {% unless product.has_only_default_variant %}
          {% for option in product.options_with_values %}
            <div class="vw-option-group">
              <label class="vw-option-label">{{ option.name }}</label>
              <div class="vw-option-selector">
                {% for value in option.values %}
                  <button type="button" 
                          class="vw-option-button {% if option.selected_value == value %}selected{% endif %}"
                          data-option-name="{{ option.name }}"
                          data-option-value="{{ value }}">
                    {{ value }}
                  </button>
                {% endfor %}
              </div>
            </div>
          {% endfor %}
        {% endunless %}

        <!-- Quantity Selector -->
        <div class="vw-quantity-selector">
          <button type="button" class="vw-quantity-btn" data-action="decrease">−</button>
          <input type="number" 
                 name="quantity" 
                 class="vw-quantity-input" 
                 value="1" 
                 min="1" 
                 max="{{ product.selected_or_first_available_variant.inventory_quantity }}">
          <button type="button" class="vw-quantity-btn" data-action="increase">+</button>
        </div>

        <!-- Purchase Actions -->
        <div class="vw-purchase-actions">
          <button type="submit" 
                  name="add" 
                  class="vw-add-to-cart"
                  {% unless product.available %}disabled{% endunless %}>
            {% if product.available %}
              Add to Cart - {{ product.price | money }}
            {% else %}
              Sold Out
            {% endif %}
          </button>

          <!-- Buy it Now - Shopify Dynamic Checkout -->
          {{ form | payment_button }}
        </div>

        <!-- Hidden variant selector for Shopify -->
        <select name="id" style="display: none;">
          {% for variant in product.variants %}
            <option value="{{ variant.id }}" 
                    {% if variant == product.selected_or_first_available_variant %}selected{% endif %}>
              {{ variant.title }}
            </option>
          {% endfor %}
        </select>
      {% endform %}

      <!-- Additional Product Information -->
      <div class="vw-product-meta">
        <p class="vw-sku">SKU: {{ product.selected_or_first_available_variant.sku }}</p>
      </div>
    </div>
  </div>
</div>

<script>
  // Quantity selector functionality
  document.querySelectorAll('.vw-quantity-btn').forEach(btn => {
    btn.addEventListener('click', function() {
      const input = document.querySelector('.vw-quantity-input');
      const currentValue = parseInt(input.value);
      const action = this.dataset.action;
      
      if (action === 'increase') {
        input.value = currentValue + 1;
      } else if (action === 'decrease' && currentValue > 1) {
        input.value = currentValue - 1;
      }
    });
  });

  // Read more functionality
  document.querySelector('.vw-read-more')?.addEventListener('click', function(e) {
    e.preventDefault();
    const fullDesc = document.querySelector('.vw-full-description');
    const truncated = this.previousElementSibling;
    
    if (fullDesc.style.display === 'none') {
      fullDesc.style.display = 'block';
      truncated.style.display = 'none';
      this.textContent = 'Read less';
    } else {
      fullDesc.style.display = 'none';
      truncated.style.display = 'inline';
      this.textContent = 'Read more';
    }
  });

  // Variant option selection
  document.querySelectorAll('.vw-option-button').forEach(btn => {
    btn.addEventListener('click', function() {
      // Update selected state
      this.parentElement.querySelectorAll('.vw-option-button').forEach(b => {
        b.classList.remove('selected');
      });
      this.classList.add('selected');
      
      // Update hidden variant selector
      // This is a simplified version - you'd need more complex logic for multi-option products
      const variantTitle = this.dataset.optionValue;
      const select = document.querySelector('select[name="id"]');
      
      select.querySelectorAll('option').forEach(option => {
        if (option.textContent.includes(variantTitle)) {
          option.selected = true;
        }
      });
    });
  });
</script>