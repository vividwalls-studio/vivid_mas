<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gallery Wrap Test</title>
</head>
<body>
    <h1>Gallery Wrap Checkbox Test</h1>
    
    <!-- Total Price Display -->
    <div class="TotalSelectedPrice" style="padding: 20px; background: #f0f0f0; margin-bottom: 20px;">
        <div class="Dimensions">
            <span class="Width">24</span>
            <span class="Separator">X</span>
            <span class="Height">36</span>
        </div>
        <div class="TotalPrice total-price-display" data-base-price="15300">$153.00 USD</div>
    </div>
    
    <!-- Variant Options -->
    <div class="variant-options" style="margin-bottom: 20px;">
        <div class="variant-option" data-variant-id="1" data-variant-price="15300" data-variant-size="24x36" data-isselected="True" style="padding: 10px; background: #262626; color: white; margin-bottom: 10px; cursor: pointer;">
            <div class="Dimensions">
                <span class="Width">24</span> X <span class="Height">36</span>
            </div>
            <div class="Price">$153.00</div>
        </div>
        
        <div class="variant-option" data-variant-id="2" data-variant-price="23700" data-variant-size="36x48" data-isselected="False" style="padding: 10px; background: #FAFAFA; margin-bottom: 10px; cursor: pointer;">
            <div class="Dimensions">
                <span class="Width">36</span> X <span class="Height">48</span>
            </div>
            <div class="Price">$237.00</div>
        </div>
        
        <div class="variant-option" data-variant-id="3" data-variant-price="41300" data-variant-size="53x72" data-isselected="False" style="padding: 10px; background: #FAFAFA; margin-bottom: 10px; cursor: pointer;">
            <div class="Dimensions">
                <span class="Width">53</span> X <span class="Height">72</span>
            </div>
            <div class="Price">$413.00</div>
        </div>
    </div>
    
    <!-- Gallery Wrap Checkbox -->
    <div style="padding: 20px; background: #FAFAFA; border-radius: 5px;">
        <div class="GalleryWrappedCanvasCheckbox" style="display: inline-flex; align-items: center; gap: 8px;">
            <div class="checkbox-visual" style="width: 16px; height: 16px; background: #FAFAFA; border: 1px solid #D4D4D4; border-radius: 4px; position: relative;">
                <div class="check-icon" style="width: 15px; height: 15px; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); display: none;">
                    <svg width="12" height="10" viewBox="0 0 12 10" fill="none">
                        <path d="M1 4.5L4.5 8L11 1" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
            </div>
            <input type="checkbox" id="gallery-wrap-option" style="position: absolute; opacity: 0; width: 16px; height: 16px; cursor: pointer;">
            <label for="gallery-wrap-option" style="cursor: pointer;">Gallery Wrapped Canvas</label>
        </div>
        <div style="margin-top: 10px; font-size: 12px; color: #737373;">
            24X36 + $75 | 36X48 + $75 | 53X72 + $125
        </div>
    </div>
    
    <!-- Hidden input for form -->
    <input type="hidden" id="gallery-wrap-price" value="0">
    
    <!-- Debug Output -->
    <div id="debug" style="margin-top: 20px; padding: 20px; background: #f9f9f9; font-family: monospace; font-size: 14px;"></div>

    <script>
        // Gallery wrap pricing map
        const galleryWrapPrices = {
            '24x36': 75,
            '36x48': 75,
            '53x72': 125
        };
        
        function debug(message) {
            const debugDiv = document.getElementById('debug');
            debugDiv.innerHTML += message + '<br>';
            console.log(message);
        }
        
        // Get current selected variant size
        function getSelectedVariantSize() {
            const selectedVariant = document.querySelector('.variant-option[data-isselected="True"]');
            debug('Looking for selected variant...');
            if (selectedVariant) {
                const width = selectedVariant.querySelector('.Width').textContent.trim();
                const height = selectedVariant.querySelector('.Height').textContent.trim();
                const size = (width + 'x' + height).toLowerCase();
                debug(`Found selected variant: ${size}`);
                return size;
            }
            debug('No selected variant found');
            return null;
        }
        
        // Update total price based on selections
        function updateTotalPrice() {
            debug('\n--- updateTotalPrice called ---');
            
            const selectedVariant = document.querySelector('.variant-option[data-isselected="True"]');
            const totalPriceDisplay = document.querySelector('.total-price-display');
            const galleryWrapCheckbox = document.getElementById('gallery-wrap-option');
            const galleryWrapPriceInput = document.getElementById('gallery-wrap-price');
            
            if (!selectedVariant || !totalPriceDisplay) {
                debug('Missing required elements');
                return;
            }
            
            const basePrice = parseFloat(selectedVariant.dataset.variantPrice);
            const variantSize = getSelectedVariantSize();
            let additionalPrice = 0;
            
            debug(`Base price: ${basePrice}`);
            debug(`Selected size: ${variantSize}`);
            debug(`Gallery wrap checked: ${galleryWrapCheckbox?.checked}`);
            
            if (galleryWrapCheckbox && galleryWrapCheckbox.checked && variantSize) {
                additionalPrice = galleryWrapPrices[variantSize] || 0;
                debug(`Additional price for gallery wrap: ${additionalPrice}`);
                if (galleryWrapPriceInput) {
                    galleryWrapPriceInput.value = additionalPrice;
                }
            } else {
                if (galleryWrapPriceInput) {
                    galleryWrapPriceInput.value = 0;
                }
            }
            
            const totalPrice = basePrice + (additionalPrice * 100); // Convert to cents
            debug(`Total price in cents: ${totalPrice}`);
            
            const formatter = new Intl.NumberFormat('en-US', {
                style: 'currency',
                currency: 'USD',
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            });
            
            const formattedPrice = formatter.format(totalPrice / 100) + ' USD';
            debug(`Formatted price: ${formattedPrice}`);
            
            totalPriceDisplay.textContent = formattedPrice;
        }
        
        // Gallery wrap checkbox handler
        const galleryWrapCheckbox = document.getElementById('gallery-wrap-option');
        const checkboxVisual = document.querySelector('.checkbox-visual');
        const checkIcon = document.querySelector('.check-icon');
        
        if (galleryWrapCheckbox) {
            galleryWrapCheckbox.checked = false;
            
            galleryWrapCheckbox.addEventListener('change', function() {
                debug(`\nCheckbox changed: ${this.checked}`);
                
                if (this.checked) {
                    checkboxVisual.style.background = '#262626';
                    checkboxVisual.style.border = 'none';
                    checkIcon.style.display = 'flex';
                    checkIcon.style.justifyContent = 'center';
                    checkIcon.style.alignItems = 'center';
                } else {
                    checkboxVisual.style.background = '#FAFAFA';
                    checkboxVisual.style.border = '1px solid #D4D4D4';
                    checkIcon.style.display = 'none';
                }
                updateTotalPrice();
            });
            
            // Set initial state
            checkboxVisual.style.border = '1px solid #D4D4D4';
            checkIcon.style.display = 'none';
        }
        
        // Variant selection
        document.querySelectorAll('.variant-option').forEach(option => {
            option.addEventListener('click', function() {
                debug(`\nVariant clicked: ${this.dataset.variantSize}`);
                
                // Update all variants
                document.querySelectorAll('.variant-option').forEach(opt => {
                    opt.dataset.isselected = 'False';
                    opt.style.background = '#FAFAFA';
                    opt.style.color = '#000';
                });
                
                // Mark this one as selected
                this.dataset.isselected = 'True';
                this.style.background = '#262626';
                this.style.color = '#fff';
                
                // Update total price
                updateTotalPrice();
            });
        });
        
        // Initial price update
        debug('=== Initial Load ===');
        updateTotalPrice();
    </script>
</body>
</html>