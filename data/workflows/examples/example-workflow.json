{
    "nodes": [
      {
        "parameters": {
          "sendTo": "={{ $json['Prospect Email Message'].recipient.emailAddress }}",
          "subject": "={{ $json['Prospect Email Message'].subject }}",
          "message": "={{ $json['Prospect Email Message'].message }}",
          "options": {}
        },
        "type": "n8n-nodes-base.gmail",
        "typeVersion": 2.1,
        "position": [
          4256,
          128
        ],
        "id": "bfd8ad73-9625-46fd-afa4-3000ee160a14",
        "name": "Send Acknowledgment Email To Founder",
        "webhookId": "24b8e625-2935-4bb5-bdca-fdadab60ad1b",
        "credentials": {
          "gmailOAuth2": {
            "id": "vMzyaTna175lWQkR",
            "name": "Gmail account"
          }
        }
      },
      {
        "parameters": {
          "toolDescription": "=Use this tool to search for market trends, size and condutions based on the opportunities sector, industry and business model of the company and the founders name",
          "method": "POST",
          "url": "https://api.perplexity.ai/chat/completions",
          "authentication": "genericCredentialType",
          "genericAuthType": "httpBearerAuth",
          "sendBody": true,
          "specifyBody": "json",
          "jsonBody": "={\n  \"model\": \"sonar\",\n  \"messages\": [\n    {\n      \"role\": \"system\",\n      \"content\": \"You are a venture capital market research assistant. Search for and analyze recent funding rounds with precise filtering. Focus on deal comparables and market intelligence. Provide structured data including company names, funding amounts, valuations, investors, and sectors.\"\n    },\n    {\n      \"role\": \"user\",\n      \"content\": \"Search for market size and conditions for {{ $json.marketSector.allDetected.map(item => item.sector).join(\", \") }}\"\n    }\n  ],\n  \"temperature\": 0.1,\n  \"max_tokens\": 4000,\n  \"frequency_penalty\": 0,\n  \"presence_penalty\": 0\n}",
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequestTool",
        "typeVersion": 4.2,
        "position": [
          2832,
          624
        ],
        "id": "0fc90561-eb80-4d54-9a2c-e99193f23605",
        "name": "Search Market Size & Trends",
        "credentials": {
          "httpBasicAuth": {
            "id": "wItRHc6poXNY2r2R",
            "name": "Perplexity Auth Credential"
          },
          "httpBearerAuth": {
            "id": "ird6xRuFR1U8hI7X",
            "name": "Perplexity Bearer Auth"
          }
        }
      },
      {
        "parameters": {
          "toolDescription": "=Use the search tool to conduct reseach based on research report outlined critreias",
          "url": "=https://www.googleapis.com/customsearch/v1",
          "sendQuery": true,
          "queryParameters": {
            "parameters": [
              {
                "name": "key",
                "value": "AIzaSyB3qqF9QlLRasXs7spQuMd3idwGoSK4QXo"
              },
              {
                "name": "cx",
                "value": "2134b89b0b2f74b9c"
              },
              {
                "name": "q",
                "value": "={{\n  (() => {\n    const urls = [];\n    \n    if ($json.foundersLinkedInUrl && $json.foundersLinkedInUrl.includes(\"linkedin.com\")) {\n      urls.push($json.foundersLinkedInUrl);\n    }\n    \n    const fields = [\"CTO LinkedIn Url\", \"CFO LinkedIn Url\", \"COO LinkedIn Url\", \"CMO LinkedIn Url\"];\n    fields.forEach(field => {\n      const url = $json[field];\n      if (url && url.includes(\"linkedin.com\")) {\n        urls.push(url);\n      }\n    });\n    \n    return urls.length > 0 ? urls.join('\\n') : \"No LinkedIn profiles provided\";\n  })()\n}}"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.httpRequestTool",
        "typeVersion": 4.2,
        "position": [
          2192,
          624
        ],
        "id": "c4b3d1be-114d-4ad7-a81c-911a6afdc900",
        "name": "Search Founders linkedIn profile"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=Use this information to write a professional email to the prospect company and The investment committee team\n",
          "hasOutputParser": true,
          "options": {
            "systemMessage": "=You are an AI assistant specialized in generating professional acknowledgment and internal notification emails for investment proposals.\n\nProcess the data and generate clean, professional messaging HTML email templates for TWO recipients:\n1. **Acknowledgment Email** - Sent to the contact person who submitted the proposal\n2. **Investment Committee Email** - Sent to internal IC team members for review\n\n## Output Format\nGenerate clean, professional HTML email templates with simple black, gray, and white color scheme. Each template should include:\n\n- Clean, minimalist design with proper spacing and typography\n- Mobile-responsive layout\n- Professional appearance with clear visual hierarchy\n- Proper HTML email formatting for maximum compatibility\n- NO emojis or decorative elements\n\n## Tools Required\n- `Send_Email` - For sending both emails\n- `Get_IC_Team_Email` - For retrieving Investment Committee team email addresses\n\n## Available Data Variables\n- Company Name: {{ $('Report Data Prep').item.json.companyName }}\n- Contact Email: {{ $('Report Data Prep').item.json.email }}\n- Contact Person: {{ $('Report Data Prep').item.json.founderName || 'Founder' }}\n- Submission Date: {{ new Date().toLocaleDateString() }}\n- Market Sector: {{ $('Report Data Prep').item.json.marketSector.primary }}\n- Investment Stage: {{ $('Report Data Prep').item.json.companyDetails.stage }}\n\n---\n\n## EMAIL 1: ACKNOWLEDGMENT TO CONTACT PERSON\n\n**Recipient:** {{ $('Report Data Prep').item.json.email }}\n**Contact Person:** {{ $('Report Data Prep').item.json.founderName || 'Founder' }}\n\n**Subject:** {{ $('Report Data Prep').item.json.companyName }} - Investment Proposal Received\n\n**HTML Email Body:**\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Investment Proposal Acknowledgment</title>\n\n</head>\n<body style=\"margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; background-color: #ffffff;\">\n    <table role=\"presentation\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" width=\"100%\" style=\"background-color: #ffffff;\">\n        <tr>\n            <td align=\"center\" style=\"padding: 40px 20px;\">\n                <table role=\"presentation\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" width=\"600\" style=\"background-color: #ffffff; border: 1px solid #e0e0e0;\">\n                    <!-- Header with Logo -->\n                    <tr>\n    <td style=\"background-color: #ffffff; padding: 20px 40px; border-bottom: 1px solid #e0e0e0; text-align: center;\">\n        <!-- Logo Image -->\n        <img src=\"https://drive.google.com/uc?export=view&id=1R8gxDyOYSqHL1hGPYraVYsN-KfbM8Pzv\" \n             alt=\"One Eighty Ventures Logo\" \n             style=\"max-width: 200px; height: auto; display: block; margin: 0 auto 15px auto;\" />\n        \n        <!-- Company Name (fallback if logo doesn't load) -->\n        <h1 style=\"margin: 0; color: #000000; font-size: 24px; font-weight: 400; text-align: center;\">ONE EIGHTY VENTURES</h1>\n        <p style=\"margin: 10px 0 0; color: #666666; font-size: 12px; text-align: center; letter-spacing: 2px; text-transform: uppercase;\">Investment Analysis Team</p>\n    </td>\n</tr>\n                    \n                    <!-- Status Bar -->\n                    <tr>\n                        <td style=\"background-color: #ffffff; padding: 15px 40px; border-bottom: 1px solid #e0e0e0;\">\n                            <p style=\"margin: 0; color: #000000; font-size: 13px; text-transform: uppercase; letter-spacing: 1px; text-align: center;\">\n                                <strong>Proposal Received - Under Review</strong>\n                            </p>\n                        </td>\n                    </tr>\n                    \n                    <!-- Main Content -->\n                    <tr>\n                        <td style=\"padding: 40px; background-color: #ffffff;\">\n                            <p style=\"color: #000000; font-size: 15px; line-height: 1.6; margin: 0 0 20px;\">\n                                Dear {{ $('Report Data Prep').item.json.founderName || 'Founder' }},\n                            </p>\n                            \n                            <p style=\"color: #000000; font-size: 15px; line-height: 1.6; margin: 0 0 25px;\">\n                                Thank you for submitting your investment proposal for <strong>{{ $('Report Data Prep').item.json.companyName }}</strong>. We have successfully received your submission and it is now under review by our investment analysis team.\n                            </p>\n                            \n                            <!-- Submission Details -->\n                            <div style=\"background-color: #ffffff; border: 1px solid #e0e0e0; padding: 20px; margin: 25px 0;\">\n                                <h4 style=\"margin: 0 0 15px; color: #000000; font-size: 14px; font-weight: 600;\">Submission Details:</h4>\n                                <table style=\"width: 100%; color: #000000; font-size: 14px; line-height: 1.6;\">\n                                    <tr>\n                                        <td style=\"padding: 5px 0; font-weight: 600; width: 150px;\">Company:</td>\n                                        <td style=\"padding: 5px 0;\">{{ $('Report Data Prep').item.json.companyName }}</td>\n                                    </tr>\n                                    <tr>\n                                        <td style=\"padding: 5px 0; font-weight: 600;\">Submission Date:</td>\n                                        <td style=\"padding: 5px 0;\">{{ new Date().toLocaleDateString() }}</td>\n                                    </tr>\n                                    <tr>\n                                        <td style=\"padding: 5px 0; font-weight: 600;\">Industry:</td>\n                                        <td style=\"padding: 5px 0;\">{{ $('Report Data Prep').item.json.industry || 'Not Specified' }}</td>\n                                    </tr>\n                                    <tr>\n                                        <td style=\"padding: 5px 0; font-weight: 600;\">Investment Stage:</td>\n                                        <td style=\"padding: 5px 0;\">{{ $('Report Data Prep').item.json.investmentStage || 'Not Specified' }}</td>\n                                    </tr>\n                                </table>\n                            </div>\n                            \n                            <!-- Next Steps -->\n                            <div style=\"background-color: #ffffff; border: 1px solid #e0e0e0; padding: 20px; margin: 30px 0;\">\n                                <h4 style=\"margin: 0 0 15px; color: #000000; font-size: 14px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px;\">What Happens Next:</h4>\n                                <ol style=\"margin: 0; padding-left: 20px; color: #000000; font-size: 14px; line-height: 1.8;\">\n                                    <li style=\"margin-bottom: 10px;\">Our team will conduct a comprehensive analysis of your proposal</li>\n                                    <li style=\"margin-bottom: 10px;\">Initial evaluation typically takes 5-7 business days</li>\n                                    <li style=\"margin-bottom: 10px;\">We will contact you with our initial assessment</li>\n                                    <li style=\"margin-bottom: 0;\">If there's mutual interest, we'll schedule a detailed discussion</li>\n                                </ol>\n                            </div>\n                            \n                            <p style=\"color: #000000; font-size: 15px; line-height: 1.6; margin: 25px 0;\">\n                                We appreciate your interest in partnering with One Eighty Ventures and look forward to learning more about <strong>{{ $('Report Data Prep').item.json.companyName }}</strong>.\n                            </p>\n                            \n                            <p style=\"color: #000000; font-size: 14px; line-height: 1.6; margin: 30px 0 0;\">\n                                Best regards,<br><br>\n                                <strong style=\"color: #000000;\">Investment Analysis Team</strong><br>\n                                One Eighty Ventures\n                            </p>\n                        </td>\n                    </tr>\n                    \n                    <!-- Footer -->\n                    <tr>\n                        <td style=\"background-color: #ffffff; padding: 25px 40px; border-top: 1px solid #e0e0e0;\">\n                            <p style=\"margin: 0; color: #666666; font-size: 12px; text-align: center; line-height: 1.5;\">\n                                One Eighty Ventures | Investment Analysis Team<br>\n                                This email contains confidential information\n                            </p>\n                        </td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n    </table>\n</body>\n</html>\n```\n\n---\n\n## EMAIL 2: INVESTMENT COMMITTEE NOTIFICATION\n\n**Recipients:** [Retrieved via Get_IC_Team_Email tool]\n\n**Subject:** New Deal Alert: {{ $('Report Data Prep').item.json.companyName }} - Investment Analysis Report\n\n**HTML Email Body:**\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>New Deal Alert - Investment Committee</title>\n</head>\n<body style=\"margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; background-color: #ffffff;\">\n    <table role=\"presentation\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" width=\"100%\" style=\"background-color: #ffffff;\">\n        <tr>\n            <td align=\"center\" style=\"padding: 40px 20px;\">\n                <table role=\"presentation\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" width=\"700\" style=\"background-color: #ffffff; border: 1px solid #e0e0e0;\">\n                   <!-- Header with Logo -->\n                    <tr>\n    <td style=\"background-color: #ffffff; padding: 20px 40px; border-bottom: 1px solid #e0e0e0; text-align: center;\">\n        <!-- Logo Image -->\n        <img src=\"https://drive.google.com/uc?export=view&id=1R8gxDyOYSqHL1hGPYraVYsN-KfbM8Pzv\" \n             alt=\"One Eighty Ventures Logo\" \n             style=\"max-width: 200px; height: auto; display: block; margin: 0 auto 15px auto;\" />\n        \n        <!-- Company Name (fallback if logo doesn't load) -->\n        <h1 style=\"margin: 0; color: #000000; font-size: 24px; font-weight: 400; text-align: center;\">ONE EIGHTY VENTURES</h1>\n        <p style=\"margin: 10px 0 0; color: #666666; font-size: 12px; text-align: center; letter-spacing: 2px; text-transform: uppercase;\">Investment Analysis Team</p>\n    </td>\n</tr>\n                    \n                    <!-- Alert Bar -->\n                    <tr>\n                        <td style=\"background-color: #ffffff; padding: 15px 40px; border-bottom: 1px solid #e0e0e0;\">\n                            <p style=\"margin: 0; color: #000000; font-size: 13px; text-transform: uppercase; letter-spacing: 1px; text-align: center;\">\n                                <strong>ðŸ”” New Deal Received - Analysis Required</strong>\n                            </p>\n                        </td>\n                    </tr>\n                    \n                    <!-- Deal Summary -->\n                    <tr>\n                        <td style=\"padding: 30px 40px 20px; background-color: #ffffff;\">\n                            <h2 style=\"margin: 0 0 20px; color: #000000; font-size: 18px; font-weight: 600;\">\n                                Deal Summary: {{ $('Report Data Prep').item.json.companyName }}\n                            </h2>\n                            \n                            <div style=\"background-color: #ffffff; border: 1px solid #e0e0e0; padding: 25px; margin: 0 0 25px;\">\n                                <table style=\"width: 100%; color: #000000; font-size: 14px; line-height: 1.8;\">\n                                    <tr>\n                                        <td style=\"padding: 8px 0; font-weight: 600; width: 180px; border-bottom: 1px solid #f0f0f0;\">Company Name:</td>\n                                        <td style=\"padding: 8px 0; border-bottom: 1px solid #f0f0f0;\"><strong>{{ $('Report Data Prep').item.json.companyName }}</strong></td>\n                                    </tr>\n                                    <tr>\n                                        <td style=\"padding: 8px 0; font-weight: 600; border-bottom: 1px solid #f0f0f0;\">Contact Person:</td>\n                                        <td style=\"padding: 8px 0; border-bottom: 1px solid #f0f0f0;\">{{ $('Report Data Prep').item.json.founderName || 'Not Provided' }}</td>\n                                    </tr>\n                                    <tr>\n                                        <td style=\"padding: 8px 0; font-weight: 600; border-bottom: 1px solid #f0f0f0;\">Contact Email:</td>\n                                        <td style=\"padding: 8px 0; border-bottom: 1px solid #f0f0f0;\">{{ $('Report Data Prep').item.json.email }}</td>\n                                    </tr>\n                                    <tr>\n                                        <td style=\"padding: 8px 0; font-weight: 600; border-bottom: 1px solid #f0f0f0;\">Industry:</td>\n                                        <td style=\"padding: 8px 0; border-bottom: 1px solid #f0f0f0;\">{{ $('Report Data Prep').item.json.marketSector.primary }}</td>\n                                    </tr>\n                                    <tr>\n                                        <td style=\"padding: 8px 0; font-weight: 600; border-bottom: 1px solid #f0f0f0;\">Investment Stage:</td>\n                                        <td style=\"padding: 8px 0; border-bottom: 1px solid #f0f0f0;\">{{ $('Report Data Prep').item.json.companyDetails.stage }}</td>\n                                    </tr>\n                                    <tr>\n                                        <td style=\"padding: 8px 0; font-weight: 600; border-bottom: 1px solid #f0f0f0;\">Submission Date:</td>\n                                        <td style=\"padding: 8px 0; border-bottom: 1px solid #f0f0f0;\">{{ new Date().toLocaleDateString() }}</td>\n                                    </tr>\n                                    <tr>\n                                        <td style=\"padding: 8px 0; font-weight: 600;\">Analysis Score:</td>\n                                        <td style=\"padding: 8px 0;\"><strong style=\"color: >{{ $('Report Data Prep').item.json.totalScore.final }}</strong></td>\n                                    </tr>\n                                </table>\n                            </div>\n                        </td>\n                    </tr>\n                    \n                    <!-- Key Metrics (if available) -->\n{{ JSON.stringify($('Report Data Prep').item.json.companyDetails?.keyMetrics || 'No metrics available') }}\n              <!-- Action Items -->\n                    <tr>\n                        <td style=\"padding: 20px 40px 40px; background-color: #ffffff;\">\n                            <div style=\"background-color: #ffffff; border: 1px solid #e0e0e0; padding: 25px;\">\n                                <h4 style=\"margin: 0 0 15px; color: #000000; font-size: 14px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px;\">Required Actions:</h4>\n                                <ul style=\"margin: 0; padding-left: 20px; color: #000000; font-size: 14px; line-height: 1.8;\">\n                                    <li style=\"margin-bottom: 10px;\">Review the complete investment analysis report</li>\n                                    <li style=\"margin-bottom: 10px;\">Assess alignment with current investment thesis</li>\n                                    <li style=\"margin-bottom: 10px;\">Determine next steps (proceed/monitor/decline)</li>\n                                    <li style=\"margin-bottom: 10px;\">Provide feedback within 3 business days</li>\n                                    <li style=\"margin-bottom: 0;\">Schedule IC discussion if recommendation is to proceed</li>\n                                </ul>\n                            </div>\n                            \n                            <div style=\"text-align: center; margin: 30px 0;\">\n                                <a href=\"#\" style=\"display: inline-block; background-color: #000000; color: #ffffff; padding: 15px 35px; text-decoration: none; font-size: 14px; font-weight: 500; margin-right: 15px;\">View Full Analysis Report</a>\n                                <a href=\"#\" style=\"display: inline-block; background-color: #ffffff; color: #000000; border: 2px solid #000000; padding: 13px 35px; text-decoration: none; font-size: 14px; font-weight: 500;\">Access Deal Dashboard</a>\n                            </div>\n                            \n                            <p style=\"color: #666666; font-size: 13px; line-height: 1.6; margin: 25px 0 0; text-align: center; font-style: italic;\">\n                                Please review this opportunity within 72 hours to maintain our response timeline commitments.\n                            </p>\n                        </td>\n                    </tr>\n                    \n                    <!-- Footer -->\n                    <tr>\n                        <td style=\"background-color: #f8f8f8; padding: 25px 40px; border-top: 1px solid #e0e0e0;\">\n                            <p style=\"margin: 0; color: #999999; font-size: 12px; text-align: center; line-height: 1.5;\">\n                                One Eighty Ventures | Investment Committee System<br>\n                                This email contains confidential investment information - IC Members Only\n                            </p>\n                        </td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n    </table>\n</body>\n</html>\n```\n\n---\n\n## Workflow Implementation Instructions\n\n**Send new deal received acknowledgment email to:**\n1. **Contact Person:** {{ $('Report Data Prep').item.json.email }} (using Email Template 1)\n2. **Investment Committee:** [Retrieved via Get_IC_Team_Email tool] (using Email Template 2)\n\n**Tools to Execute:**\n1. `Get_IC_Team_Email` - Retrieve IC team email addresses\n\nBoth templates maintain professional appearance with clean black text on white backgrounds and include all necessary variable mappings"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 2.1,
        "position": [
          3328,
          288
        ],
        "id": "4ca745dc-dd13-4ddb-aa7e-55e4617b9add",
        "name": "Communication Agent"
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "gpt-4o-mini",
            "mode": "list",
            "cachedResultName": "gpt-4o-mini"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
        "typeVersion": 1.2,
        "position": [
          3216,
          624
        ],
        "id": "51b0f5ba-5395-456b-9e7e-f98e3fb42e92",
        "name": "OpenAI Chat Model1",
        "credentials": {
          "openAiApi": {
            "id": "ktM70nRxsXMA9jQA",
            "name": "OpenAi account"
          }
        }
      },
      {
        "parameters": {
          "descriptionType": "manual",
          "toolDescription": "Get email address from investment committee team member ",
          "documentId": {
            "__rl": true,
            "value": "1FbSv5SkfPI8AqbTmwpBHXvh6XGuCDzG-iVnBz3Kn5xQ",
            "mode": "list",
            "cachedResultName": "Investment Committee Team",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1FbSv5SkfPI8AqbTmwpBHXvh6XGuCDzG-iVnBz3Kn5xQ/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Sheet1",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1FbSv5SkfPI8AqbTmwpBHXvh6XGuCDzG-iVnBz3Kn5xQ/edit#gid=0"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheetsTool",
        "typeVersion": 4.6,
        "position": [
          3440,
          608
        ],
        "id": "b76e90c7-85bd-449a-8111-079b05fe8698",
        "name": "Get IC Team Member Email",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "Ewb3ZoqCnjfRwedF",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "jsonSchemaExample": "{\n  \"emails\": [\n    {\n      \"emailId\": \"email_1\",\n      \"type\": \"proposal_acknowledgement\",\n      \"recipient\": {\n        \"companyName\": \"{{ $('Investment Analyst Report Agent Data Prep').item.json.companyName }}\",\n        \"contactPerson\": \"{{ $('Investment Analyst Report Agent Data Prep').item.json.founderName }}\",\n        \"emailAddress\": \"{{ $('Investment Analyst Report Agent Data Prep').item.json.email }}\"\n      },\n      \"subject\": \"Proposal Submitted - {{ $('Investment Analyst Report Agent Data Prep').item.json.companyName }}\",\n      \"message\": \"Dear {{ $('Investment Analyst Report Agent Data Prep').item.json.founderName }},\\n\\nThank you for submitting your investment proposal for {{ $('Investment Analyst Report Agent Data Prep').item.json.companyName }}. We acknowledge receipt of your submission and appreciate your interest in partnering with us.\\n\\nYour proposal has been forwarded to our Investment Analysis team for initial review. You will receive a response from one of our Business Analysts within the next 5-7 business days regarding the next steps in our evaluation process.\\n\\nShould you have any questions in the meantime, please don't hesitate to reach out.\\n\\nBest regards,\\nInvestment Team\",\n      \"attachments\": []\n    },\n    {\n      \"emailId\": \"email_2\",\n      \"type\": \"investment_committee_notification\",\n      \"recipient\": {\n        \"teamMembers\": \"[Get_IC_Team_Email tool result]\",\n        \"emailAddresses\": \"[Get_IC_Team_Email tool result]\"\n      },\n      \"subject\": \"New Deal Submission for Review - {{ $('Investment Analyst Report Agent Data Prep').item.json.companyName }}\",\n      \"message\": \"Hi Team,\\n\\nA new deal proposal for {{ $('Investment Analyst Report Agent Data Prep').item.json.companyName }} has been submitted. Below are the initial prospecting scorecard results:\\n\\nCompany Name: {{ $('Investment Analyst Report Agent Data Prep').item.json.companyName }}\\nTotal Score: {{ $('Append row in sheet').item.json['Total - Score'] }}\\nSubmission Date: {{ $('Investment Analyst Report Agent Data Prep').item.json.submittedAt }}\\n\\nIndividual Question Scores:\\n1. Is the category relevant/aligned w/VS vision and expertise?: {{ $('Append row in sheet').item.json['Category Question 1 - Score'] }}\\n2. Is the product first to market (e.g., white space w/no to little competition)?: {{ $('Append row in sheet').item.json['Category - Question 2 - Score'] }}\\n3. Is the TAM greater than $1B?: {{ $('Append row in sheet').item.json['Category - Question 3 - Score'] }}\\n4. Is the TAM increasing?: {{ $('Append row in sheet').item.json['Category - Question 4 - Score'] }}\\n5. Is there a roadmap for the next 12 months?: {{ $('Append row in sheet').item.json['Product - SubTotal - Score'] }}\\n6. Has the team grown since being founded?: {{ $('Append row in sheet').item.json[' Product - Question 3 - Score'] }}\\n7. Is this supported by a full-time/dedicated team (not including the founder)?: {{ $('Append row in sheet').item.json['Product - Question 2 - Score'] }}\\n8. Is there a functioning product that is live/In-Market?: {{ $('Append row in sheet').item.json['Operations - Question 3 - Score'] }}\\n9. Is the IP proprietary/patent protected?: 0\\n10. Does the team have a Go-To-Market Plan?: 0\\n11. Are they currently generating revenue?: {{ $('Append row in sheet').item.json['Financial - Question 5 - Score'] }}\\n12. Have they generated revenue in the past 12 months?: {{ $('Append row in sheet').item.json['Financial - Question 4 - Score'] }}\\n13. Are there investors?: {{ $('Append row in sheet').item.json['Financial - Question 3 - Score'] }}\\n14. Do they have funding?: {{ $('Append row in sheet').item.json['Financial - Question 2 - Score'] }}\\n15. Are they profitable?: {{ $('Append row in sheet').item.json['Financial - Question 1 - Score'] }}\\n\\nA detailed \\\"{{ $('Copy file').item.json.name }}\\\" has been generated and attached for your review. This report includes a comprehensive analysis of the company's investment potential, inevitability of success, missing data impact, sector-specific analysis, risk assessment, and investment decision.\\n\\nPlease review at your convenience.\\n\\nBest regards,\\nYour Investment Analyst\",\n      \"attachments\": [\n        {\n          \"fileId\": \"{{ $('Investment Analyst Report Agent Data Prep').item.json['Uploaded Proposal id'] }}\",\n          \"fileName\": \"Deal Proposal\",\n          \"fileType\": \"proposal\"\n        },\n        {\n          \"fileId\": \"{{ $('Investment Analyst Report Agent Data Prep').item.json['Investment Analyst Report id'] }}\",\n          \"fileName\": \"Investment Analysis Report\",\n          \"fileType\": \"report\"\n        }\n      ]\n    }\n  ]\n}"
        },
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "typeVersion": 1.3,
        "position": [
          3632,
          608
        ],
        "id": "26239451-3b4d-419b-8c44-9485e5a52897",
        "name": "Structured Output Parser2"
      },
      {
        "parameters": {
          "documentId": {
            "__rl": true,
            "value": "1S0yVMf5ntHCLMXQYvtoRgLdaEOw758UeZz7rZUjN4H0",
            "mode": "list",
            "cachedResultName": "Scorecard-Results",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1S0yVMf5ntHCLMXQYvtoRgLdaEOw758UeZz7rZUjN4H0/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": 959050753,
            "mode": "list",
            "cachedResultName": "Questions",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1S0yVMf5ntHCLMXQYvtoRgLdaEOw758UeZz7rZUjN4H0/edit#gid=959050753"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "Questions",
                "lookupValue": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('values0_Value', `Investment Criteria Questions`, 'string') }}"
              },
              {
                "lookupColumn": "Criteria",
                "lookupValue": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('values1_Value', `Investment Criteria`, 'string') }}"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheetsTool",
        "typeVersion": 4.6,
        "position": [
          2352,
          624
        ],
        "id": "a19e4938-a059-4d26-a17c-1fc92adafb61",
        "name": "Get List of Investment Criteria Questions",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "Ewb3ZoqCnjfRwedF",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "fieldToSplitOut": "output",
          "options": {}
        },
        "type": "n8n-nodes-base.splitOut",
        "typeVersion": 1,
        "position": [
          3712,
          288
        ],
        "id": "42d2ad07-0ef0-47bb-ac4d-130497a4f0d6",
        "name": "Split Out1"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "1cc235da-9c6e-40d2-97a1-4d5f083e35f9",
                "name": "IC Team Email Message",
                "value": "={{ $json['1'] }}",
                "type": "object"
              },
              {
                "id": "2c293913-6e56-43f9-b497-f5ffb1ffa80e",
                "name": "Prospect Email Message",
                "value": "={{ $json['0'] }}",
                "type": "object"
              },
              {
                "id": "c9b63c71-2c8f-4288-9472-2e3108415e89",
                "name": "Investment Analysis Report ",
                "value": "={{ $('Upload File').item.json.id }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          3984,
          288
        ],
        "id": "5f5a0247-d819-413f-8db1-753358cd26e3",
        "name": "Prep Emails"
      },
      {
        "parameters": {
          "sendTo": "=kingler@me.com",
          "subject": "={{ $json.output.subject }}",
          "message": "={{ $json.output.message }}",
          "options": {}
        },
        "type": "n8n-nodes-base.gmail",
        "typeVersion": 2.1,
        "position": [
          1792,
          -304
        ],
        "id": "557cca39-72ed-4cc7-8568-d8226c3f34ba",
        "name": "Send Rejection Email",
        "webhookId": "f1c8fd9a-a7ff-41f2-ac3e-761927687cca",
        "credentials": {
          "gmailOAuth2": {
            "id": "vMzyaTna175lWQkR",
            "name": "Gmail account"
          }
        }
      },
      {
        "parameters": {
          "model": {
            "__rl": true,
            "value": "claude-3-5-sonnet-20241022",
            "mode": "list",
            "cachedResultName": "Claude Sonnet 3.5 (New)"
          },
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatAnthropic",
        "typeVersion": 1.3,
        "position": [
          1248,
          -96
        ],
        "id": "1ee3add4-abf7-4813-9726-6a259ef89ea9",
        "name": "Anthropic Chat Model3",
        "credentials": {
          "anthropicApi": {
            "id": "DbiE8irBacpzM2AL",
            "name": "Anthropic account"
          }
        }
      },
      {
        "parameters": {
          "operation": "download",
          "fileId": {
            "__rl": true,
            "value": "={{ $json['Investment Analysis Report '] }}",
            "mode": "id"
          },
          "options": {
            "binaryPropertyName": "data",
            "googleFileConversion": {
              "conversion": {
                "docsToFormat": "application/pdf"
              }
            }
          }
        },
        "type": "n8n-nodes-base.googleDrive",
        "typeVersion": 3,
        "position": [
          4256,
          416
        ],
        "id": "0839bcb0-2703-4760-a46d-23cb534a51b7",
        "name": "Download file3",
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "DQWWWj2hk7oMPymA",
            "name": "Google Drive account"
          }
        }
      },
      {
        "parameters": {
          "name": "={{ $('Use Investment Analysis Report Template 1').item.json.name }}",
          "driveId": {
            "__rl": true,
            "value": "My Drive",
            "mode": "list"
          },
          "folderId": {
            "__rl": true,
            "value": "1b1sPURoqP4PO7KCpxwXubaE9Pij1aXEI",
            "mode": "list",
            "cachedResultName": "Deal-flow-demo",
            "cachedResultUrl": "https://drive.google.com/drive/folders/1b1sPURoqP4PO7KCpxwXubaE9Pij1aXEI"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleDrive",
        "typeVersion": 3,
        "position": [
          4512,
          304
        ],
        "id": "45201df3-ee5e-47d5-b8ad-313e2d69d507",
        "name": "Upload Investment Analysis Report2",
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "DQWWWj2hk7oMPymA",
            "name": "Google Drive account"
          }
        }
      },
      {
        "parameters": {
          "jsCode": "// Parse the AI agent's output and prepare for Gmail send\nfor (const item of $input.all()) {\n  try {\n    // Get the output from the AI agent\n    const agentOutput = item.json.output || item.json;\n    \n    // Initialize email fields\n    let to = '';\n    let subject = '';\n    let message = '';\n    \n    // Check if the output is already structured\n    if (agentOutput.to && agentOutput.subject && agentOutput.message) {\n      // Direct structured output\n      to = agentOutput.to;\n      subject = agentOutput.subject;\n      message = agentOutput.message;\n    } else if (typeof agentOutput === 'string') {\n      // Parse string output looking for email fields\n      const outputText = agentOutput;\n      \n      // Extract 'to' field\n      const toMatch = outputText.match(/to:\\s*([^\\n]+)/i);\n      if (toMatch) {\n        to = toMatch[1].trim();\n      }\n      \n      // Extract 'subject' field\n      const subjectMatch = outputText.match(/subject:\\s*([^\\n]+)/i);\n      if (subjectMatch) {\n        subject = subjectMatch[1].trim();\n      }\n      \n      // Extract 'message' field (HTML content)\n      const messageMatch = outputText.match(/message:\\s*([\\s\\S]*?)(?:$)/i);\n      if (messageMatch) {\n        message = messageMatch[1].trim();\n      } else {\n        // If no explicit message field, try to extract HTML content\n        const htmlMatch = outputText.match(/<!DOCTYPE html>[\\s\\S]*<\\/html>/i);\n        if (htmlMatch) {\n          message = htmlMatch[0];\n        }\n      }\n    } else if (agentOutput.text) {\n      // Sometimes AI output is wrapped in a text property\n      const outputText = agentOutput.text;\n      \n      // Same parsing logic as above\n      const toMatch = outputText.match(/to:\\s*([^\\n]+)/i);\n      if (toMatch) {\n        to = toMatch[1].trim();\n      }\n      \n      const subjectMatch = outputText.match(/subject:\\s*([^\\n]+)/i);\n      if (subjectMatch) {\n        subject = subjectMatch[1].trim();\n      }\n      \n      const messageMatch = outputText.match(/message:\\s*([\\s\\S]*?)(?:$)/i);\n      if (messageMatch) {\n        message = messageMatch[1].trim();\n      } else {\n        const htmlMatch = outputText.match(/<!DOCTYPE html>[\\s\\S]*<\\/html>/i);\n        if (htmlMatch) {\n          message = htmlMatch[0];\n        }\n      }\n    }\n    \n    // Fallback values if parsing fails\n    if (!to) {\n      // Try to get email from original data\n      to = item.json.originalData?.founderEmail || \n           item.json['Contact Person\\'s Email Address'] ||\n           'kingler@me.com'; // Your default as shown in the workflow\n    }\n    \n    if (!subject) {\n      // Generate a default subject based on rejection type\n      const companyName = item.json.originalData?.companyName || 'Your Company';\n      const rejectionType = item.json.rejectionType || 'REVIEW';\n      \n      if (rejectionType === 'INCOMPLETE') {\n        subject = `${companyName} Investment Proposal - Additional Information Required`;\n      } else if (rejectionType === 'MONITOR') {\n        subject = `${companyName} - Investment Proposal Status Update`;\n      } else {\n        subject = `${companyName} - Investment Proposal Decision`;\n      }\n    }\n    \n    if (!message) {\n      // Fallback to a simple text message if HTML parsing fails\n      message = `Thank you for your investment proposal submission. After careful review, we have made our decision regarding your proposal. Please check your email for detailed feedback.`;\n    }\n    \n    // Clean up the message if needed\n    // Remove any markdown formatting that might have been included\n    message = message.replace(/```html\\n?/gi, '').replace(/```\\n?/gi, '');\n    \n    // Prepare the output for the Gmail node\n    item.json.output = {\n      to: to,\n      subject: subject,\n      message: message,\n      isHtml: message.includes('<!DOCTYPE html>') || message.includes('<html')\n    };\n    \n    // Also set individual fields for direct access\n    item.json.emailTo = to;\n    item.json.emailSubject = subject;\n    item.json.emailMessage = message;\n    \n    // Include metadata for debugging\n    item.json.processingMetadata = {\n      timestamp: new Date().toISOString(),\n      rejectionType: item.json.rejectionType || 'UNKNOWN',\n      score: item.json.originalData?.score?.numeric || item.json.scorecardPercentage || 0,\n      companyName: item.json.originalData?.companyName || 'Unknown',\n      founderName: item.json.originalData?.founderName || 'Founder'\n    };\n    \n  } catch (error) {\n    // Handle any parsing errors\n    item.json.error = {\n      message: error.message,\n      stack: error.stack\n    };\n    \n    // Set fallback values\n    item.json.output = {\n      to: 'kingler@me.com',\n      subject: 'Investment Proposal - Processing Error',\n      message: 'An error occurred while processing the rejection email. Please review manually.',\n      isHtml: false\n    };\n  }\n}\n\nreturn $input.all();"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          1616,
          -304
        ],
        "id": "a1c0d371-bb91-40a2-a7a0-6edff4fe3bde",
        "name": "Code"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=Analyze this investment opportunity and generate a comprehensive investment analysis report in valid JSON format.\n\n## Company Details\n- Company: {{ $json.companyName }}\n- Founder/CEO: {{ $json.founderName }}\n- Email: {{ $json.email }}\n- LinkedIn Profile: {{ $json.foundersLinkedInUrl }}\n- Market Sector: {{ $json.marketSector }}\n- Total Score: {{ $json.totalScore }}\n\n**Additional Team LinkedIn Profiles:**\n{{\n  (() => {\n    const profiles = [];\n    \n    // Add founder LinkedIn URL if it exists\n    if ($json.foundersLinkedInUrl && $json.foundersLinkedInUrl.includes(\"linkedin.com\")) {\n      profiles.push(`Founder/CEO: ${$json.foundersLinkedInUrl}`);\n    }\n    \n    // Add team member LinkedIn URLs\n    const fields = [\"CTO LinkedIn Url\", \"CFO LinkedIn Url\", \"COO LinkedIn Url\", \"CMO LinkedIn Url\"];\n    \n    fields.forEach(field => {\n      const url = $json[field];\n      if (url && url.includes(\"linkedin.com\")) {\n        profiles.push(`${field.replace(' LinkedIn Url', '')}: ${url}`);\n      }\n    });\n    \n    return profiles.length > 0 ? profiles.join('\\n') : \"No LinkedIn profiles provided\";\n  })()\n}}\n\n\n**Extracted Information:**\n{{ JSON.stringify($json.extractedInformation.sections, null, 2) }}\n\n**REQUIRED DELIVERABLES:**\nâ–¡ Complete scorecard evaluation\nâ–¡ Investment recommendation with clear rationale\nâ–¡ Comprehensive risk assessment\nâ–¡ Financial analysis with projections\nâ–¡ All JSON fields populated with substantive content\n\n**OUTPUT REQUIREMENT:** Return ONLY a valid JSON object that matches the expected template structure. Do not include any explanatory text outside the JSON.",
          "hasOutputParser": true,
          "options": {
            "systemMessage": "=You are an expert investment analyst. Use the available tools to research this investment opportunity thoroughly, then generate a comprehensive investment analysis report that aligns with the Google Docs template structure.\n\n## REQUIRED RESEARCH WORKFLOW\n1. **FIRST**: Use \"Search Founders linkedIn profile\" to research founder background and experience\n2. **SECOND**: Use \"Search Market Size & Trends\" to analyze market opportunity and competitive landscape  \n3. **THIRD**: Use \"Get List of Investment Criteria Questions\" to access evaluation framework\n4. **FOURTH**: Use \"Get deal scorecard results\" to retrieve existing scorecard data\n5. **FIFTH**: Use \"Use Investment Analysis Report Template1\" to access template structure\n\n## Company Details\n- Company: {{ $json.companyName }}\n- Founder/CEO: {{ $json.founderName }}\n- Email: {{ $json.email }}\n- LinkedIn Profile: {{ $json.foundersLinkedInUrl }}\n- Market Sector: {{ $json.marketSector }}\n- Total Score: {{ $json.totalScore }}\n\n## Scorecard results\n  - **Category/Market - Weight 30%**\n {{ $json.questions[0].question }} | {{ $json.questions[0].answer }}={{ $json.questions[0].answerValue }}\n {{ $json.questions[1].question }} | {{ $json.questions[1].answer }}={{ $json.questions[1].answerValue }}\n {{ $json.questions[2].question }} | {{ $json.questions[2].answer }}={{ $json.questions[2].answerValue }}\n {{ $json.questions[3].question }} | {{ $json.questions[3].answer }}={{ $json.questions[3].answerValue }}\nTotal Category/Market = {{ $('Generate Yes/No answers scorecard questions1').item.json.categoryScores.category.contribution }}\n\n  - **Product - Weight 20%**\n {{ $json.questions[4].question }} | {{ $json.questions[4].answer }}={{ $json.questions[4].answerValue }}\n {{ $json.questions[5].question }} | {{ $json.questions[5].answer }}={{ $json.questions[5].answerValue }}\n {{ $json.questions[6].question }} | {{ $json.questions[6].answer }}={{ $json.questions[6].answerValue }}\nTotal Product = {{ $('Generate Yes/No answers scorecard questions1').item.json.categoryScores.product.contribution }}\n  \n  - **Operations - Weight 20%**\n {{ $json.questions[7].question }} | {{ $json.questions[7].answer }}={{ $json.questions[7].answerValue }}\n {{ $json.questions[8].question }} | {{ $json.questions[8].answer }}={{ $json.questions[8].answerValue }}\n {{ $json.questions[9].question }} | {{ $json.questions[9].answer }}={{ $json.questions[9].answerValue }}\nTotal Operations = {{ $('Generate Yes/No answers scorecard questions1').item.json.categoryScores.operations.contribution }}\n\n  - **Financial - Weight 30%**\n {{ $json.questions[9].question }} | {{ $json.questions[9].answer }}={{ $json.questions[9].answerValue }}\n {{ $json.questions[10].question }} | {{ $json.questions[10].answer }}={{ $json.questions[10].answerValue }}\n {{ $json.questions[11].question }} | {{ $json.questions[11].answer }}={{ $json.questions[11].answerValue }}\n {{ $json.questions[12].question }} | {{ $json.questions[12].answer }}={{ $json.questions[12].answerValue }}\n {{ $json.questions[13].question }} | {{ $json.questions[13].answer }}={{ $json.questions[13].answerValue }}\n  Total Financial = {{ $('Generate Yes/No answers scorecard questions1').item.json.categoryScores.financial.contribution }}\n\n**Extracted Information:**\nOverview: {{ $json.extractedInformation.sections.overview }}\nProblem: {{ $json.extractedInformation.sections.problem }}\nSolution: {{ $json.extractedInformation.sections.solution }}\nMarket: {{ $json.extractedInformation.sections.market }}\nTraction: {{ $json.extractedInformation.sections.traction }}\nBusiness Model: {{ $json.extractedInformation.sections.businessModel }}\nTeam: {{ $json.extractedInformation.sections.team }}\nFinancial: {{ $json.extractedInformation.sections.financial }}\nInvestment: {{ $json.extractedInformation.sections.investment }}\nContact: {{ $json.extractedInformation.sections.contact }}\n\n## CONTENT FIELD TYPE CLASSIFICATION\n\n### DYNAMIC DATA FIELDS (Use syntax):\nThese fields populate directly from structured data sources without AI generation:\n- Company identifiers and contact information\n- Scorecard scores and calculations\n- Raw extracted data from proposals\n- Numerical financial metrics from databases\n\n### AI-GENERATED CONTENT FIELDS:\nAll other fields require comprehensive research and analysis. Each field below includes detailed generation instructions.\n\n## CRITICAL OUTPUT REQUIREMENT\nAfter completing your research using ALL available tools, generate ONLY a valid JSON object with this structure:\n\n{\n  // ===================\n  // EXECUTIVE SUMMARY\n  // ===================\n  \n  // DYNAMIC DATA FIELD - Direct from input\n  \"companyName\": \"{{ $json.companyName }}\",\n  \n  // AI-GENERATED CONTENT FIELD\n  \"scorecardRating\": {\n    \"contentType\": \"Executive summary scorecard interpretation\",\n    \"instruction\": \"Generate a comprehensive 2-3 sentence investment rating summary that includes: (1) The numerical scorecard percentage {{ $json.totalScore.numeric }}%, (2) The recommendation level {{ $json.totalScore.recommendation }}, (3) 2-3 key strengths that justify this rating based on market position, product-market fit, and team capability. Use authoritative investment analyst tone. Example: '78% - STRONG BUY. Market-leading platform positioned in rapidly expanding $47B addressable market with demonstrated product-market fit and experienced leadership team driving 147% YoY revenue growth.'\",\n    \"dataSources\": [\"scorecard results\", \"market research\", \"company traction data\"],\n    \"contextRequirements\": \"Must justify the numerical score with specific evidence\",\n    \"tone\": \"Confident, analytical, investment-focused\"\n  },\n  \n  // AI-GENERATED CONTENT FIELD\n  \"investmentThesis\": {\n    \"contentType\": \"Core investment thesis statement\",\n    \"instruction\": \"Craft a compelling 3-4 sentence investment thesis that synthesizes: (1) Market opportunity size and growth trajectory, (2) Competitive differentiation and barriers to entry, (3) Financial performance and unit economics, (4) Expected return profile with specific multiple (e.g., 3-5x). Must include words 'investment' or 'opportunity'. Base on scorecard strengths and market research findings.\",\n    \"dataSources\": [\"market sizing research\", \"competitive analysis\", \"financial projections\", \"scorecard evaluation\"],\n    \"contextRequirements\": \"Should align with and justify the recommended action\",\n    \"tone\": \"Persuasive, data-driven, professionally optimistic\"\n  },\n  \n  // DYNAMIC DATA FIELD - Direct from scorecard\n  \"recommendedAction\": \"{{ $json.totalScore.recommendation }}\",\n  \n  // AI-GENERATED CONTENT FIELD\n  \"keyRisks\": {\n    \"contentType\": \"Comprehensive risk assessment\",\n    \"instruction\": \"Identify and articulate 4-5 specific investment risks based on: (1) Market competition analysis from research, (2) Regulatory environment in {{ $json.marketSector }}, (3) Team/leadership dependencies from LinkedIn research, (4) Technical/operational scalability challenges, (5) Market timing and economic factors. Each risk should be specific, not generic. Include both internal company risks and external market risks.\",\n    \"dataSources\": [\"competitive landscape research\", \"regulatory analysis\", \"team assessment\", \"market research\"],\n    \"contextRequirements\": \"Risks should be balanced against the investment thesis\",\n    \"tone\": \"Objective, thorough, risk-aware but not alarmist\"\n  },\n  \n  // AI-GENERATED CONTENT FIELD\n  \"expectedReturnProfile\": {\n    \"contentType\": \"Detailed return analysis and exit strategy\",\n    \"instruction\": \"Develop a specific return projection including: (1) Target return multiple (e.g., 3-5x), (2) Investment timeline (4-6 years), (3) Exit strategy (strategic acquisition vs IPO), (4) Comparable transaction multiples for {{ $json.marketSector }}, (5) Key value drivers for exit. Base projections on current traction, market size, and comparable transactions.\",\n    \"dataSources\": [\"industry transaction data\", \"company financial projections\", \"market research\", \"comparable company analysis\"],\n    \"contextRequirements\": \"Must be realistic based on company stage and market dynamics\",\n    \"tone\": \"Analytical, evidence-based, conservative but confident\"\n  },\n  \n  // ===================\n  // SCORECARD PERFORMANCE - DYNAMIC DATA FIELDS\n  // ===================\n  \"marketPercent\": \"30%\",\n  \"marketScore\": \"{{ $('Generate Yes/No answers scorecard questions1').item.json.categoryScores.category.score }}\",\n  \"productPercent\": \"20%\", \n  \"productScore\": \"{{ $('Generate Yes/No answers scorecard questions1').item.json.categoryScores.product.score }}\",\n  \"operationsPercent\": \"20%\",\n  \"operationsScore\": \"{{ $('Generate Yes/No answers scorecard questions1').item.json.categoryScores.operations.score }}\",\n  \"financialPercent\": \"30%\",\n  \"financialScore\": \"{{ $('Generate Yes/No answers scorecard questions1').item.json.categoryScores.financial.score }}\",\n  \"overallScorePercent\": \"100%\",\n  \"overallScore\": \"{{ $json.totalScore.numeric }}\",\n  \n  // ===================\n  // COMPANY OVERVIEW\n  // ===================\n  \n  // AI-GENERATED CONTENT FIELDS for Basic Information\n  \"foundingYear\": {\n    \"contentType\": \"Company founding date\",\n    \"instruction\": \"Research the company founding date through: (1) Company website About/History section, (2) LinkedIn company page, (3) Crunchbase/PitchBook if available, (4) Press releases or news articles. If not found in research, use extracted information or estimate based on founder LinkedIn timeline and industry context.\",\n    \"dataSources\": [\"company website\", \"LinkedIn\", \"press releases\", \"proposal documents\"],\n    \"contextRequirements\": \"Must be realistic for company stage and team experience\",\n    \"tone\": \"Factual, verifiable\"\n  },\n  \n  \"headquartersLocation\": {\n    \"contentType\": \"Primary business location\",\n    \"instruction\": \"Determine headquarters location from: (1) Company website contact/about page, (2) LinkedIn company location, (3) Proposal documents, (4) Founder LinkedIn profiles. Provide city and state/country format. If multiple locations, identify primary HQ.\",\n    \"dataSources\": [\"company website\", \"LinkedIn profiles\", \"business filings\", \"proposal data\"],\n    \"contextRequirements\": \"Should align with team location and market focus\",\n    \"tone\": \"Precise, official\"\n  },\n  \n  \"website\": {\n    \"contentType\": \"Official company website URL\",\n    \"instruction\": \"Extract primary website URL from: (1) Proposal contact information {{ $input.first().json.companyContact?.website }}, (2) LinkedIn company profile, (3) Business cards/signatures. Ensure URL is properly formatted with www. prefix if applicable.\",\n    \"dataSources\": [\"proposal documents\", \"LinkedIn\", \"business communications\"],\n    \"contextRequirements\": \"Must be active, professional website\",\n    \"tone\": \"Direct, accurate\"\n  },\n  \n  \"fundingStage\": {\n    \"contentType\": \"Current funding stage classification\",\n    \"instruction\": \"Determine funding stage through: (1) Proposal financial information, (2) Crunchbase/PitchBook research, (3) LinkedIn company updates, (4) Press releases about funding. Use standard terminology: Pre-Seed, Seed, Series A/B/C, Growth, etc. Base on revenue size, team size, and funding history.\",\n    \"dataSources\": [\"funding databases\", \"press releases\", \"proposal documents\", \"company metrics\"],\n    \"contextRequirements\": \"Should align with company metrics and growth stage\",\n    \"tone\": \"Industry-standard classification\"\n  },\n  \n  \"employeesCount\": {\n    \"contentType\": \"Current employee headcount\",\n    \"instruction\": \"Research employee count via: (1) LinkedIn company page employee count, (2) Team section analysis {{ $input.first().json.teamInfo?.teamMembers?.length }}, (3) Company website team page, (4) Proposal organizational information. If exact number unavailable, provide reasonable range based on company stage and revenue.\",\n    \"dataSources\": [\"LinkedIn\", \"company website\", \"proposal team data\", \"organizational charts\"],\n    \"contextRequirements\": \"Should be consistent with funding stage and revenue level\",\n    \"tone\": \"Specific, current\"\n  },\n  \n  // AI-GENERATED CONTENT FIELDS for funding history\n  \"amount\": {\n    \"contentType\": \"Total funding amount raised\",\n    \"instruction\": \"Research total funding through: (1) Crunchbase/PitchBook databases, (2) Press releases and funding announcements, (3) Proposal financial history, (4) SEC filings if applicable. Provide total amount in millions. If not available, estimate based on company stage, employee count, and market sector norms.\",\n    \"dataSources\": [\"funding databases\", \"press releases\", \"SEC filings\", \"proposal documents\"],\n    \"contextRequirements\": \"Must be realistic for company stage and valuation\",\n    \"tone\": \"Precise financial data\"\n  },\n  \n  \"rounds\": {\n    \"contentType\": \"Number of funding rounds completed\",\n    \"instruction\": \"Count distinct funding rounds from research sources. Include pre-seed, seed, series rounds, convertible notes. Base on funding database research and company communications.\",\n    \"dataSources\": [\"Crunchbase\", \"PitchBook\", \"press releases\", \"company announcements\"],\n    \"contextRequirements\": \"Should align with total funding amount and company timeline\",\n    \"tone\": \"Factual count\"\n  },\n  \n  \"crunchbasePitchbookLink\": {\n    \"contentType\": \"Link to funding database profile\",\n    \"instruction\": \"Generate likely Crunchbase URL using format: https://www.crunchbase.com/organization/[company-name-lowercase-with-hyphens]. Verify through web search if possible. If company not found, use placeholder format.\",\n    \"dataSources\": [\"Crunchbase search\", \"company name formatting\"],\n    \"contextRequirements\": \"URL should follow standard Crunchbase naming conventions\",\n    \"tone\": \"Standard URL format\"\n  },\n  \n  // ===================\n  // LEADERSHIP TEAM ASSESSMENT\n  // ===================\n  \n  // DYNAMIC DATA FIELD\n  \"name\": \"{{ $json.founderName }}\",\n  \n  // AI-GENERATED CONTENT FIELD\n  \"keyExecutives\": {\n    \"contentType\": \"Senior leadership team profiles\",\n    \"instruction\": \"Research and profile 3-4 key executives beyond the founder/CEO using: (1) LinkedIn profile analysis for each team member, (2) Company website team page, (3) Proposal team information {{ $json.extractedInformation.sections.team }}. For each executive, provide: Title, Name, Previous company/role, Years of relevant experience. Focus on CTO, VP Sales, VP Marketing, Head of Product. Include specific company names and experience duration.\",\n    \"dataSources\": [\"LinkedIn profiles\", \"company website\", \"proposal team section\", \"executive bios\"],\n    \"contextRequirements\": \"Team should have relevant experience for the business model and market\",\n    \"tone\": \"Professional, credential-focused\"\n  },\n  \n  // AI-GENERATED CONTENT FIELD\n  \"boardComposition\": {\n    \"contentType\": \"Board of directors and advisors composition\",\n    \"instruction\": \"Document board structure including: (1) Founder/executive board members from {{ $input.first().json.teamInfo?.allFounders }}, (2) Independent directors from research, (3) Investor representatives, (4) Industry advisors with relevant {{ JSON.stringify($json.marketSector) }} experience. Research through company website, LinkedIn, press releases. If limited information, provide typical structure for funding stage.\",\n    \"dataSources\": [\"company website\", \"LinkedIn\", \"press releases\", \"investor announcements\"],\n    \"contextRequirements\": \"Board should provide relevant industry expertise and governance\",\n    \"tone\": \"Formal, governance-focused\"\n  },\n  \n  // AI-GENERATED CONTENT FIELD\n  \"teamScorecardAlignment\": {\n    \"contentType\": \"Team capability assessment relative to scorecard criteria\",\n    \"instruction\": \"Analyze how the leadership team addresses operations scorecard criteria by: (1) Counting operations criteria marked as 'Y' from {{ JSON.stringify($json.questions, null, 2) }}, (2) Connecting team backgrounds to execution capabilities, (3) Assessing full-time dedication, (4) Evaluating documented growth plans. Provide specific count (e.g., '2 of 3 operations criteria met') and explain how team experience supports these criteria.\",\n    \"dataSources\": [\"scorecard results\", \"team LinkedIn analysis\", \"operations assessment\"],\n    \"contextRequirements\": \"Assessment should directly reference scorecard operations category\",\n    \"tone\": \"Analytical, evidence-based\"\n  },\n  \n  // ===================\n  // BUSINESS MODEL SYNOPSIS\n  // ===================\n  \n  // AI-GENERATED CONTENT FIELD\n  \"valueProposition\": {\n    \"contentType\": \"Core value proposition analysis\",\n    \"instruction\": \"Synthesize the company's value proposition using: (1) Solution description {{ $json.extractedInformation.sections.solution }}, (2) Company website messaging, (3) Product demos or descriptions, (4) Customer testimonials if available. Focus on quantifiable benefits (e.g., '80% reduction in manual processes', 'improve accuracy by X%'). Should clearly articulate problem solved and measurable impact.\",\n    \"dataSources\": [\"proposal solution section\", \"company website\", \"product documentation\", \"customer case studies\"],\n    \"contextRequirements\": \"Must differentiate from competitors and show clear value\",\n    \"tone\": \"Customer-benefit focused, quantifiable\"\n  },\n  \n  // AI-GENERATED CONTENT FIELD\n  \"revenueModel\": {\n    \"contentType\": \"Revenue model and pricing strategy\",\n    \"instruction\": \"Detail the revenue model from: (1) Business model section {{ $json.extractedInformation.sections.businessModel }}, (2) Pricing page research, (3) Sales materials, (4) Financial projections. Include: Revenue type (SaaS, transaction, etc.), pricing tiers with specific amounts, contract terms, revenue recognition. Provide specific pricing examples.\",\n    \"dataSources\": [\"proposal business model\", \"company website pricing\", \"sales materials\", \"financial data\"],\n    \"contextRequirements\": \"Pricing should be competitive and support growth projections\",\n    \"tone\": \"Financial, specific, strategic\"\n  },\n  \n  // AI-GENERATED CONTENT FIELD\n  \"customerSegments\": {\n    \"contentType\": \"Target customer segmentation analysis\",\n    \"instruction\": \"Define target customer segments using: (1) Market description {{ $json.extractedInformation.sections.market }}, (2) Customer case studies, (3) Sales materials, (4) Website customer examples. Include: Company size ranges (employee count), industry verticals, geographic markets, use case categories. Be specific about ideal customer profile characteristics.\",\n    \"dataSources\": [\"proposal market section\", \"customer testimonials\", \"case studies\", \"sales documentation\"],\n    \"contextRequirements\": \"Segments should align with TAM analysis and GTM strategy\",\n    \"tone\": \"Market-focused, segmentation-specific\"\n  },\n  \n  // AI-GENERATED CONTENT FIELD\n  \"competitiveAdvantage\": {\n    \"contentType\": \"Sustainable competitive advantage analysis\",\n    \"instruction\": \"Identify competitive advantages from: (1) Solution differentiation: {{ $json.extractedInformation.sections.solution }}, (2) Technology stack research, (3) IP portfolio analysis, (4) Customer testimonials highlighting unique benefits. Focus on: Proprietary technology, data advantages, network effects, regulatory moats, partnership exclusivity. Must be defensible long-term advantages.\",\n    \"dataSources\": [\"proposal solution section\", \"technology documentation\", \"IP research\", \"customer feedback\"],\n    \"contextRequirements\": \"Advantages should create barriers to competitive entry\",\n    \"tone\": \"Strategic, differentiation-focused\"\n  },\n  \n  // ===================\n  // MARKET ANALYSIS - 30% WEIGHT\n  // ===================\n  \n  // AI-GENERATED CONTENT FIELD\n  \"currentMarketSize\": {\n    \"contentType\": \"Total addressable market sizing with sources\",\n    \"instruction\": \"Research and document TAM for {{ JSON.stringify( $json.marketSector) }} through: (1) Gartner, IDC, Forrester reports, (2) Industry association data, (3) Government statistics, (4) Recent market research reports. Provide: Current market size in billions, year of data, growth drivers, geographic scope. Include specific source attribution and link if possible. Focus on automation/software market within the sector.\",\n    \"dataSources\": [\"Gartner/IDC/Forrester reports\", \"industry research\", \"government data\", \"analyst reports\"],\n    \"contextRequirements\": \"Market size should support investment thesis and growth projections\",\n    \"tone\": \"Data-driven, source-attributed\"\n  },\n  \n  // AI-GENERATED CONTENT FIELD\n  \"geographicBreakdown\": {\n    \"contentType\": \"Regional market size analysis\",\n    \"instruction\": \"Break down TAM by major geographic regions using market research: (1) North America market size and percentage, (2) Europe market size and percentage, (3) Asia-Pacific market size and percentage, (4) Rest of World. Base on enterprise software adoption rates, economic data, and regional analysis reports. Provide dollar amounts and percentages that sum to total TAM.\",\n    \"dataSources\": [\"regional market reports\", \"enterprise software studies\", \"economic data\", \"technology adoption research\"],\n    \"contextRequirements\": \"Regional breakdown should align with company's expansion strategy\",\n    \"tone\": \"Geographic-analytical, percentage-focused\"\n  },\n  \n  // AI-GENERATED CONTENT FIELD\n  \"segmentAnalysis\": {\n    \"contentType\": \"Market segmentation by company size\",\n    \"instruction\": \"Segment the TAM by target company sizes using: (1) Enterprise software market data, (2) SMB technology adoption studies, (3) Industry reports on automation spending by company size. Provide: Enterprise (1000+ employees), Mid-market (100-999 employees), Small business (10-99 employees) with dollar amounts and adoption rationale for each segment.\",\n    \"dataSources\": [\"enterprise software reports\", \"SMB market studies\", \"technology spending analysis\", \"company size databases\"],\n    \"contextRequirements\": \"Segmentation should reflect realistic addressable market for company stage\",\n    \"tone\": \"Segmentation-focused, market-realistic\"\n  },\n  \n  // AI-GENERATED CONTENT FIELD\n  \"cagrPercent\": {\n    \"contentType\": \"Market compound annual growth rate\",\n    \"instruction\": \"Research market growth rate for {{ JSON.stringify( $json.marketSector) }} automation/software from: (1) Industry analyst reports, (2) Market research studies, (3) Technology trend analysis, (4) Investment research reports. Provide 5-year CAGR with timeframe (e.g., '2024-2029'). Focus on relevant sub-sector (AI, automation, SaaS) within broader market.\",\n    \"dataSources\": [\"analyst reports\", \"market research\", \"technology trend studies\", \"investment analysis\"],\n    \"contextRequirements\": \"Growth rate should support revenue projections and investment timeline\",\n    \"tone\": \"Growth-focused, timeframe-specific\"\n  },\n  \n  // DYNAMIC DATA FIELD with conditional logic\n  \"tamIncreasing\": \"{{ $json.answerSummary?.answers?.category_4 === 'Y' ? 'âœ“' : 'âœ—' }}\",\n  \n  // AI-GENERATED CONTENT FIELDS for growth drivers\n  \"growthDriver1\": {\n    \"contentType\": \"Primary market growth catalyst\",\n    \"instruction\": \"Identify the strongest market growth driver through research: (1) Digital transformation trends, (2) Regulatory changes, (3) Technology adoption patterns, (4) Economic factors. Provide specific trend with quantifiable impact (e.g., '40% increase in automation budget allocation'). Include supporting industry report or data source.\",\n    \"dataSources\": [\"industry trend reports\", \"technology adoption studies\", \"economic analysis\", \"corporate spending data\"],\n    \"contextRequirements\": \"Driver should directly benefit the company's solution category\",\n    \"tone\": \"Trend-analytical, quantified impact\"\n  },\n  \n  \"growthDriver2\": {\n    \"contentType\": \"Secondary market growth catalyst\",\n    \"instruction\": \"Research second major growth driver focusing on: (1) Regulatory compliance requirements, (2) Labor market changes, (3) Competitive pressures, (4) Technology advancement. Different from Driver 1, provide specific regulatory, workforce, or competitive dynamic driving market expansion.\",\n    \"dataSources\": [\"regulatory analysis\", \"labor market reports\", \"compliance studies\", \"competitive intelligence\"],\n    \"contextRequirements\": \"Should complement Driver 1 and support long-term market expansion\",\n    \"tone\": \"Regulatory/workforce-focused, market-driving\"\n  },\n  \n  \"growthDriver3\": {\n    \"contentType\": \"Tertiary market growth catalyst\",\n    \"instruction\": \"Identify third growth driver from: (1) Labor shortage impacts, (2) Operational efficiency demands, (3) Cost reduction pressures, (4) Innovation adoption. Focus on workforce or operational efficiency drivers that create demand for automation solutions.\",\n    \"dataSources\": [\"workforce studies\", \"operational efficiency reports\", \"cost analysis\", \"enterprise surveys\"],\n    \"contextRequirements\": \"Should address operational/efficiency aspects of market demand\",\n    \"tone\": \"Efficiency-focused, demand-driving\"\n  },\n  \n  // ===================\n  // COMPETITIVE LANDSCAPE ANALYSIS\n  // ===================\n  \n  // AI-GENERATED CONTENT FIELDS for competitive table\n  \"competitorCompA\": {\n    \"contentType\": \"Primary direct competitor identification\",\n    \"instruction\": \"Research and identify the largest direct competitor in {{ JSON.stringify($json.marketSector) }} automation/software space through: (1) Market share reports, (2) Industry analysis, (3) Competitive intelligence, (4) Customer comparison data. Focus on companies with similar solution categories and target markets.\",\n    \"dataSources\": [\"market share reports\", \"competitive analysis\", \"industry studies\", \"customer research\"],\n    \"contextRequirements\": \"Should be most significant competitive threat based on market position\",\n    \"tone\": \"Competitive-analytical, market-focused\"\n  },\n  \n  \"fundingX1\": {\n    \"contentType\": \"Competitor A total funding amount\",\n    \"instruction\": \"Research total funding raised by primary competitor through: (1) Crunchbase/PitchBook, (2) Press releases, (3) SEC filings, (4) Industry databases. Provide amount in millions. Use publicly available funding data.\",\n    \"dataSources\": [\"Crunchbase\", \"PitchBook\", \"press releases\", \"SEC filings\"],\n    \"contextRequirements\": \"Funding level should reflect competitive threat and market validation\",\n    \"tone\": \"Financial data, factual\"\n  },\n  \n  \"valuation1\": {\n    \"contentType\": \"Competitor A current/peak valuation\",\n    \"instruction\": \"Research latest valuation of primary competitor from: (1) Recent funding announcements, (2) Public market data if traded, (3) Industry valuation reports, (4) M&A transaction data. Provide in millions, note if peak vs current valuation.\",\n    \"dataSources\": [\"funding announcements\", \"public market data\", \"valuation reports\", \"M&A databases\"],\n    \"contextRequirements\": \"Valuation should provide competitive benchmark for investment\",\n    \"tone\": \"Valuation-analytical, market-comparative\"\n  },\n  \n  \"marketSharePercent1\": {\n    \"contentType\": \"Competitor A market share percentage\",\n    \"instruction\": \"Estimate market share of primary competitor using: (1) Industry analyst reports, (2) Revenue estimates vs total market size, (3) Customer count analysis, (4) Geographic presence assessment. Provide percentage of addressable market.\",\n    \"dataSources\": [\"analyst reports\", \"revenue estimates\", \"customer analysis\", \"market studies\"],\n    \"contextRequirements\": \"Market share should reflect realistic competitive position\",\n    \"tone\": \"Share-analytical, percentage-specific\"\n  },\n  \n  // Repeat similar structure for competitorCompB and competitorCompC with instructions for second and third largest competitors\n  \n  \"competitorCompB\": {\n    \"contentType\": \"Secondary direct competitor\",\n    \"instruction\": \"Identify second major competitor using same methodology as Competitor A, focusing on different company to provide competitive landscape diversity.\",\n    \"dataSources\": [\"market analysis\", \"competitive intelligence\", \"industry reports\"],\n    \"contextRequirements\": \"Should represent different competitive approach or market segment\",\n    \"tone\": \"Competitive-analytical\"\n  },\n  \n  \"fundingX2\": {\n    \"contentType\": \"Competitor B funding data\",\n    \"instruction\": \"Research funding for secondary competitor using same sources and methodology as Competitor A.\",\n    \"dataSources\": [\"funding databases\", \"press releases\"],\n    \"contextRequirements\": \"Should provide competitive funding benchmark\",\n    \"tone\": \"Financial factual\"\n  },\n  \n  \"valuation2\": {\n    \"contentType\": \"Competitor B valuation data\", \n    \"instruction\": \"Research valuation for secondary competitor using same methodology as Competitor A.\",\n    \"dataSources\": [\"valuation databases\", \"market data\"],\n    \"contextRequirements\": \"Should provide additional competitive valuation reference\",\n    \"tone\": \"Valuation-comparative\"\n  },\n  \n  \"marketSharePercent2\": {\n    \"contentType\": \"Competitor B market share\",\n    \"instruction\": \"Estimate market share for secondary competitor using same methodology as Competitor A.\",\n    \"dataSources\": [\"market analysis\", \"competitive reports\"],\n    \"contextRequirements\": \"Should show competitive landscape distribution\",\n    \"tone\": \"Market-analytical\"\n  },\n  \n  \"competitorCompC\": {\n    \"contentType\": \"Third major competitor or platform threat\",\n    \"instruction\": \"Identify third competitive threat, which may include: (1) Large platform players (Microsoft, Salesforce), (2) Emerging competitors, (3) Alternative solution categories. Focus on different competitive vector than A and B.\",\n    \"dataSources\": [\"platform analysis\", \"emerging company tracking\", \"alternative solution research\"],\n    \"contextRequirements\": \"Should represent broader competitive ecosystem threat\",\n    \"tone\": \"Platform/ecosystem-focused\"\n  },\n  \n  \"fundingX3\": {\n    \"contentType\": \"Competitor C funding/resources\",\n    \"instruction\": \"For platform competitors, note 'N/A' or 'Embedded'. For startup competitors, research funding using same methodology.\",\n    \"dataSources\": [\"corporate data\", \"funding databases\"],\n    \"contextRequirements\": \"Should reflect resource availability for competition\",\n    \"tone\": \"Resource-analytical\"\n  },\n  \n  \"valuation3\": {\n    \"contentType\": \"Competitor C valuation/market cap\",\n    \"instruction\": \"For public companies, use market cap. For platforms, note 'Embedded'. For private companies, research latest valuation.\",\n    \"dataSources\": [\"public market data\", \"private valuation reports\"],\n    \"contextRequirements\": \"Should provide scale context for competitive threat\",\n    \"tone\": \"Scale-comparative\"\n  },\n  \n  \"marketSharePercent3\": {\n    \"contentType\": \"Competitor C market presence\",\n    \"instruction\": \"Estimate market share or penetration using same methodology, noting platform advantages or emerging status.\",\n    \"dataSources\": [\"market penetration analysis\", \"platform usage data\"],\n    \"contextRequirements\": \"Should complete competitive landscape picture\",\n    \"tone\": \"Penetration-analytical\"\n  },\n  \n  // ===================\n  // COMPETITIVE POSITIONING\n  // ===================\n  \n  // AI-GENERATED CONTENT FIELD\n  \"marketPosition\": {\n    \"contentType\": \"Strategic market positioning analysis\",\n    \"instruction\": \"Define the company's competitive position based on: (1) Differentiation analysis vs competitors researched above, (2) Target market focus and approach, (3) Technology/product advantages, (4) Realistic market share opportunity. Position as 'emerging challenger', 'niche leader', 'disruptor', etc. Include 3-year market share target with rationale.\",\n    \"dataSources\": [\"competitive analysis\", \"differentiation research\", \"market opportunity assessment\"],\n    \"contextRequirements\": \"Position should be realistic given company stage and competitive landscape\",\n    \"tone\": \"Strategic, positioning-focused\"\n  },\n  \n  // AI-GENERATED CONTENT FIELD\n  \"differentiationAnalysis\": {\n    \"contentType\": \"Key differentiation factors vs competition\",\n    \"instruction\": \"Analyze competitive differentiation using: (1) Technology comparison research, (2) Feature/capability analysis, (3) Customer feedback and testimonials, (4) Pricing/model differences. Identify 3-4 specific advantages that create competitive moats.\",\n    \"dataSources\": [\"technology comparison\", \"feature analysis\", \"customer testimonials\", \"pricing research\"],\n    \"contextRequirements\": \"Differentiation should be sustainable and valuable to customers\",\n    \"tone\": \"Advantage-focused, specific\"\n  },\n  \n  // AI-GENERATED CONTENT FIELD\n  \"barrierToEntryAssessment\": {\n    \"contentType\": \"Industry barrier to entry evaluation\", \n    \"instruction\": \"Assess barriers to entry in the market using: (1) Technology complexity analysis, (2) Customer acquisition requirements, (3) Regulatory/compliance needs, (4) Capital requirements. Rate as High/Medium/Low with specific rationale for each factor.\",\n    \"dataSources\": [\"technology analysis\", \"market research\", \"regulatory requirements\", \"capital analysis\"],\n    \"contextRequirements\": \"Assessment should consider both opportunities and threats\",\n    \"tone\": \"Analytical, barrier-focused\"\n  },\n  \n  // ===================\n  // INDUSTRY TRENDS & DYNAMICS\n  // ===================\n  \n  // DYNAMIC DATA FIELD with conditional logic\n  \"scorecardCheck\": \"{{ $json.answerSummary?.answers?.category_1 === 'Y' ? 'âœ“' : 'âœ—' }}\",\n  \n  // AI-GENERATED CONTENT FIELD\n  \"currentRegulations\": {\n    \"contentType\": \"Current regulatory environment analysis\",\n    \"instruction\": \"Research current regulations affecting {{ $json.marketSector }} automation/software through: (1) Government regulatory sites, (2) Industry compliance reports, (3) Legal analysis, (4) Corporate regulatory filings. Focus on: Data protection (GDPR), financial compliance (SOX), industry-specific regulations. Provide specific regulation names and impact.\",\n    \"dataSources\": [\"government sites\", \"compliance reports\", \"legal databases\", \"industry analysis\"],\n    \"contextRequirements\": \"Regulations should directly impact business model or operations\",\n    \"tone\": \"Regulatory-focused, compliance-aware\"\n  },\n  \n  // AI-GENERATED CONTENT FIELD\n  \"pendingChanges\": {\n    \"contentType\": \"Upcoming regulatory changes analysis\",\n    \"instruction\": \"Research pending regulatory changes through: (1) Government proposal tracking, (2) Industry association alerts, (3) Legal trend analysis, (4) Policy research organizations. Focus on: AI governance, data localization, privacy enhancements. Include expected timeline (2025-2026).\",\n    \"dataSources\": [\"government proposals\", \"policy tracking\", \"legal trend analysis\", \"industry associations\"],\n    \"contextRequirements\": \"Changes should potentially impact business operations or opportunities\",\n    \"tone\": \"Forward-looking, change-preparatory\"\n  },\n  \n  // AI-GENERATED CONTENT FIELD\n  \"complianceStatus\": {\n    \"contentType\": \"Company regulatory compliance assessment\",\n    \"instruction\": \"Evaluate company's compliance position based on: (1) Website privacy/compliance pages, (2) Proposal regulatory mentions, (3) Industry best practices, (4) Customer requirements. Assess current compliance level and preparedness for pending changes.\",\n    \"dataSources\": [\"company compliance documentation\", \"proposal materials\", \"industry standards\"],\n    \"contextRequirements\": \"Status should reflect realistic compliance capabilities\",\n    \"tone\": \"Compliance-focused, preparedness-oriented\"\n  },\n  \n  // AI-GENERATED CONTENT FIELD\n  \"sources\": {\n    \"contentType\": \"Regulatory research source attribution\",\n    \"instruction\": \"List primary sources used for regulatory analysis: (1) Government regulatory websites, (2) Industry legal databases, (3) Compliance report sources, (4) Legal analysis publications. Provide general source categories for transparency.\",\n    \"dataSources\": [\"source documentation\", \"research attribution\"],\n    \"contextRequirements\": \"Sources should be authoritative and current\",\n    \"tone\": \"Attribution-focused, credible\"\n  },\n  \n  // ===================\n  // Continue with similar detailed instructions for all remaining fields...\n  // PRODUCT & TECHNOLOGY, OPERATIONAL ASSESSMENT, FINANCIAL ANALYSIS\n  // ===================\n  \n  // For brevity, including key examples from remaining sections:\n  \n  // AI-GENERATED CONTENT FIELD\n  \"productStage\": {\n    \"contentType\": \"Product development stage classification\",\n    \"instruction\": \"Assess product maturity through: (1) Company website product information, (2) Customer testimonials and case studies, (3) Proposal product descriptions, (4) Demo availability and functionality. Classify as: MVP, Beta, GA (Generally Available), or Mature. Base on customer adoption and feature completeness.\",\n    \"dataSources\": [\"product documentation\", \"customer evidence\", \"demo analysis\", \"proposal materials\"],\n    \"contextRequirements\": \"Stage should align with revenue generation and customer adoption\",\n    \"tone\": \"Product-maturity focused\"\n  },\n  \n  // Continue this pattern for ALL remaining fields...\n  // Each field needs: contentType, instruction, dataSources, contextRequirements, tone\n  \n  // Revenue table entries as AI-GENERATED with specific financial research instructions\n  \"revenue2023\": {\n    \"contentType\": \"Historical revenue for 2023\",\n    \"instruction\": \"Research 2023 revenue through: (1) Financial statements if available, (2) Proposal financial section {{ $json.extractedInformation.sections.financial }}, (3) Press releases, (4) Investor presentations. Provide amount in thousands (K format). If not available, estimate based on customer count and pricing model.\",\n    \"dataSources\": [\"financial statements\", \"proposal data\", \"press releases\", \"revenue estimates\"],\n    \"contextRequirements\": \"Should align with company stage and growth trajectory\",\n    \"tone\": \"Financial-factual\"\n  }\n  \n  // [Continue with all remaining fields following this pattern...]\n}\n\n## CONTENT GENERATION GUIDELINES:\n\n### For AI-Generated Content Fields:\n1. **Always conduct research** using the specified data sources before generating content\n2. **Synthesize multiple sources** to create comprehensive, accurate content\n3. **Include specific data points** (numbers, percentages, dates) when available\n4. **Attribute sources** appropriately in content where specified\n5. **Maintain consistency** across related fields\n6. **Use professional investment analysis tone** throughout\n\n### For Dynamic Data Fields:\n1. **Use exact variable syntax** as specified with notation\n2. **Implement conditional logic** for scorecard-based fields\n3. **Ensure data type consistency** (strings, numbers, percentages)\n4. **Maintain data relationship integrity** across connected fields\n\n### Quality Standards:\n- Replace ALL placeholder text with researched data\n- Ensure minimum 20 characters per critical section\n- Use specific numbers and sources where available\n- Maintain professional investment analysis tone\n- Provide actionable insights and clear recommendations\n\n**Generate ONLY the JSON object with no additional text. Ensure every AI-generated field contains substantive, researched content that seamlessly integrates into the investment analysis report.**"
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 2,
        "position": [
          2464,
          288
        ],
        "id": "e34558ad-a7d2-4659-a93e-ce46597a7078",
        "name": "Investment Analyst Report Agent"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 1
            },
            "conditions": [
              {
                "leftValue": "={{ $json.workflowMetadata?.isProposalComplete }}",
                "rightValue": "={{ false }}",
                "operator": {
                  "type": "boolean",
                  "operation": "equals"
                },
                "id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890"
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2,
        "position": [
          -224,
          160
        ],
        "id": "082a24ba-9db6-41f4-b2c6-f674f9b4a51f",
        "name": "Is Proposal Incomplete? (FIXED)"
      },
      {
        "parameters": {
          "descriptionType": "manual",
          "toolDescription": "=Get deal scorecard results by company name",
          "documentId": {
            "__rl": true,
            "value": "1S0yVMf5ntHCLMXQYvtoRgLdaEOw758UeZz7rZUjN4H0",
            "mode": "list",
            "cachedResultName": "Scorecard and Results",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1S0yVMf5ntHCLMXQYvtoRgLdaEOw758UeZz7rZUjN4H0/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Results",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1S0yVMf5ntHCLMXQYvtoRgLdaEOw758UeZz7rZUjN4H0/edit#gid=0"
          },
          "filtersUI": {
            "values": [
              {
                "lookupColumn": "Company Name",
                "lookupValue": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('values0_Value', ``, 'string') }}"
              },
              {
                "lookupColumn": "Total - Score",
                "lookupValue": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('values1_Value', ``, 'string') }}"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheetsTool",
        "typeVersion": 4.6,
        "position": [
          2512,
          624
        ],
        "id": "cfa4b0a5-604c-4f23-9b19-699ea99ade8b",
        "name": "Get deal scorecard results",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "Ewb3ZoqCnjfRwedF",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "operation": "append",
          "documentId": {
            "__rl": true,
            "value": "1S0yVMf5ntHCLMXQYvtoRgLdaEOw758UeZz7rZUjN4H0",
            "mode": "list",
            "cachedResultName": "Scorecard-Results",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1S0yVMf5ntHCLMXQYvtoRgLdaEOw758UeZz7rZUjN4H0/edit?usp=drivesdk"
          },
          "sheetName": {
            "__rl": true,
            "value": "gid=0",
            "mode": "list",
            "cachedResultName": "Results",
            "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1S0yVMf5ntHCLMXQYvtoRgLdaEOw758UeZz7rZUjN4H0/edit#gid=0"
          },
          "columns": {
            "mappingMode": "defineBelow",
            "value": {
              "Company Name": "={{ $json.output.dealName }}",
              "Date": "={{ $now }}",
              "Total - Score": "={{ $json.output.totalScore }}",
              "Category Question 1 - Score": "={{ $json.output.criteria.category.category_1.score }}",
              "Category - Question 2 - Score": "={{ $json.output.criteria.category.category_2.score }}",
              "Category - Question 3 - Score": "={{ $json.output.criteria.category.category_3.score }}",
              "Category - Question 4 - Score": "={{ $json.output.criteria.category.category_4.score }}",
              "Category - SubTotal - Score": "={{ $json.output.criteria.category.subtotal }}",
              "Product - SubTotal - Score": "={{ $json.output.criteria.product.subtotal }}",
              " Product - Question 3 - Score": "={{ $json.output.criteria.product.product_3.score }}",
              "Product - Question 2 - Score": "={{ $json.output.criteria.product.product_2.score }}",
              "Product - Question 1 - Score": "={{ $json.output.criteria.product.product_1.score }}",
              "Operations - SubTotal - Score": "={{ $json.output.criteria.operations.subtotal }}",
              "Operations - Question 3 - Score": "={{ $json.output.criteria.operations.operations_3.score }}",
              "Operations - Question 2 - Score": "={{ $json.output.criteria.operations.operations_2.score }}",
              "Operations - Question 1 - Score": "={{ $json.output.criteria.operations.operations_1.score }}",
              "Financial - SubTotal - Score": "={{ $json.output.criteria.financial.subtotal }}",
              "Financial - Question 5 - Score": "={{ $json.output.criteria.financial.financial_5.score }}",
              "Financial - Question 4 - Score": "={{ $json.output.criteria.financial.financial_4.score }}",
              "Financial - Question 3 - Score": "={{ $json.output.criteria.financial.financial_3.score }}",
              "Financial - Question 2 - Score": "={{ $json.output.criteria.financial.financial_2.score }}",
              "Financial - Question 1 - Score": "={{ $json.output.criteria.financial.financial_1.score }}"
            },
            "matchingColumns": [],
            "schema": [
              {
                "id": "Company Name",
                "displayName": "Company Name",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "Date",
                "displayName": "Date",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "Total - Score",
                "displayName": "Total - Score",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true
              },
              {
                "id": "Category Question 1 - Score",
                "displayName": "Category Question 1 - Score",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "Category - Question 2 - Score",
                "displayName": "Category - Question 2 - Score",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "Category - Question 3 - Score",
                "displayName": "Category - Question 3 - Score",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "Category - Question 4 - Score",
                "displayName": "Category - Question 4 - Score",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "Category - SubTotal - Score",
                "displayName": "Category - SubTotal - Score",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "Product - Question 1 - Score",
                "displayName": "Product - Question 1 - Score",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "Product - Question 2 - Score",
                "displayName": "Product - Question 2 - Score",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": " Product - Question 3 - Score",
                "displayName": " Product - Question 3 - Score",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "Product - SubTotal - Score",
                "displayName": "Product - SubTotal - Score",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "Operations - Question 1 - Score",
                "displayName": "Operations - Question 1 - Score",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "Operations - Question 2 - Score",
                "displayName": "Operations - Question 2 - Score",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "Operations - Question 3 - Score",
                "displayName": "Operations - Question 3 - Score",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "Operations - SubTotal - Score",
                "displayName": "Operations - SubTotal - Score",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "Financial - Question 1 - Score",
                "displayName": "Financial - Question 1 - Score",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "Financial - Question 2 - Score",
                "displayName": "Financial - Question 2 - Score",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "Financial - Question 3 - Score",
                "displayName": "Financial - Question 3 - Score",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "Financial - Question 4 - Score",
                "displayName": "Financial - Question 4 - Score",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "Financial - Question 5 - Score",
                "displayName": "Financial - Question 5 - Score",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              },
              {
                "id": "Financial - SubTotal - Score",
                "displayName": "Financial - SubTotal - Score",
                "required": false,
                "defaultMatch": false,
                "display": true,
                "type": "string",
                "canBeUsedToMatch": true,
                "removed": false
              }
            ],
            "attemptToConvertTypes": false,
            "convertFieldsToString": false
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleSheets",
        "typeVersion": 4.6,
        "position": [
          1744,
          288
        ],
        "id": "87036e9f-3642-4445-9f71-e02509730c54",
        "name": "Save Scorecard Results",
        "credentials": {
          "googleSheetsOAuth2Api": {
            "id": "Ewb3ZoqCnjfRwedF",
            "name": "Google Sheets account"
          }
        }
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "3b20573b-1b91-4334-b2b1-b3a7c81d2c11",
                "name": "email",
                "value": "={{ $('Extract Proposal Data Requirements').item.json.founderEmail }}",
                "type": "string"
              },
              {
                "id": "96371793-3fc5-41b8-b563-072b992fcbe0",
                "name": "companyName",
                "value": "={{ $('Merge').item.json.originalData.companyName }}",
                "type": "string"
              },
              {
                "id": "cd11ba70-1809-4650-ad53-3aa582c56f4e",
                "name": "founderName",
                "value": "={{ $('Extract Proposal Data Requirements').item.json.founderName }}",
                "type": "string"
              },
              {
                "id": "f2b90a55-2065-428d-b07e-561bf21bf630",
                "name": "teamInfo",
                "value": "={{ $('Extract Proposal Data Requirements').item.json.teamInfo }}",
                "type": "object"
              },
              {
                "id": "76020a67-4bcf-40e2-a17e-e9ca926ca1d8",
                "name": "foundersLinkedInUrl",
                "value": "={{ $('Extract Proposal Data Requirements').item.json.founderLinkedIn }}",
                "type": "string"
              },
              {
                "id": "ec842e77-3544-4d03-a7e2-4fc6bb1d98e0",
                "name": "submittedAt",
                "value": "={{ $now }}",
                "type": "string"
              },
              {
                "id": "4273bc41-96b3-4712-8f37-4a7fd5f36024",
                "name": "investmentAnalystReportId",
                "value": "={{ $json.id }}",
                "type": "string"
              },
              {
                "id": "9490e745-8d27-44f0-b837-51342398b8a7",
                "name": "marketSector",
                "value": "={{ $('Extract Proposal Data Requirements').item.json.marketSector }}",
                "type": "object"
              },
              {
                "id": "868134da-2cf8-4961-a449-fa3dd9629858",
                "name": "extractedInformation",
                "value": "={{ $('Extract Proposal Data Requirements').item.json.rawExtraction }}",
                "type": "object"
              },
              {
                "id": "7e0a57fb-cafc-484a-ad30-7fd6a56fab33",
                "name": "Uploaded Proposal id",
                "value": "={{ $('Upload File').item.json.id }}",
                "type": "string"
              },
              {
                "id": "1dd0d9fc-27c1-45e4-a837-b411047c03dc",
                "name": "questions",
                "value": "={{ $('Generate Yes/No answers scorecard questions1').item.json.questionBreakdown }}",
                "type": "array"
              },
              {
                "id": "a00f4f0f-214b-454e-be80-61912fd3b7d7",
                "name": "totalScore",
                "value": "={{ $('Generate Yes/No answers scorecard questions1').item.json.score }}",
                "type": "object"
              },
              {
                "id": "fb19074f-9466-4426-9abf-a1fdd58c8059",
                "name": "fileId",
                "value": "={{ $json.id }}",
                "type": "string"
              },
              {
                "id": "bbfd0b90-237b-4070-9197-c01cd12d168f",
                "name": "name",
                "value": "={{ $json.name }}",
                "type": "string"
              },
              {
                "id": "f48b10a0-d0e4-43b0-98f8-1b5c9ad228af",
                "name": "categoryScores",
                "value": "={{ $('Generate Yes/No answers scorecard questions1').item.json.categoryScores }}",
                "type": "object"
              },
              {
                "id": "bb08e035-6b62-44bd-ae1b-fa2741ef33cf",
                "name": "detailedEvaluation",
                "value": "={{ $('Generate Yes/No answers scorecard questions1').item.json.detailedEvaluation }}",
                "type": "object"
              },
              {
                "id": "113a29c3-3859-4b03-a09c-af7a0c510298",
                "name": "answerSummary",
                "value": "={{ $('Generate Yes/No answers scorecard questions1').item.json.answerSummary }}",
                "type": "object"
              },
              {
                "id": "b89d55a8-0447-4a3d-8fe2-c522a6b52dd4",
                "name": "marketSector",
                "value": "={{ $('Extract Proposal Data Requirements').item.json.marketSector }}",
                "type": "object"
              },
              {
                "id": "50f61afd-016d-4e66-920f-e6f098c2ecd9",
                "name": "companyContact",
                "value": "={{ $('Extract Proposal Data Requirements').item.json.companyContact }}",
                "type": "object"
              },
              {
                "id": "a970ad84-14c2-4fa1-8b48-1f5c70a8e11e",
                "name": "companyDetails",
                "value": "={{ $('Extract Proposal Data Requirements').item.json.companyDetails }}",
                "type": "object"
              },
              {
                "id": "3db671f2-d648-4633-9426-5fdbe9027f45",
                "name": "companyContact.website",
                "value": "={{ $('Extract Proposal Data Requirements').item.json.companyContact.website }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          2208,
          288
        ],
        "id": "7c94f313-e455-4dee-9747-35d5ffd545e4",
        "name": "Report Data Prep"
      },
      {
        "parameters": {
          "operation": "copy",
          "fileId": {
            "__rl": true,
            "value": "=1cv9HmDkAGMwpCdWqDTWdm5-ddD9Zw99SHpsIlRXo90I",
            "mode": "id"
          },
          "name": "=Investment Analysis Report-{{ $('Prep Scorecard Data1').item.json.companyName }}",
          "options": {}
        },
        "type": "n8n-nodes-base.googleDrive",
        "typeVersion": 3,
        "position": [
          2016,
          288
        ],
        "id": "18023692-135d-4e61-ad29-d0727548a32f",
        "name": "Use Investment Analysis Report Template 1",
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "DQWWWj2hk7oMPymA",
            "name": "Google Drive account"
          }
        }
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "rejection-type",
                "name": "rejectionType",
                "value": "INCOMPLETE",
                "type": "string"
              },
              {
                "id": "copy-data",
                "name": "originalData",
                "value": "={{ $json }}",
                "type": "object"
              },
              {
                "id": "company-name",
                "name": "companyName",
                "value": "={{ $json.companyName }}",
                "type": "string"
              },
              {
                "id": "founder-name",
                "name": "founderName",
                "value": "={{ $json.founderName }}",
                "type": "string"
              },
              {
                "id": "founder-email",
                "name": "founderEmail",
                "value": "={{ $json.founderEmail }}",
                "type": "string"
              },
              {
                "id": "missing-sections",
                "name": "missingRequiredSections",
                "value": "={{ $json.workflowMetadata?.missingRequiredSections }}",
                "type": "array"
              },
              {
                "id": "completeness-score",
                "name": "completenessScore",
                "value": "={{ $json.workflowMetadata?.completenessScore }}",
                "type": "number"
              },
              {
                "id": "workflow-metadata-object",
                "name": "workflowMetadataObj",
                "value": "={{ Object.fromEntries($json.workflowMetadata.missingRequiredSections.map((section, index) => [`section_${index}`, section])) }}",
                "type": "object"
              },
              {
                "id": "timestamp",
                "name": "waitStartedAt",
                "value": "={{ new Date().toISOString() }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          624,
          -304
        ],
        "id": "2031673b-37ff-499a-a00a-c34d1ee1c803",
        "name": "Set INCOMPLETE Rejection"
      },
      {
        "parameters": {
          "promptType": "define",
          "text": "=Generate professional emails based on the results of the scorecard test (FAIL, MONITOR, or INCOMPLETE).\nCurrent Data:\n\nRejection Type: {{ $json.rejectionType?.toUpperCase() || 'INCOMPLETE' }}\nScore: {{ Math.round(($json.originalData?.score?.numeric || 0) * 100) }}%\nCompany Name: {{ $json.originalData?.companyName || $json.companyName || 'Unknown Company' }}\nDate: {{ new Date().toLocaleDateString() }}\nContact Person: {{ $json.founderName || $json.originalData?.founderName || 'Founder' }}\nContact Email: {{ $json.founderEmail || $json.originalData?.founderEmail || 'Email Address' }}\nCompleteness Score: {{ Math.round(($json.originalData?.workflowMetadata?.completenessScore || 0) * 100) }}%\nMissing Sections: {{ $json.originalData?.workflowMetadata?.missingRequiredSections?.join(', ') || 'N/A' }}\n\n{{$json.founderName}} â†’ Contact person name\n{{$json.founderEmail}} â†’ Contact email address\n{{$json.companyName}} â†’ Company name\n\n\n## From Set INCOMPLETE Rejection Node:\n\n{{$json.rejectionType}} â†’ Rejection type ('INCOMPLETE')\n{{$json.originalData}} â†’ Complete original data object\n{{$json.originalData.workflowMetadata.missingRequiredSections}} â†’ Array of missing sections\n{{$json.originalData.workflowMetadata.completenessScore}} â†’ Completeness percentage\n{{$json.waitStartedAt}} â†’ Timestamp\n\n## Score Calculation (n8n Expression Syntax):\n\nFor percentage display: {{ Math.round((($json.originalData.score && $json.originalData.score.numeric) ? $json.originalData.score.numeric : 0) * 100) }}\nFor completeness: {{ Math.round((($json.originalData.workflowMetadata && $json.originalData.workflowMetadata.completenessScore) ? $json.originalData.workflowMetadata.completenessScore : 0) * 100) }}\n\n## Alternative Simplified Expressions:\n\nScore percentage: {{ ($json.originalData.score.numeric * 100).toFixed(0) }}\nCompleteness percentage: {{ ($json.originalData.workflowMetadata.completenessScore * 100).toFixed(0) }}",
          "hasOutputParser": true,
          "options": {
            "systemMessage": "=You are an AI assistant specialized in generating professional rejection emails for investment proposals based on scorecard evaluation results.\n\nProcess the data and generate clean, professional messaging HTML email templates based on the rejection type: INCOMPLETE | FAIL | MONITOR.\n\n## Output Format\nGenerate clean, professional HTML email templates with simple black, gray, and white color scheme. Each template should include:\n\n- Clean, minimalist design with proper spacing and typography\n- Mobile-responsive layout\n- Professional appearance with clear visual hierarchy\n- Proper HTML email formatting for maximum compatibility\n- NO emojis or decorative elements\n\nYour output should include:\n- Contact Person: {{ $json.founderName || 'Founder' }}\n- Contact Email: {{ $json.founderEmail || 'Email Address' }}\n- Subject: [Dynamic subject based on rejection type]\n- Message: [Complete HTML email body with conditional content]\n\n## Template Selection Logic\nCondition Expression:\n```javascript\n{{\n  $json.rejectionType === 'INCOMPLETE' || \n  !$json.originalData?.text || \n  $json.originalData?.workflowMetadata?.completenessScore < 0.5 || \n  $json.originalData?.companyName === 'Unknown Company' ? 'INCOMPLETE' :\n  \n  $json.rejectionType === 'MONITOR' || \n  ($json.originalData?.score?.numeric >= 0.45 && $json.originalData?.score?.numeric < 0.60) ? 'MONITOR' :\n  \n  $json.rejectionType === 'FAIL' || \n  $json.originalData?.score?.numeric < 0.45 ? 'FAIL' :\n  \n  'ERROR'\n}}\n```\n\n## Unified HTML Email Template\n\n**Dynamic Subject:**\n```\n{{ $json.rejectionType === 'INCOMPLETE' ? \n   ($json.originalData?.companyName || 'Investment Proposal') + ' - Additional Information Required' :\n   $json.rejectionType === 'MONITOR' ? \n   ($json.originalData?.companyName || 'Investment Proposal') + ' - Investment Proposal Status Update' :\n   ($json.originalData?.companyName || 'Investment Proposal') + ' - Investment Proposal Decision'\n}}\n```\n\n**HTML Email Body:**\n```html\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Investment Proposal Response</title>\n</head>\n<body style=\"margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; background-color: #ffffff;\">\n    <table role=\"presentation\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" width=\"100%\" style=\"background-color: #ffffff;\">\n        <tr>\n            <td align=\"center\" style=\"padding: 40px 20px;\">\n                <table role=\"presentation\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" width=\"600\" style=\"background-color: #ffffff; border: 1px solid #e0e0e0;\">\n                    <!-- Header -->\n                    <tr>\n                        <td style=\"background-color: #ffffff; padding: 30px 40px; border-bottom: 1px solid #e0e0e0;\">\n                            <h1 style=\"margin: 0; color: #000000; font-size: 24px; font-weight: 400; text-align: center;\">ONE EIGHTY VENTURES</h1>\n                            <p style=\"margin: 10px 0 0; color: #666666; font-size: 12px; text-align: center; letter-spacing: 2px; text-transform: uppercase;\">Investment Analysis Team</p>\n                        </td>\n                    </tr>\n                    \n                    <!-- Dynamic Status Bar -->\n                    <tr>\n                        <td style=\"background-color: #ffffff; padding: 15px 40px; border-bottom: 1px solid #e0e0e0;\">\n                            <p style=\"margin: 0; color: #000000; font-size: 13px; text-transform: uppercase; letter-spacing: 1px; text-align: center;\">\n                                <strong>\n                                {{ $json.rejectionType === 'INCOMPLETE' ? 'Status: Additional Information Required' :\n                                   $json.rejectionType === 'MONITOR' ? 'Status: Monitoring List' :\n                                   'Investment Decision'\n                                }}\n                                </strong>\n                            </p>\n                        </td>\n                    </tr>\n                    \n                    <!-- Conditional Score Display (only for MONITOR) -->\n                    {{ $json.rejectionType === 'MONITOR' ? `\n                    <tr>\n                        <td align=\"center\" style=\"padding: 30px 40px 20px; background-color: #ffffff;\">\n                            <div style=\"border: 2px solid #e0e0e0; padding: 20px; display: inline-block; background-color: #ffffff;\">\n                                <p style=\"margin: 0 0 5px; color: #666666; font-size: 12px; text-transform: uppercase; letter-spacing: 1px;\">Proposal Score</p>\n                                <h2 style=\"margin: 0; color: #000000; font-size: 36px; font-weight: 700;\">${($json.originalData.score.numeric * 100).toFixed(0)}%</h2>\n                                <p style=\"margin: 5px 0 0; color: #666666; font-size: 12px;\">Minimum Required: 60%</p>\n                            </div>\n                        </td>\n                    </tr>\n                    ` : '' }}\n                    \n                    <!-- Main Content -->\n                    <tr>\n                        <td style=\"padding: 40px; background-color: #ffffff;\">\n                            <p style=\"color: #000000; font-size: 15px; line-height: 1.6; margin: 0 0 20px;\">\n                                Dear {{ $json.founderName || 'Founder' }},\n                            </p>\n                            \n                            <!-- Opening Paragraph -->\n                            <p style=\"color: #000000; font-size: 15px; line-height: 1.6; margin: 0 0 25px;\">\n                                {{ $json.rejectionType === 'INCOMPLETE' ? \n                                   'Thank you for submitting your investment proposal. We appreciate your interest in partnering with One Eighty Ventures.' :\n                                   `Thank you for submitting your investment proposal for <strong>${$json.originalData?.companyName || $json.companyName}</strong>. ${$json.rejectionType === 'MONITOR' ? 'After careful review, your proposal did not meet our minimum investment criteria at this time.' : 'We appreciate your interest in partnering with our fund and the opportunity to review your business.'}`\n                                }}\n                            </p>\n                            \n                            <!-- Main Message Content -->\n                            {{ $json.rejectionType === 'INCOMPLETE' ? `\n                            <p style=\"color: #000000; font-size: 15px; line-height: 1.6; margin: 0 0 25px;\">\n                                Upon initial review, we found that your submission is missing critical information necessary for our evaluation process. Our analysis shows a completeness score of ${($json.originalData.workflowMetadata.completenessScore * 100).toFixed(0)}%, which is below our minimum threshold for comprehensive evaluation.\n                            </p>\n                            \n                            <div style=\"background-color: #ffffff; border: 1px solid #e0e0e0; padding: 20px; margin: 0 0 25px;\">\n                                <h4 style=\"margin: 0 0 15px; color: #000000; font-size: 14px; font-weight: 600;\">Missing Required Sections:</h4>\n                                <ul style=\"margin: 0; padding-left: 20px; color: #000000; line-height: 1.8;\">\n                                    ${$json.originalData?.workflowMetadata?.missingRequiredSections?.map(section => `<li style=\"margin-bottom: 8px;\">${section}</li>`).join('') || '<li>Complete pitch deck with all required sections</li>'}\n                                </ul>\n                            </div>\n                            \n                            <p style=\"color: #000000; font-size: 15px; line-height: 1.6; margin: 0 0 25px;\">\n                                Our investment evaluation process requires comprehensive information across all key criteria. Please ensure your pitch deck includes:\n                            </p>\n                            \n                            <ul style=\"color: #000000; font-size: 15px; line-height: 1.8; padding-left: 20px; margin: 0 0 30px;\">\n                                <li style=\"margin-bottom: 8px;\">Clear company overview with founding information</li>\n                                <li style=\"margin-bottom: 8px;\">Detailed market analysis with TAM calculation</li>\n                                <li style=\"margin-bottom: 8px;\">Product roadmap and development status</li>\n                                <li style=\"margin-bottom: 8px;\">Team bios and organizational structure</li>\n                                <li style=\"margin-bottom: 8px;\">Financial projections and current revenue metrics</li>\n                                <li style=\"margin-bottom: 8px;\">Business model and go-to-market strategy</li>\n                                <li style=\"margin-bottom: 8px;\">Current traction and customer validation</li>\n                                <li style=\"margin-bottom: 0;\">IP protection and competitive advantages</li>\n                            </ul>\n                            \n                            <p style=\"color: #000000; font-size: 15px; line-height: 1.6; margin: 0 0 25px;\">\n                                You may resubmit a complete proposal at any time through our standard submission process.\n                            </p>\n                            \n                            <div style=\"text-align: center; margin: 30px 0;\">\n                                <a href=\"https://oneeightyventures.com/submit_proposal\" style=\"display: inline-block; background-color: #000000; color: #ffffff; padding: 12px 30px; text-decoration: none; font-size: 14px; font-weight: 500;\">Resubmit Your Proposal</a>\n                            </div>\n                            ` : $json.rejectionType === 'MONITOR' ? `\n                            <div style=\"background-color: #ffffff; border: 1px solid #e0e0e0; padding: 20px; margin: 30px 0;\">\n                                <h4 style=\"margin: 0 0 15px; color: #000000; font-size: 14px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px;\">Next Steps:</h4>\n                                <ol style=\"margin: 0; padding-left: 20px; color: #000000; font-size: 14px; line-height: 1.8;\">\n                                    <li style=\"margin-bottom: 10px;\">Continue developing your business and addressing key areas</li>\n                                    <li style=\"margin-bottom: 10px;\">Keep us updated on significant milestones</li>\n                                    <li style=\"margin-bottom: 10px;\">Consider resubmitting after 3-6 months of progress</li>\n                                    <li style=\"margin-bottom: 0;\">Focus on improving your weakest scoring categories</li>\n                                </ol>\n                            </div>\n                            \n                            <p style=\"color: #000000; font-size: 15px; line-height: 1.6; margin: 25px 0;\">\n                                We will be adding <strong>${$json.originalData?.companyName || $json.companyName}</strong> to our quarterly monitoring list and look forward to potentially reconnecting when your business has further matured.\n                            </p>\n                            ` : `\n                            <div style=\"background-color: #ffffff; border: 1px solid #e0e0e0; padding: 20px; margin: 0 0 30px;\">\n                                <p style=\"margin: 0; color: #000000; font-size: 15px; line-height: 1.6;\">\n                                    After thorough evaluation by our investment team, we have decided <strong>not to proceed</strong> with an investment in ${$json.originalData.companyName || $json.companyName}. Your proposal achieved a score of <strong>${($json.originalData.score.numeric * 100).toFixed(0)}%</strong>, which indicates that multiple fundamental criteria for our investment thesis were not met.\n                                </p>\n                            </div>\n                            \n                            <h3 style=\"color: #000000; font-size: 16px; font-weight: 600; margin: 30px 0 20px; text-transform: uppercase; letter-spacing: 1px;\">Our Investment Criteria Require:</h3>\n                            \n                            <ul style=\"color: #000000; font-size: 14px; line-height: 1.8; padding-left: 20px; margin: 0 0 30px;\">\n                                <li style=\"margin-bottom: 8px;\">Market alignment with billion-dollar TAM opportunities</li>\n                                <li style=\"margin-bottom: 8px;\">Demonstrated product-market fit with live, revenue-generating products</li>\n                                <li style=\"margin-bottom: 8px;\">Experienced teams with clear go-to-market strategies</li>\n                                <li style=\"margin-bottom: 0;\">Evidence of financial traction and a path to profitability</li>\n                            </ul>\n                            \n                            <div style=\"background-color: #ffffff; border: 1px solid #e0e0e0; padding: 20px; margin: 30px 0;\">\n                                <h4 style=\"margin: 0 0 15px; color: #000000; font-size: 14px; font-weight: 600; text-transform: uppercase; letter-spacing: 1px;\">We Encourage You To:</h4>\n                                <ul style=\"margin: 0; padding-left: 20px; color: #000000; font-size: 14px; line-height: 1.8;\">\n                                    <li style=\"margin-bottom: 8px;\">Continue developing your venture and pursuing your vision</li>\n                                    <li style=\"margin-bottom: 8px;\">Seek feedback from advisors and other potential investors</li>\n                                    <li style=\"margin-bottom: 8px;\">Consider alternative funding sources aligned with your current stage</li>\n                                    <li style=\"margin-bottom: 0;\">Focus on achieving key milestones in product and revenue generation</li>\n                                </ul>\n                            </div>\n                            \n                            <p style=\"color: #000000; font-size: 15px; line-height: 1.6; margin: 25px 0;\">\n                                We wish you the very best in your entrepreneurial journey and future endeavors.\n                            </p>\n                            `}}\n                            \n                            <!-- Closing -->\n                            <p style=\"color: #000000; font-size: 14px; line-height: 1.6; margin: 30px 0 0;\">\n                                Best regards,<br><br>\n                                <strong style=\"color: #000000;\">Investment Analysis Team</strong><br>\n                                One Eighty Ventures\n                            </p>\n                        </td>\n                    </tr>\n                    \n                    <!-- Footer -->\n                    <tr>\n                        <td style=\"background-color: #ffffff; padding: 25px 40px; border-top: 1px solid #e0e0e0;\">\n                            <p style=\"margin: 0; color: #666666; font-size: 12px; text-align: center; line-height: 1.5;\">\n                                One Eighty Ventures | Investment Analysis Team<br>\n                                This email contains confidential information\n                            </p>\n                        </td>\n                    </tr>\n                </table>\n            </td>\n        </tr>\n    </table>\n</body>\n</html>\n```\n\n## User Prompt Instructions\n\nGenerate professional emails based on the results of the scorecard test (FAIL, MONITOR, or INCOMPLETE).\n\n**Current Data:**\n- Rejection Type: {{ $json.rejectionType?.toUpperCase() || 'INCOMPLETE' }}\n- Score: {{ Math.round(($json.originalData?.score?.numeric || 0) * 100) }}%\n- Company Name: {{ $json.originalData?.companyName || $json.companyName || 'Unknown Company' }}\n- Date: {{ new Date().toLocaleDateString() }}\n- Contact Person: {{ $json.founderName || $json.originalData?.founderName || 'Founder' }}\n- Contact Email: {{ $json.founderEmail || $json.originalData?.founderEmail || 'Email Address' }}\n- Completeness Score: {{ Math.round(($json.originalData?.workflowMetadata?.completenessScore || 0) * 100) }}%\n- Missing Sections: {{ $json.originalData?.workflowMetadata?.missingRequiredSections?.join(', ') || 'N/A' }}\n\n**Available Variables:**\n- {{$json.founderName}} â†’ Contact person name\n- {{$json.founderEmail}} â†’ Contact email address\n- {{$json.companyName}} â†’ Company name\n\n**From Set INCOMPLETE Rejection Node:**\n- {{$json.rejectionType}} â†’ Rejection type ('INCOMPLETE')\n- {{$json.originalData}} â†’ Complete original data object\n- {{$json.originalData.workflowMetadata.missingRequiredSections}} â†’ Array of missing sections\n- {{$json.originalData.workflowMetadata.completenessScore}} â†’ Completeness percentage\n- {{$json.waitStartedAt}} â†’ Timestamp\n\n**Score Calculation (n8n Expression Syntax):**\n- For percentage display: {{ Math.round((($json.originalData.score && $json.originalData.score.numeric) ? $json.originalData.score.numeric : 0) * 100) }}\n- For completeness: {{ Math.round((($json.originalData.workflowMetadata && $json.originalData.workflowMetadata.completenessScore) ? $json.originalData.workflowMetadata.completenessScore : 0) * 100) }}\n\n**Alternative Simplified Expressions:**\n- Score percentage: {{ ($json.originalData.score.numeric * 100).toFixed(0) }}\n- Completeness percentage: {{ ($json.originalData.workflowMetadata.completenessScore * 100).toFixed(0) }}\n\nThe template uses the correct variable paths that match your n8n workflow data structure and dynamically adjusts content based on the rejection type."
          }
        },
        "type": "@n8n/n8n-nodes-langchain.agent",
        "typeVersion": 2.1,
        "position": [
          1296,
          -304
        ],
        "id": "04648982-f082-4596-b8a0-d20a75738555",
        "name": "Send Proposal Rejection Email"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 1
            },
            "conditions": [
              {
                "leftValue": "={{ $json.score.numeric }}",
                "rightValue": "={{ 0.45 }}",
                "operator": {
                  "type": "number",
                  "operation": "lt"
                },
                "id": "fail-threshold-check"
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2,
        "position": [
          400,
          176
        ],
        "id": "33bdda6c-f8ab-457e-aec8-d806c69b8212",
        "name": "Check Score Tier (FAIL vs MONITOR/PASS)"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 1
            },
            "conditions": [
              {
                "leftValue": "={{ $json.score.numeric }}",
                "rightValue": "={{ 0.60 }}",
                "operator": {
                  "type": "number",
                  "operation": "lt"
                },
                "id": "monitor-threshold-check"
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2,
        "position": [
          672,
          192
        ],
        "id": "5ae16d84-d06b-46cc-a97e-f8cbe67e492f",
        "name": "Check MONITOR vs PASS"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "rejection-type",
                "name": "rejectionType",
                "value": "FAIL",
                "type": "string"
              },
              {
                "id": "copy-data",
                "name": "originalData",
                "value": "={{ $json }}",
                "type": "object"
              },
              {
                "id": "company-name",
                "name": "companyName",
                "value": "={{ $json.companyName }}",
                "type": "string"
              },
              {
                "id": "founder-name",
                "name": "founderName",
                "value": "={{ $json.founderName }}",
                "type": "string"
              },
              {
                "id": "founder-email",
                "name": "founderEmail",
                "value": "={{ $json.founderEmail }}",
                "type": "string"
              },
              {
                "id": "timestamp",
                "name": "rejectionTimestamp",
                "value": "={{ new Date().toISOString() }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          880,
          -176
        ],
        "id": "14454072-1576-418a-820f-6880dae863fc",
        "name": "Set FAIL Rejection"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "rejection-type",
                "name": "rejectionType",
                "value": "MONITOR",
                "type": "string"
              },
              {
                "id": "copy-data",
                "name": "originalData",
                "value": "={{ $json }}",
                "type": "object"
              },
              {
                "id": "company-name",
                "name": "companyName",
                "value": "={{ $json.companyName }}",
                "type": "string"
              },
              {
                "id": "founder-name",
                "name": "founderName",
                "value": "={{ $json.founderName }}",
                "type": "string"
              },
              {
                "id": "founder-email",
                "name": "founderEmail",
                "value": "={{ $json.founderEmail }}",
                "type": "string"
              },
              {
                "id": "timestamp",
                "name": "rejectionTimestamp",
                "value": "={{ new Date().toISOString() }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          880,
          0
        ],
        "id": "22a5182a-45b0-4cdf-adc7-f8f2020a4fb0",
        "name": "Set MONITOR Rejection"
      },
      {
        "parameters": {
          "conditions": {
            "options": {
              "caseSensitive": true,
              "leftValue": "",
              "typeValidation": "strict",
              "version": 1
            },
            "conditions": [
              {
                "leftValue": "={{ $json.score.numeric }}",
                "rightValue": "={{ 0.75 }}",
                "operator": {
                  "type": "number",
                  "operation": "gte"
                },
                "id": "buy-threshold-check"
              }
            ],
            "combinator": "and"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.if",
        "typeVersion": 2,
        "position": [
          896,
          304
        ],
        "id": "b289bf3f-fe6e-4f2b-9ea2-1ab4d721bf25",
        "name": "Check BUY vs CONSIDER"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "approval-type",
                "name": "approvalType",
                "value": "CONSIDER",
                "type": "string"
              },
              {
                "id": "copy-data",
                "name": "originalData",
                "value": "={{ $json }}",
                "type": "object"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          1104,
          432
        ],
        "id": "908debc6-8a4a-4c20-89e9-442b03ffc4f8",
        "name": "Set CONSIDER Approval1"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "approval-type",
                "name": "approvalType",
                "value": "BUY_OR_STRONG_BUY",
                "type": "string"
              },
              {
                "id": "copy-data",
                "name": "originalData",
                "value": "={{ $json }}",
                "type": "object"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          1104,
          176
        ],
        "id": "8c6f0fe3-e83e-4ddf-87b3-2539ae3ce644",
        "name": "Set BUY/STRONG_BUY Approval1"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "5480093b-a482-44a9-aa23-349a76ef0ead",
                "name": "companyName",
                "value": "={{ $('Extract Proposal Data Requirements').item.json.companyName }}",
                "type": "string"
              },
              {
                "id": "c1d3f4e5-6789-4abc-def0-123456789012",
                "name": "output.totalScore",
                "value": "={{ parseFloat(($('Merge').item.json.score?.final || '0').toString().replace('%', '').trim()) / 100 }}",
                "type": "number"
              },
              {
                "id": "3f4f7543-8e11-4a8e-9fa0-2050edb2bdd5",
                "name": "output.criteria.category.subtotal",
                "value": "={{ parseFloat(($('Merge').item.json.categoryScores?.category?.score || '0').toString().replace('%', '').trim()) / 100 }}",
                "type": "number"
              },
              {
                "id": "cat-q1-score-1234",
                "name": "output.criteria.category.category_1.score",
                "value": "={{ $('Merge').item.json.answerSummary?.answers?.category_1 === 'Y' ? 1 : 0 }}",
                "type": "number"
              },
              {
                "id": "cat-q2-score-5678",
                "name": "output.criteria.category.category_2.score",
                "value": "={{ $('Merge').item.json.answerSummary?.answers?.category_2 === 'Y' ? 1 : 0 }}",
                "type": "number"
              },
              {
                "id": "cat-q3-score-9012",
                "name": "output.criteria.category.category_3.score",
                "value": "={{ $('Merge').item.json.answerSummary?.answers?.category_3 === 'Y' ? 1 : 0 }}",
                "type": "number"
              },
              {
                "id": "cat-q4-score-3456",
                "name": "output.criteria.category.category_4.score",
                "value": "={{ $('Merge').item.json.answerSummary?.answers?.category_4 === 'Y' ? 1 : 0 }}",
                "type": "number"
              },
              {
                "id": "0b702805-2931-4eea-8896-11b6a85eaa33",
                "name": "output.criteria.product.subtotal",
                "value": "={{ parseFloat(($('Merge').item.json.categoryScores?.product?.score || '0').toString().replace('%', '').trim()) / 100 }}",
                "type": "number"
              },
              {
                "id": "prod-q1-score-7890",
                "name": "output.criteria.product.product_1.score",
                "value": "={{ $('Merge').item.json.answerSummary?.answers?.product_1 === 'Y' ? 1 : 0 }}",
                "type": "number"
              },
              {
                "id": "prod-q2-score-2345",
                "name": "output.criteria.product.product_2.score",
                "value": "={{ $('Merge').item.json.answerSummary?.answers?.product_2 === 'Y' ? 1 : 0 }}",
                "type": "number"
              },
              {
                "id": "prod-q3-score-6789",
                "name": "output.criteria.product.product_3.score",
                "value": "={{ $('Merge').item.json.answerSummary?.answers?.product_3 === 'Y' ? 1 : 0 }}",
                "type": "number"
              },
              {
                "id": "8e4d3d45-2b90-41e9-8daf-172927f27b59",
                "name": "output.criteria.operations.subtotal",
                "value": "={{ parseFloat(($('Merge').item.json.categoryScores?.operations?.score || '0').toString().replace('%', '').trim()) / 100 }}",
                "type": "number"
              },
              {
                "id": "ops-q1-score-0123",
                "name": "output.criteria.operations.operations_1.score",
                "value": "={{ $('Merge').item.json.answerSummary?.answers?.operations_1 === 'Y' ? 1 : 0 }}",
                "type": "number"
              },
              {
                "id": "ops-q2-score-4567",
                "name": "output.criteria.operations.operations_2.score",
                "value": "={{ $('Merge').item.json.answerSummary?.answers?.operations_2 === 'Y' ? 1 : 0 }}",
                "type": "number"
              },
              {
                "id": "ops-q3-score-8901",
                "name": "output.criteria.operations.operations_3.score",
                "value": "={{ $('Merge').item.json.answerSummary?.answers?.operations_3 === 'Y' ? 1 : 0 }}",
                "type": "number"
              },
              {
                "id": "83630b65-f5aa-403e-9013-8aadb51299da",
                "name": "output.criteria.financial.subtotal",
                "value": "={{ parseFloat(($('Merge').item.json.categoryScores?.financial?.score || '0').toString().replace('%', '').trim()) / 100 }}",
                "type": "number"
              },
              {
                "id": "fin-q1-score-2346",
                "name": "output.criteria.financial.financial_1.score",
                "value": "={{ $('Merge').item.json.answerSummary?.answers?.financial_1 === 'Y' ? 1 : 0 }}",
                "type": "number"
              },
              {
                "id": "fin-q2-score-6780",
                "name": "output.criteria.financial.financial_2.score",
                "value": "={{ $('Merge').item.json.answerSummary?.answers?.financial_2 === 'Y' ? 1 : 0 }}",
                "type": "number"
              },
              {
                "id": "fin-q3-score-0124",
                "name": "output.criteria.financial.financial_3.score",
                "value": "={{ $('Merge').item.json.answerSummary?.answers?.financial_3 === 'Y' ? 1 : 0 }}",
                "type": "number"
              },
              {
                "id": "fin-q4-score-4568",
                "name": "output.criteria.financial.financial_4.score",
                "value": "={{ $('Merge').item.json.answerSummary?.answers?.financial_4 === 'Y' ? 1 : 0 }}",
                "type": "number"
              },
              {
                "id": "fin-q5-score-8902",
                "name": "output.criteria.financial.financial_5.score",
                "value": "={{ $('Merge').item.json.answerSummary?.answers?.financial_5 === 'Y' ? 1 : 0 }}",
                "type": "number"
              },
              {
                "id": "market-sector-3457",
                "name": "output.marketSector",
                "value": "={{ $('Merge').item.json.marketSector?.primary || 'Unknown' }}, {{ $('Merge').item.json.marketSector?.secondary || '' }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "id": "63dae029-3086-428e-8682-c41ae185efbd",
        "name": "Prep Scorecard Data1",
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          1536,
          288
        ]
      },
      {
        "parameters": {
          "jsCode": "// Complete PE Deal Scorecard Pipeline - OPTIMIZED VERSION\n// This code takes extracted pitch deck data and automatically evaluates it\n// to generate Yes/No answers for all 15 scorecard questions, then calculates the final score\n\n// ============================================================================\n// CONFIGURATION AND ERROR HANDLING\n// ============================================================================\n\nconst EVALUATION_CONFIG = {\n  thresholds: {\n    categoryAlignment: 2,\n    firstToMarket: 1,\n    teamGrowth: 1,\n    fullTimeTeam: 1,\n    gtmPlan: 1,\n    roadmap: 1,\n    ipProtection: 1,\n    tamGrowth: 1,\n    liveProduct: 2,\n    currentRevenue: 1,\n    pastRevenue: 1,\n    investors: 1,\n    funding: 1\n  },\n  errorHandling: {\n    defaultAnswer: 'N',\n    logLevel: 'INFO', // DEBUG, INFO, WARN, ERROR\n    continueOnError: true\n  }\n};\n\nclass EvaluationError extends Error {\n  constructor(message, questionId, companyName, severity = 'ERROR') {\n    super(message);\n    this.questionId = questionId;\n    this.companyName = companyName;\n    this.severity = severity;\n    this.timestamp = new Date().toISOString();\n  }\n}\n\nfunction logEvaluationEvent(level, message, context = {}) {\n  const logEntry = {\n    timestamp: new Date().toISOString(),\n    level: level,\n    message: message,\n    context: context\n  };\n  \n  if (level === 'ERROR' || level === 'WARN') {\n    console.warn(`[${level}] ${message}`, context);\n  } else {\n    console.log(`[${level}] ${message}`, context);\n  }\n  \n  return logEntry;\n}\n\nfunction preprocessText(text) {\n  if (!text || typeof text !== 'string') {\n    return '';\n  }\n  \n  return text\n    .toLowerCase()\n    .replace(/\\s+/g, ' ') // Normalize whitespace\n    .replace(/[^\\w\\s$.,%-]/g, ' ') // Remove special chars except financial symbols\n    .replace(/\\s+/g, ' ') // Remove extra spaces again\n    .trim();\n}\n\nfunction safeEvaluate(evaluationFunc, questionId, companyName, ...args) {\n  try {\n    const result = evaluationFunc(...args);\n    if (!result || typeof result !== 'object' || !result.hasOwnProperty('answer')) {\n      throw new EvaluationError(\n        `Evaluation function returned invalid result`, \n        questionId, \n        companyName, \n        'WARN'\n      );\n    }\n    return result;\n  } catch (error) {\n    logEvaluationEvent('ERROR', `Evaluation failed for ${questionId}`, {\n      questionId,\n      companyName,\n      error: error.message\n    });\n    \n    if (EVALUATION_CONFIG.errorHandling.continueOnError) {\n      return {\n        answer: EVALUATION_CONFIG.errorHandling.defaultAnswer,\n        reasoning: `Error in evaluation: ${error.message}`\n      };\n    } else {\n      throw error;\n    }\n  }\n}\n\n// ============================================================================\n// PART 1: ANSWER GENERATION MODULE - ENHANCED\n// ============================================================================\n\n/**\n * Main function to evaluate pitch deck data into scorecard answers\n * @param {Object} extractedData - Output from the PDF extraction code\n * @returns {Object} Answers for all 15 scorecard questions plus metadata\n */\nfunction evaluatePitchToAnswers(extractedData) {\n  const answers = {};\n  const evaluationDetails = {};\n  const evaluationLogs = [];\n  \n  // Enhanced input validation\n  if (!extractedData || typeof extractedData !== 'object') {\n    throw new EvaluationError('Invalid extractedData: must be an object', 'VALIDATION', 'Unknown');\n  }\n  \n  // Ensure we have the necessary data structure with fallbacks\n  const sections = extractedData?.rawExtraction?.sections || {};\n  const companyName = extractedData?.companyName || 'Unknown Company';\n  const teamInfo = extractedData?.teamInfo || {};\n  \n  logEvaluationEvent('INFO', `Starting evaluation for company: ${companyName}`, {\n    sectionsAvailable: Object.keys(sections),\n    teamInfoAvailable: Object.keys(teamInfo)\n  });\n  \n  // ============ CATEGORY QUESTIONS (30% total weight) ============\n  \n  // Question 1: Is the category relevant/aligned with vision and expertise?\n  const category1Result = safeEvaluate(\n    evaluateCategoryAlignment, \n    'category_1', \n    companyName,\n    sections.overview || '', \n    sections.solution || ''\n  );\n  answers.category_1 = category1Result.answer;\n  evaluationDetails.category_1 = category1Result.reasoning;\n  \n  // Question 2: Is the product first to market?\n  const category2Result = safeEvaluate(\n    evaluateFirstToMarket,\n    'category_2',\n    companyName,\n    sections.problem || '', \n    sections.market || ''\n  );\n  answers.category_2 = category2Result.answer;\n  evaluationDetails.category_2 = category2Result.reasoning;\n  \n  // Question 3: Is the TAM greater than $1B?\n  const category3Result = safeEvaluate(\n    evaluateTAMSize,\n    'category_3',\n    companyName,\n    sections.market || ''\n  );\n  answers.category_3 = category3Result.answer;\n  evaluationDetails.category_3 = category3Result.reasoning;\n  \n  // Question 4: Is the TAM increasing?\n  const category4Result = safeEvaluate(\n    evaluateTAMGrowth,\n    'category_4',\n    companyName,\n    sections.market || ''\n  );\n  answers.category_4 = category4Result.answer;\n  evaluationDetails.category_4 = category4Result.reasoning;\n  \n  // ============ PRODUCT QUESTIONS (20% total weight) ============\n  \n  // Question 5: Is there a roadmap for the next 12 months?\n  const product1Result = safeEvaluate(\n    evaluateRoadmap,\n    'product_1',\n    companyName,\n    sections.solution || '', \n    sections.businessModel || ''\n  );\n  answers.product_1 = product1Result.answer;\n  evaluationDetails.product_1 = product1Result.reasoning;\n  \n  // Question 6: Is there a functioning product that is live/in-market?\n  const product2Result = safeEvaluate(\n    evaluateProductLive,\n    'product_2',\n    companyName,\n    sections.traction || '', \n    sections.solution || ''\n  );\n  answers.product_2 = product2Result.answer;\n  evaluationDetails.product_2 = product2Result.reasoning;\n  \n  // Question 7: Is the IP proprietary/patent protected?\n  const product3Result = safeEvaluate(\n    evaluateIPProtection,\n    'product_3',\n    companyName,\n    sections.solution || '', \n    sections.overview || ''\n  );\n  answers.product_3 = product3Result.answer;\n  evaluationDetails.product_3 = product3Result.reasoning;\n  \n  // ============ OPERATIONS QUESTIONS (20% total weight) ============\n  \n  // Question 8: Has the team grown since being founded?\n  const operations1Result = safeEvaluate(\n    evaluateTeamGrowth,\n    'operations_1',\n    companyName,\n    sections.team || '', \n    teamInfo\n  );\n  answers.operations_1 = operations1Result.answer;\n  evaluationDetails.operations_1 = operations1Result.reasoning;\n  \n  // Question 9: Is this supported by a full-time/dedicated team?\n  const operations2Result = safeEvaluate(\n    evaluateFullTimeTeam,\n    'operations_2',\n    companyName,\n    sections.team || ''\n  );\n  answers.operations_2 = operations2Result.answer;\n  evaluationDetails.operations_2 = operations2Result.reasoning;\n  \n  // Question 10: Does the team have a Go-To-Market Plan?\n  const operations3Result = safeEvaluate(\n    evaluateGTMPlan,\n    'operations_3',\n    companyName,\n    sections.businessModel || '', \n    sections.traction || ''\n  );\n  answers.operations_3 = operations3Result.answer;\n  evaluationDetails.operations_3 = operations3Result.reasoning;\n  \n  // ============ FINANCIAL QUESTIONS (30% total weight) ============\n  \n  // Question 11: Are they currently generating revenue?\n  const financial1Result = safeEvaluate(\n    evaluateCurrentRevenue,\n    'financial_1',\n    companyName,\n    sections.financial || '', \n    sections.traction || ''\n  );\n  answers.financial_1 = financial1Result.answer;\n  evaluationDetails.financial_1 = financial1Result.reasoning;\n  \n  // Question 12: Have they generated revenue in the past 12 months?\n  const financial2Result = safeEvaluate(\n    evaluatePastRevenue,\n    'financial_2',\n    companyName,\n    sections.financial || '', \n    sections.traction || ''\n  );\n  answers.financial_2 = financial2Result.answer;\n  evaluationDetails.financial_2 = financial2Result.reasoning;\n  \n  // Question 13: Are there investors?\n  const financial3Result = safeEvaluate(\n    evaluateInvestors,\n    'financial_3',\n    companyName,\n    sections.investment || '', \n    sections.overview || ''\n  );\n  answers.financial_3 = financial3Result.answer;\n  evaluationDetails.financial_3 = financial3Result.reasoning;\n  \n  // Question 14: Do they have funding?\n  const financial4Result = safeEvaluate(\n    evaluateFunding,\n    'financial_4',\n    companyName,\n    sections.investment || '', \n    sections.financial || ''\n  );\n  answers.financial_4 = financial4Result.answer;\n  evaluationDetails.financial_4 = financial4Result.reasoning;\n  \n  // Question 15: Are they profitable?\n  const financial5Result = safeEvaluate(\n    evaluateProfitability,\n    'financial_5',\n    companyName,\n    sections.financial || ''\n  );\n  answers.financial_5 = financial5Result.answer;\n  evaluationDetails.financial_5 = financial5Result.reasoning;\n  \n  logEvaluationEvent('INFO', `Evaluation completed for ${companyName}`, {\n    totalAnswers: Object.keys(answers).length,\n    yesCount: Object.values(answers).filter(a => a === 'Y').length\n  });\n  \n  return {\n    companyName: companyName,\n    answers: answers,\n    evaluationDetails: evaluationDetails,\n    metadata: {\n      evaluationDate: new Date().toISOString(),\n      extractionMethod: extractedData?.metadata?.extractionMethod || 'Automated',\n      evaluationLogs: evaluationLogs\n    }\n  };\n}\n\n// ============================================================================\n// ENHANCED EVALUATION FUNCTIONS - IMPROVED PATTERN MATCHING\n// ============================================================================\n\n// Category Questions\n\nfunction evaluateCategoryAlignment(overviewText = '', solutionText = '') {\n  const text = preprocessText(overviewText + ' ' + solutionText);\n  \n  const alignmentKeywords = [\n    'ai', 'artificial intelligence', 'machine learning', 'saas', 'b2b',\n    'enterprise', 'automation', 'digital transformation', 'cloud',\n    'data analytics', 'predictive', 'optimization', 'efficiency',\n    'technology', 'software', 'platform', 'solution', 'system',\n    'healthcare', 'health', 'medical', 'clinical', 'patient',\n    'restaurant', 'food', 'dining', 'hospitality', 'service',\n    'revenue', 'sales', 'marketing', 'growth', 'performance'\n  ];\n  \n  const matchCount = alignmentKeywords.filter(keyword => text.includes(keyword)).length;\n  const hasAlignment = matchCount >= EVALUATION_CONFIG.thresholds.categoryAlignment;\n  \n  return {\n    answer: hasAlignment ? 'Y' : 'N',\n    reasoning: `Found ${matchCount} alignment keywords in pitch deck (threshold: ${EVALUATION_CONFIG.thresholds.categoryAlignment})`\n  };\n}\n\nfunction evaluateFirstToMarket(problemText = '', marketText = '') {\n  const text = preprocessText(problemText + ' ' + marketText);\n  \n  const firstToMarketIndicators = [\n    'first', 'pioneer', 'no competition', 'white space', 'unaddressed',\n    'novel', 'unique solution', 'breakthrough', 'revolutionary',\n    'no direct competitors', 'blue ocean', 'untapped', 'innovative',\n    'new approach', 'differentiated', 'proprietary approach'\n  ];\n  \n  const competitionIndicators = [\n    'competitors', 'competitive landscape', 'market leaders',\n    'existing solutions', 'alternatives', 'incumbent', 'competition'\n  ];\n  \n  const firstIndicatorCount = firstToMarketIndicators.filter(term => text.includes(term)).length;\n  const competitorCount = competitionIndicators.filter(term => text.includes(term)).length;\n  \n  const isFirstToMarket = firstIndicatorCount >= EVALUATION_CONFIG.thresholds.firstToMarket && \n                          (competitorCount <= 2 || firstIndicatorCount > competitorCount);\n  \n  return {\n    answer: isFirstToMarket ? 'Y' : 'N',\n    reasoning: `First-to-market indicators: ${firstIndicatorCount}, Competition mentions: ${competitorCount} (threshold: ${EVALUATION_CONFIG.thresholds.firstToMarket})`\n  };\n}\n\nfunction evaluateTAMSize(marketText = '') {\n  const text = preprocessText(marketText);\n  \n  // Enhanced TAM pattern matching - Stage 1: Broad matching\n  const potentialTAMSections = [];\n  \n  // Find sections that might contain TAM information\n  const tamKeywords = ['tam', 'total addressable market', 'market size', 'market opportunity', 'addressable market'];\n  const sentences = text.split(/[.!?]+/);\n  \n  sentences.forEach(sentence => {\n    if (tamKeywords.some(keyword => sentence.includes(keyword))) {\n      potentialTAMSections.push(sentence);\n    }\n  });\n  \n  // Stage 2: Specific extraction with multiple patterns\n  const tamPatterns = [\n    /tam[:\\s]*\\$?([\\d.,]+)\\s*(b|billion|bn)/i,\n    /total\\s+addressable\\s+market[:\\s]*\\$?([\\d.,]+)\\s*(b|billion|bn)/i,\n    /market\\s+size[:\\s]*\\$?([\\d.,]+)\\s*(b|billion|bn)/i,\n    /market\\s+opportunity[:\\s]*\\$?([\\d.,]+)\\s*(b|billion|bn)/i,\n    /\\$?([\\d.,]+)\\s*(b|billion|bn)\\s+market/i,\n    /\\$?([\\d.,]+)\\s*(b|billion|bn)\\s+tam/i,\n    /market.*\\$?([\\d.,]+)\\s*(billion|b|bn)/i,\n    /opportunity.*\\$?([\\d.,]+)\\s*(billion|b|bn)/i,\n    /addressable.*\\$?([\\d.,]+)\\s*(billion|b|bn)/i,\n    /([\\d.,]+)\\s*billion\\s+dollar\\s+market/i\n  ];\n  \n  // Check both full text and potential sections\n  const textsToCheck = [text, ...potentialTAMSections];\n  \n  for (const textToCheck of textsToCheck) {\n    for (const pattern of tamPatterns) {\n      const match = textToCheck.match(pattern);\n      if (match) {\n        const valueStr = match[1].replace(/,/g, '');\n        const value = parseFloat(valueStr);\n        if (!isNaN(value)) {\n          return {\n            answer: value >= 1 ? 'Y' : 'N',\n            reasoning: `TAM identified as $${value}B from pattern match`\n          };\n        }\n      }\n    }\n  }\n  \n  // Check for trillion (always > $1B)\n  if (text.includes('trillion')) {\n    return {\n      answer: 'Y',\n      reasoning: 'TAM mentioned in trillions (>$1B)'\n    };\n  }\n  \n  // Check for large market indicators without specific numbers\n  const largeMarketIndicators = [\n    'large market', 'huge market', 'massive opportunity', \n    'billion dollar', 'multi billion', 'multi-billion'\n  ];\n  const hasLargeMarketIndicator = largeMarketIndicators.some(ind => text.includes(ind));\n  \n  if (hasLargeMarketIndicator) {\n    return {\n      answer: 'Y',\n      reasoning: 'Large market opportunity indicated without specific TAM value'\n    };\n  }\n  \n  return {\n    answer: 'N',\n    reasoning: 'No clear TAM value found or TAM < $1B'\n  };\n}\n\nfunction evaluateTAMGrowth(marketText = '') {\n  const text = preprocessText(marketText);\n  \n  const growthIndicators = [\n    'growing', 'expanding', 'increasing', 'cagr', 'growth rate',\n    'expected to reach', 'projected to', 'will reach', 'forecast',\n    'by 20', 'growth', 'increase', 'rising', 'surge',\n    'compound annual', 'year over year', 'yoy', 'accelerating'\n  ];\n  \n  const matchCount = growthIndicators.filter(term => text.includes(term)).length;\n  const hasGrowthIndicators = matchCount >= EVALUATION_CONFIG.thresholds.tamGrowth;\n  \n  // Enhanced percentage growth detection\n  const percentagePatterns = [\n    /(\\d+)%\\s*(annual|growth|cagr|increase|yearly)/i,\n    /(annual|growth|cagr|increase|yearly)\\s*(\\d+)%/i,\n    /growing\\s*at\\s*(\\d+)%/i,\n    /(\\d+)%\\s*compound/i\n  ];\n  \n  const hasPercentageGrowth = percentagePatterns.some(pattern => pattern.test(text));\n  \n  return {\n    answer: (hasGrowthIndicators || hasPercentageGrowth) ? 'Y' : 'N',\n    reasoning: `Growth indicators found: ${matchCount}, Percentage growth mentioned: ${hasPercentageGrowth} (threshold: ${EVALUATION_CONFIG.thresholds.tamGrowth})`\n  };\n}\n\n// Product Questions - Enhanced\n\nfunction evaluateRoadmap(solutionText = '', businessModelText = '') {\n  const text = preprocessText(solutionText + ' ' + businessModelText);\n  \n  const roadmapIndicators = [\n    'roadmap', 'timeline', 'milestones', 'next 12 months',\n    'upcoming features', 'planned', 'q1', 'q2', 'q3', 'q4',\n    '2024', '2025', 'phase', 'release schedule', 'product pipeline',\n    'future development', 'next steps', 'upcoming', 'plan to',\n    'development plan', 'product strategy', 'feature roadmap'\n  ];\n  \n  const matchCount = roadmapIndicators.filter(term => text.includes(term)).length;\n  const hasRoadmap = matchCount >= EVALUATION_CONFIG.thresholds.roadmap;\n  \n  return {\n    answer: hasRoadmap ? 'Y' : 'N',\n    reasoning: `Roadmap indicators found: ${matchCount} (threshold: ${EVALUATION_CONFIG.thresholds.roadmap})`\n  };\n}\n\nfunction evaluateProductLive(tractionText = '', solutionText = '') {\n  const text = preprocessText(tractionText + ' ' + solutionText);\n  \n  const liveProductIndicators = [\n    'live', 'in production', 'deployed', 'customers using',\n    'active users', 'monthly active', 'daily active', 'in market',\n    'launched', 'available now', 'currently serving', 'processing',\n    'transactions', 'revenue', 'mrr', 'arr', 'operational',\n    'serving', 'clients', 'users', 'implemented', 'production ready'\n  ];\n  \n  const betaIndicators = [\n    'beta', 'pilot', 'testing', 'coming soon', 'will launch',\n    'planned', 'under development', 'building', 'developing',\n    'prototype', 'mvp', 'proof of concept', 'alpha'\n  ];\n  \n  const liveCount = liveProductIndicators.filter(term => text.includes(term)).length;\n  const betaCount = betaIndicators.filter(term => text.includes(term)).length;\n  \n  const isLive = liveCount >= EVALUATION_CONFIG.thresholds.liveProduct || \n                 (liveCount > 0 && betaCount === 0);\n  \n  return {\n    answer: isLive ? 'Y' : 'N',\n    reasoning: `Live indicators: ${liveCount}, Beta/Development indicators: ${betaCount} (threshold: ${EVALUATION_CONFIG.thresholds.liveProduct})`\n  };\n}\n\nfunction evaluateIPProtection(solutionText = '', overviewText = '') {\n  const text = preprocessText(solutionText + ' ' + overviewText);\n  \n  const ipIndicators = [\n    'patent', 'proprietary', 'intellectual property', 'ip',\n    'trade secret', 'copyright', 'trademark', 'patent pending',\n    'patented', 'exclusive', 'protected', 'defensible',\n    'unique technology', 'proprietary technology', 'proprietary system',\n    'patent application', 'patent filed', 'ip protection'\n  ];\n  \n  const matchCount = ipIndicators.filter(term => text.includes(term)).length;\n  const hasIPProtection = matchCount >= EVALUATION_CONFIG.thresholds.ipProtection;\n  \n  return {\n    answer: hasIPProtection ? 'Y' : 'N',\n    reasoning: `IP protection indicators found: ${matchCount} (threshold: ${EVALUATION_CONFIG.thresholds.ipProtection})`\n  };\n}\n\n// Operations Questions - Enhanced\n\nfunction evaluateTeamGrowth(teamText = '', teamInfo = {}) {\n  const text = preprocessText(teamText);\n  \n  // Enhanced team size pattern matching\n  const teamSizePatterns = [\n    /(\\d+)\\s*(team members|employees|people|staff|person team)/i,\n    /team\\s+of\\s+(\\d+)/i,\n    /(\\d+)\\s+member\\s+team/i,\n    /staff\\s+of\\s+(\\d+)/i\n  ];\n  \n  let teamSize = 0;\n  for (const pattern of teamSizePatterns) {\n    const match = text.match(pattern);\n    if (match) {\n      teamSize = Math.max(teamSize, parseInt(match[1]));\n    }\n  }\n  \n  if (teamSize > 2) {\n    return {\n      answer: 'Y',\n      reasoning: `Team size: ${teamSize} members`\n    };\n  }\n  \n  // Check for growth indicators\n  const growthIndicators = [\n    'grown', 'expanded', 'hired', 'new team members', 'joined',\n    'growing team', 'additions', 'recent hires', 'team of',\n    'scaling team', 'team growth', 'new hires'\n  ];\n  \n  const growthCount = growthIndicators.filter(term => text.includes(term)).length;\n  const hasGrowthIndicators = growthCount >= EVALUATION_CONFIG.thresholds.teamGrowth;\n  \n  // Check team structure from extracted info\n  const hasMultipleFounders = teamInfo.allFounders && teamInfo.allFounders.length > 1;\n  const hasCTO = teamInfo.cto !== null && teamInfo.cto !== undefined;\n  const hasCEO = teamInfo.ceo !== null && teamInfo.ceo !== undefined;\n  const hasTeamMembers = teamInfo.teamMembers && teamInfo.teamMembers.length > 2;\n  \n  const hasTeamStructure = hasTeamMembers || (hasMultipleFounders && (hasCTO || hasCEO));\n  \n  return {\n    answer: (hasGrowthIndicators || hasTeamStructure) ? 'Y' : 'N',\n    reasoning: `Growth indicators: ${growthCount}, Team members: ${teamInfo.teamMembers?.length || 0}, Team structure: ${hasTeamStructure} (threshold: ${EVALUATION_CONFIG.thresholds.teamGrowth})`\n  };\n}\n\nfunction evaluateFullTimeTeam(teamText = '') {\n  const text = preprocessText(teamText);\n  \n  const fullTimeIndicators = [\n    'full time', 'full-time', 'dedicated', 'employees',\n    'team of', 'staff', 'engineers', 'developers', 'sales team',\n    'marketing team', 'operations', 'customer success',\n    'person team', 'member team', 'full time employees'\n  ];\n  \n  const matchCount = fullTimeIndicators.filter(term => text.includes(term)).length;\n  \n  // Enhanced team size detection\n  const teamSizePatterns = [\n    /(\\d+)\\+?\\s*(full time|full-time|dedicated|employees|team members|person team)/i,\n    /full\\s+time\\s+team\\s+of\\s+(\\d+)/i,\n    /(\\d+)\\s+full\\s+time/i\n  ];\n  \n  let hasFullTimeTeamSize = false;\n  for (const pattern of teamSizePatterns) {\n    const match = text.match(pattern);\n    if (match && parseInt(match[1]) >= 2) {\n      hasFullTimeTeamSize = true;\n      break;\n    }\n  }\n  \n  const hasFullTimeTeam = matchCount >= EVALUATION_CONFIG.thresholds.fullTimeTeam || hasFullTimeTeamSize;\n  \n  return {\n    answer: hasFullTimeTeam ? 'Y' : 'N',\n    reasoning: `Full-time indicators: ${matchCount}, Team size mentioned: ${hasFullTimeTeamSize} (threshold: ${EVALUATION_CONFIG.thresholds.fullTimeTeam})`\n  };\n}\n\nfunction evaluateGTMPlan(businessModelText = '', tractionText = '') {\n  const text = preprocessText(businessModelText + ' ' + tractionText);\n  \n  const gtmIndicators = [\n    'go to market', 'go-to-market', 'gtm', 'sales strategy',\n    'marketing strategy', 'customer acquisition', 'distribution',\n    'sales channels', 'pricing strategy', 'target customers',\n    'customer segments', 'sales pipeline', 'marketing plan',\n    'growth strategy', 'expansion plan', 'sales process',\n    'marketing approach', 'customer engagement', 'market entry'\n  ];\n  \n  const matchCount = gtmIndicators.filter(term => text.includes(term)).length;\n  const hasGTMPlan = matchCount >= EVALUATION_CONFIG.thresholds.gtmPlan;\n  \n  return {\n    answer: hasGTMPlan ? 'Y' : 'N',\n    reasoning: `GTM indicators found: ${matchCount} (threshold: ${EVALUATION_CONFIG.thresholds.gtmPlan})`\n  };\n}\n\n// Financial Questions - Enhanced pattern matching\n\nfunction evaluateCurrentRevenue(financialText = '', tractionText = '') {\n  const text = preprocessText(financialText + ' ' + tractionText);\n  \n  const revenueIndicators = [\n    'revenue', 'mrr', 'arr', 'sales', 'monthly recurring',\n    'annual recurring', 'customers paying', 'paid customers',\n    'revenue run rate', 'generating', 'earned', 'income',\n    'bookings', 'contracts', 'subscription revenue'\n  ];\n  \n  // Enhanced revenue patterns with better formatting support\n  const revenuePatterns = [\n    /\\$[\\d.,]+[kmb]?\\s*(revenue|mrr|arr|sales)/i,\n    /(revenue|mrr|arr|sales)[:\\s]*\\$[\\d.,]+[kmb]?/i,\n    /[\\d.,]+[kmb]?\\s+in\\s+(revenue|sales|mrr|arr)/i,\n    /generating\\s*\\$[\\d.,]+[kmb]?/i,\n    /\\$[\\d.,]+[kmb]?\\s*(monthly|annual|yearly)/i,\n    /revenue.*\\$[\\d.,]+/i,\n    /(mrr|arr)\\s*[:=]\\s*\\$?[\\d.,]+[kmb]?/i,\n    /\\$?[\\d.,]+[kmb]?\\s*(mrr|arr)/i,\n    /monthly\\s+revenue\\s*[:=]?\\s*\\$?[\\d.,]+[kmb]?/i,\n    /annual\\s+revenue\\s*[:=]?\\s*\\$?[\\d.,]+[kmb]?/i\n  ];\n  \n  const hasRevenueNumber = revenuePatterns.some(pattern => pattern.test(text));\n  const revenueIndicatorCount = revenueIndicators.filter(term => text.includes(term)).length;\n  const hasRevenueIndicators = revenueIndicatorCount >= EVALUATION_CONFIG.thresholds.currentRevenue;\n  \n  return {\n    answer: (hasRevenueNumber || hasRevenueIndicators) ? 'Y' : 'N',\n    reasoning: `Revenue number found: ${hasRevenueNumber}, Revenue indicators: ${revenueIndicatorCount} (threshold: ${EVALUATION_CONFIG.thresholds.currentRevenue})`\n  };\n}\n\nfunction evaluatePastRevenue(financialText = '', tractionText = '') {\n  const text = preprocessText(financialText + ' ' + tractionText);\n  \n  const pastRevenueIndicators = [\n    '2023', '2024', 'last year', 'past 12 months', 'trailing',\n    'historical revenue', 'ytd', 'year to date', 'quarterly revenue',\n    'q1', 'q2', 'q3', 'q4', 'previous', 'achieved', 'generated',\n    'last quarter', 'previous year', 'historical'\n  ];\n  \n  const matchCount = pastRevenueIndicators.filter(term => text.includes(term)).length;\n  const hasPastIndicators = matchCount >= EVALUATION_CONFIG.thresholds.pastRevenue;\n  \n  // If they have current revenue, they likely have past revenue\n  const currentRevenue = evaluateCurrentRevenue(financialText, tractionText);\n  \n  return {\n    answer: (hasPastIndicators || currentRevenue.answer === 'Y') ? 'Y' : 'N',\n    reasoning: `Past revenue indicators: ${matchCount}, Has current revenue: ${currentRevenue.answer} (threshold: ${EVALUATION_CONFIG.thresholds.pastRevenue})`\n  };\n}\n\nfunction evaluateInvestors(investmentText = '', overviewText = '') {\n  const text = preprocessText(investmentText + ' ' + overviewText);\n  \n  const investorIndicators = [\n    'investors', 'backed by', 'funded by', 'investment from',\n    'venture capital', 'vc', 'angel', 'seed', 'series',\n    'raised', 'funding round', 'lead investor', 'participated',\n    'invested', 'investment', 'capital raised', 'angel investors'\n  ];\n  \n  const matchCount = investorIndicators.filter(term => text.includes(term)).length;\n  const hasInvestors = matchCount >= EVALUATION_CONFIG.thresholds.investors;\n  \n  return {\n    answer: hasInvestors ? 'Y' : 'N',\n    reasoning: `Investor indicators found: ${matchCount} (threshold: ${EVALUATION_CONFIG.thresholds.investors})`\n  };\n}\n\nfunction evaluateFunding(investmentText = '', financialText = '') {\n  const text = preprocessText(investmentText + ' ' + financialText);\n  \n  const fundingIndicators = [\n    'raised', 'funding', 'investment', 'capital', 'round',\n    'seed', 'series a', 'series b', 'pre seed', 'million',\n    'financing', 'funded', 'capital raised', 'fundraising'\n  ];\n  \n  // Enhanced funding patterns\n  const fundingPatterns = [\n    /raised\\s*\\$[\\d.,]+[kmb]?/i,\n    /\\$[\\d.,]+[kmb]?\\s*(raised|funding|investment)/i,\n    /(seed|series\\s*[a-z])\\s*(round|funding)/i,\n    /funding.*\\$[\\d.,]+/i,\n    /investment.*\\$[\\d.,]+/i,\n    /\\$[\\d.,]+[kmb]?\\s*(seed|series)/i,\n    /(pre-seed|pre\\s+seed)\\s+round/i\n  ];\n  \n  const hasFundingAmount = fundingPatterns.some(pattern => pattern.test(text));\n  const fundingIndicatorCount = fundingIndicators.filter(term => text.includes(term)).length;\n  const hasFundingIndicators = fundingIndicatorCount >= EVALUATION_CONFIG.thresholds.funding;\n  \n  return {\n    answer: (hasFundingAmount || hasFundingIndicators) ? 'Y' : 'N',\n    reasoning: `Funding amount found: ${hasFundingAmount}, Funding indicators: ${fundingIndicatorCount} (threshold: ${EVALUATION_CONFIG.thresholds.funding})`\n  };\n}\n\nfunction evaluateProfitability(financialText = '') {\n  const text = preprocessText(financialText);\n  \n  const profitIndicators = [\n    'profitable', 'profit', 'positive margin', 'net income',\n    'ebitda positive', 'cash flow positive', 'break even',\n    'unit economics positive', 'gross profit', 'net profit',\n    'profit margin', 'operating profit'\n  ];\n  \n  const lossIndicators = [\n    'burn rate', 'runway', 'loss', 'negative', 'unprofitable',\n    'pre revenue', 'burning', 'deficit', 'operating loss'\n  ];\n  \n  const profitCount = profitIndicators.filter(term => text.includes(term)).length;\n  const lossCount = lossIndicators.filter(term => text.includes(term)).length;\n  \n  // Enhanced margin detection\n  const marginPatterns = [\n    /(\\d+)%\\s*(margin|profit|profitable)/i,\n    /(margin|profit)\\s*[:=]?\\s*(\\d+)%/i,\n    /profit\\s+margin\\s*[:=]?\\s*(\\d+)%/i\n  ];\n  \n  const hasPositiveMargin = marginPatterns.some(pattern => {\n    const match = text.match(pattern);\n    return match && parseInt(match[1] || match[2]) > 0;\n  });\n  \n  const isProfitable = (profitCount > lossCount) || hasPositiveMargin;\n  \n  return {\n    answer: isProfitable ? 'Y' : 'N',\n    reasoning: `Profit indicators: ${profitCount}, Loss indicators: ${lossCount}, Positive margin: ${hasPositiveMargin}`\n  };\n}\n\n// ============================================================================\n// PART 2: SCORECARD CALCULATION (Using Excel-matched formulas)\n// ============================================================================\n\nconst scorecardStructure = {\n  category: {\n    name: \"Category/Market\",\n    questions: [\n      {\n        id: \"category_1\",\n        question: \"Is the category relevant / aligned w/VS vision and expertise?\",\n        weight: 0.10,\n        row: 2\n      },\n      {\n        id: \"category_2\",\n        question: \"Is the product first to market (e.g., white space w/no to little competition)?\",\n        weight: 0.10,\n        row: 3\n      },\n      {\n        id: \"category_3\",\n        question: \"Is the TAM greater than $1B?\",\n        weight: 0.05,\n        row: 4\n      },\n      {\n        id: \"category_4\",\n        question: \"Is the TAM increasing?\",\n        weight: 0.05,\n        row: 5\n      }\n    ]\n  },\n  product: {\n    name: \"Product\",\n    questions: [\n      {\n        id: \"product_1\",\n        question: \"Is there a roadmap for the next 12 months?\",\n        weight: 0.05,\n        row: 8\n      },\n      {\n        id: \"product_2\",\n        question: \"Is there a functioning product that is live / In-Market?\",\n        weight: 0.05,\n        row: 9\n      },\n      {\n        id: \"product_3\",\n        question: \"Is the IP proprietary / patent protected\",\n        weight: 0.10,\n        row: 10\n      }\n    ]\n  },\n  operations: {\n    name: \"Operations\",\n    questions: [\n      {\n        id: \"operations_1\",\n        question: \"Has the team grown since being founded\",\n        weight: 0.05,\n        row: 13\n      },\n      {\n        id: \"operations_2\",\n        question: \"Is this supported by a full-time / dedicated team (not including the founder)?\",\n        weight: 0.05,\n        row: 14\n      },\n      {\n        id: \"operations_3\",\n        question: \"Does the team have a Go-To-Market Plan?\",\n        weight: 0.10,\n        row: 15\n      }\n    ]\n  },\n  financial: {\n    name: \"Financial\",\n    questions: [\n      {\n        id: \"financial_1\",\n        question: \"Are they currently generating revenue?\",\n        weight: 0.10,\n        row: 18\n      },\n      {\n        id: \"financial_2\",\n        question: \"Have they generated revenue in the past 12 months?\",\n        weight: 0.05,\n        row: 19\n      },\n      {\n        id: \"financial_3\",\n        question: \"Are there investors?\",\n        weight: 0.05,\n        row: 20\n      },\n      {\n        id: \"financial_4\",\n        question: \"Do they have funding?\",\n        weight: 0.05,\n        row: 21\n      },\n      {\n        id: \"financial_5\",\n        question: \"Are they profitable?\",\n        weight: 0.05,\n        row: 22\n      }\n    ]\n  }\n};\n\n/**\n * Calculate the final scorecard score based on answers\n * @param {Object} answers - Object with question IDs as keys and Y/N as values\n * @returns {Object} Score details including final percentage\n */\nfunction calculateScorecardScore(answers) {\n  let categorySubtotal = 0;\n  let productSubtotal = 0;\n  let operationsSubtotal = 0;\n  let financialSubtotal = 0;\n  \n  const scoreBreakdown = {\n    category: {},\n    product: {},\n    operations: {},\n    financial: {}\n  };\n  \n  // Process each category with enhanced error handling\n  try {\n    for (const question of scorecardStructure.category.questions) {\n      const answerValue = convertAnswerToNumber(answers[question.id], question.id);\n      const weightedScore = answerValue * question.weight;\n      categorySubtotal += weightedScore;\n      scoreBreakdown.category[question.id] = {\n        answer: answers[question.id],\n        value: answerValue,\n        weight: question.weight,\n        weighted: weightedScore\n      };\n    }\n    \n    for (const question of scorecardStructure.product.questions) {\n      const answerValue = convertAnswerToNumber(answers[question.id], question.id);\n      const weightedScore = answerValue * question.weight;\n      productSubtotal += weightedScore;\n      scoreBreakdown.product[question.id] = {\n        answer: answers[question.id],\n        value: answerValue,\n        weight: question.weight,\n        weighted: weightedScore\n      };\n    }\n    \n    for (const question of scorecardStructure.operations.questions) {\n      const answerValue = convertAnswerToNumber(answers[question.id], question.id);\n      const weightedScore = answerValue * question.weight;\n      operationsSubtotal += weightedScore;\n      scoreBreakdown.operations[question.id] = {\n        answer: answers[question.id],\n        value: answerValue,\n        weight: question.weight,\n        weighted: weightedScore\n      };\n    }\n    \n    for (const question of scorecardStructure.financial.questions) {\n      const answerValue = convertAnswerToNumber(answers[question.id], question.id);\n      const weightedScore = answerValue * question.weight;\n      financialSubtotal += weightedScore;\n      scoreBreakdown.financial[question.id] = {\n        answer: answers[question.id],\n        value: answerValue,\n        weight: question.weight,\n        weighted: weightedScore\n      };\n    }\n  } catch (error) {\n    logEvaluationEvent('ERROR', 'Error calculating scorecard', { error: error.message });\n    throw new EvaluationError('Failed to calculate scorecard score', 'CALCULATION', 'Unknown');\n  }\n  \n  // Calculate total (Excel E25: E23+E16+E11+E6)\n  const totalWeightedScore = financialSubtotal + operationsSubtotal + productSubtotal + categorySubtotal;\n  \n  // Final score (Excel D26: E25/D25, where D25 = 1.0)\n  const finalScore = totalWeightedScore / 1.0;\n  \n  return {\n    finalScore: finalScore,\n    finalScorePercentage: (finalScore * 100).toFixed(2) + '%',\n    categorySubtotal: categorySubtotal,\n    productSubtotal: productSubtotal,\n    operationsSubtotal: operationsSubtotal,\n    financialSubtotal: financialSubtotal,\n    totalWeightedScore: totalWeightedScore,\n    scoreBreakdown: scoreBreakdown\n  };\n}\n\n/**\n * Convert answer to numeric value (0 or 1) with enhanced validation\n */\nfunction convertAnswerToNumber(answer, questionId = 'unknown') {\n  if (answer === undefined || answer === null) {\n    logEvaluationEvent('WARN', `Missing answer for question ${questionId}, defaulting to 0`);\n    return 0;\n  }\n  \n  const answerStr = String(answer).toLowerCase().trim();\n  \n  if (answerStr === 'y' || answerStr === 'yes' || answerStr === 'true' || answerStr === '1') {\n    return 1;\n  }\n  \n  if (answerStr === 'n' || answerStr === 'no' || answerStr === 'false' || answerStr === '0') {\n    return 0;\n  }\n  \n  // Log unexpected answer format\n  logEvaluationEvent('WARN', `Unexpected answer format for question ${questionId}: \"${answer}\", defaulting to 0`);\n  return 0;\n}\n\n// ============================================================================\n// PART 3: VALIDATION AND REPORTING - ENHANCED\n// ============================================================================\n\n/**\n * Validate that all required answers are present\n */\nfunction validateAnswers(answers) {\n  const requiredQuestions = [\n    'category_1', 'category_2', 'category_3', 'category_4',\n    'product_1', 'product_2', 'product_3',\n    'operations_1', 'operations_2', 'operations_3',\n    'financial_1', 'financial_2', 'financial_3', 'financial_4', 'financial_5'\n  ];\n  \n  const missingAnswers = [];\n  const providedAnswers = [];\n  const invalidAnswers = [];\n  \n  requiredQuestions.forEach(questionId => {\n    const answer = answers[questionId];\n    if (answer === undefined || answer === null) {\n      missingAnswers.push(questionId);\n    } else {\n      providedAnswers.push(questionId);\n      const answerStr = String(answer).toLowerCase().trim();\n      if (!['y', 'yes', 'n', 'no', 'true', 'false', '1', '0'].includes(answerStr)) {\n        invalidAnswers.push({ questionId, answer });\n      }\n    }\n  });\n  \n  return {\n    isValid: missingAnswers.length === 0 && invalidAnswers.length === 0,\n    missingAnswers: missingAnswers,\n    invalidAnswers: invalidAnswers,\n    providedAnswers: providedAnswers,\n    completeness: (providedAnswers.length / requiredQuestions.length * 100).toFixed(1) + '%'\n  };\n}\n\n/**\n * Generate detailed evaluation report - ENHANCED VERSION\n */\nfunction generateEvaluationReport(evaluationResult, scoreResult, extractedData) {\n  try {\n    // Build detailed question-by-question breakdown\n    const questionBreakdown = [];\n    \n    // Process all categories\n    const allCategories = ['category', 'product', 'operations', 'financial'];\n    \n    allCategories.forEach(categoryKey => {\n      const categoryConfig = scorecardStructure[categoryKey];\n      const categoryName = categoryConfig.name;\n      \n      categoryConfig.questions.forEach(question => {\n        const scoreData = scoreResult.scoreBreakdown[categoryKey][question.id];\n        questionBreakdown.push({\n          category: categoryName,\n          questionId: question.id,\n          question: question.question,\n          answer: scoreData.answer,\n          answerValue: scoreData.value,\n          weight: (scoreData.weight * 100).toFixed(1) + '%',\n          weightedScore: (scoreData.weighted * 100).toFixed(2) + '%',\n          reasoning: evaluationResult.evaluationDetails[question.id]\n        });\n      });\n    });\n    \n    // Calculate completeness metadata with enhanced error handling\n    const sectionCompleteness = extractedData?.rawExtraction?.sectionCompleteness || {};\n    const requiredSections = ['problem', 'solution', 'market', 'team', 'financial'];\n    const presentRequiredSections = requiredSections.filter(section => \n      sectionCompleteness[section] === true || sectionCompleteness[section] === 'true'\n    );\n    const completenessScore = presentRequiredSections.length > 0 ? \n      (presentRequiredSections.length / requiredSections.length) * 100 : 0;\n    const missingRequiredSections = requiredSections.filter(s => \n      !sectionCompleteness[s] || sectionCompleteness[s] === 'false'\n    );\n    const hasSufficientData = completenessScore >= 60;\n    const isComplete = hasSufficientData;\n    \n    const report = {\n      companyName: evaluationResult.companyName,\n      evaluationDate: evaluationResult.metadata.evaluationDate,\n      \n      // Overall Score\n      score: {\n        final: scoreResult.finalScorePercentage,\n        numeric: scoreResult.finalScore,\n        recommendation: getRecommendation(scoreResult.finalScore)\n      },\n      \n      // Category Scores\n      categoryScores: {\n        category: {\n          score: (scoreResult.categorySubtotal * 100).toFixed(1) + '%',\n          weight: '30%',\n          contribution: scoreResult.categorySubtotal\n        },\n        product: {\n          score: (scoreResult.productSubtotal * 100).toFixed(1) + '%',\n          weight: '20%',\n          contribution: scoreResult.productSubtotal\n        },\n        operations: {\n          score: (scoreResult.operationsSubtotal * 100).toFixed(1) + '%',\n          weight: '20%',\n          contribution: scoreResult.operationsSubtotal\n        },\n        financial: {\n          score: (scoreResult.financialSubtotal * 100).toFixed(1) + '%',\n          weight: '30%',\n          contribution: scoreResult.financialSubtotal\n        }\n      },\n      \n      // Detailed Question-by-Question Breakdown\n      questionBreakdown: questionBreakdown,\n      \n      // Detailed Answers with Reasoning\n      detailedEvaluation: evaluationResult.evaluationDetails,\n      \n      // Answer Summary\n      answerSummary: {\n        yesCount: Object.values(evaluationResult.answers).filter(a => a === 'Y').length,\n        noCount: Object.values(evaluationResult.answers).filter(a => a === 'N').length,\n        answers: evaluationResult.answers\n      },\n      \n      // Validation\n      validation: validateAnswers(evaluationResult.answers),\n      \n      // Configuration used\n      configurationUsed: {\n        thresholds: EVALUATION_CONFIG.thresholds,\n        errorHandling: EVALUATION_CONFIG.errorHandling\n      },\n      \n      // Workflow Metadata - ENHANCED\n      workflowMetadata: {\n        completenessScore: completenessScore,\n        hasSufficientData: hasSufficientData,\n        isComplete: isComplete,\n        missingRequiredSections: missingRequiredSections,\n        presentRequiredSections: presentRequiredSections,\n        totalSectionsFound: Object.values(sectionCompleteness).filter(val => \n          val === true || val === 'true'\n        ).length,\n        totalSectionsPossible: Object.keys(sectionCompleteness).length || requiredSections.length,\n        evaluationLogs: evaluationResult.metadata?.evaluationLogs || []\n      }\n    };\n    \n    return report;\n  } catch (error) {\n    logEvaluationEvent('ERROR', 'Error generating evaluation report', { error: error.message });\n    throw new EvaluationError('Failed to generate evaluation report', 'REPORT_GENERATION', evaluationResult.companyName);\n  }\n}\n\n/**\n * Get investment recommendation based on score\n */\nfunction getRecommendation(score) {\n  if (score >= 0.75) return \"STRONG BUY - Excellent investment opportunity\";\n  if (score >= 0.60) return \"BUY - Good investment opportunity with some considerations\";\n  if (score >= 0.45) return \"CONSIDER - Requires further due diligence\";\n  if (score >= 0.20) return \"MONITOR - Significant concerns present\";\n  return \"PASS - Does not meet investment criteria\";\n}\n\n// ============================================================================\n// MAIN PIPELINE FUNCTION - ENHANCED FOR N8N INTEGRATION\n// ============================================================================\n\n/**\n * Main pipeline function that processes extracted pitch data through evaluation\n * @param {Object} extractedPitchData - Output from PDF extraction code\n * @returns {Object} Complete evaluation report with score\n */\nfunction processPitchDeckPipeline(extractedPitchData) {\n  logEvaluationEvent('INFO', \"Starting PE Deal Scorecard Pipeline...\");\n  \n  try {\n    // Enhanced input validation\n    if (!extractedPitchData || typeof extractedPitchData !== 'object') {\n      logEvaluationEvent('ERROR', \"Invalid input data structure\");\n      return {\n        error: \"Invalid input data - must be an object\",\n        score: { numeric: 0, final: \"0.00%\", recommendation: \"ERROR - Invalid input\" },\n        workflowMetadata: {\n          completenessScore: 0,\n          hasSufficientData: false,\n          isComplete: false,\n          error: \"Invalid input data structure\"\n        }\n      };\n    }\n    \n    // Step 1: Generate answers from extracted pitch data\n    const evaluationResult = evaluatePitchToAnswers(extractedPitchData);\n    \n    // Step 2: Validate answers\n    const validation = validateAnswers(evaluationResult.answers);\n    if (!validation.isValid) {\n      logEvaluationEvent('WARN', `Validation issues found`, {\n        missingAnswers: validation.missingAnswers,\n        invalidAnswers: validation.invalidAnswers\n      });\n    }\n    \n    // Step 3: Calculate scorecard score\n    const scoreResult = calculateScorecardScore(evaluationResult.answers);\n    \n    // Step 4: Generate comprehensive report\n    const report = generateEvaluationReport(evaluationResult, scoreResult, extractedPitchData);\n    \n    // Step 5: Enhanced logging\n    logEvaluationEvent('INFO', `Evaluation completed successfully`, {\n      companyName: report.companyName,\n      finalScore: report.score.final,\n      yesAnswers: report.answerSummary.yesCount,\n      completeness: validation.completeness,\n      isComplete: report.workflowMetadata.isComplete\n    });\n    \n    console.log(\"\\n\" + \"=\".repeat(60));\n    console.log(`EVALUATION COMPLETE: ${report.companyName}`);\n    console.log(\"=\".repeat(60));\n    console.log(`Final Score: ${report.score.final} (${report.score.recommendation})`);\n    console.log(`Yes Answers: ${report.answerSummary.yesCount}/15`);\n    console.log(`Data Completeness: ${validation.completeness}`);\n    console.log(`Proposal Complete: ${report.workflowMetadata.isComplete}`);\n    console.log(\"-\".repeat(60));\n    console.log(\"Category Contributions:\");\n    Object.entries(report.categoryScores).forEach(([category, details]) => {\n      console.log(`  ${category.padEnd(12)}: ${details.score.padEnd(8)} (Weight: ${details.weight})`);\n    });\n    \n    // Log question-by-question breakdown if debug mode\n    if (EVALUATION_CONFIG.errorHandling.logLevel === 'DEBUG') {\n      console.log(\"\\n\" + \"-\".repeat(60));\n      console.log(\"Question-by-Question Breakdown:\");\n      console.log(\"-\".repeat(60));\n      report.questionBreakdown.forEach((q, index) => {\n        console.log(`\\n${index + 1}. [${q.category}] ${q.question}`);\n        console.log(`   Answer: ${q.answer} | Weight: ${q.weight} | Contribution: ${q.weightedScore}`);\n        console.log(`   Reasoning: ${q.reasoning}`);\n      });\n    }\n    \n    return report;\n    \n  } catch (error) {\n    logEvaluationEvent('ERROR', 'Pipeline execution failed', { error: error.message });\n    \n    return {\n      error: `Pipeline execution failed: ${error.message}`,\n      score: { \n        numeric: 0, \n        final: \"0.00%\", \n        recommendation: \"ERROR - Pipeline execution failed\" \n      },\n      workflowMetadata: {\n        completenessScore: 0,\n        hasSufficientData: false,\n        isComplete: false,\n        error: error.message,\n        timestamp: new Date().toISOString()\n      }\n    };\n  }\n}\n\n// ============================================================================\n// N8N USAGE - ENHANCED ERROR HANDLING\n// ============================================================================\n\ntry {\n  // Get input from the previous extraction step with validation\n  const input = $input.first();\n  if (!input || !input.json) {\n    throw new Error('No input data received from previous step');\n  }\n  \n  const extractedData = input.json;\n  \n  // Process through the complete pipeline\n  const evaluationReport = processPitchDeckPipeline(extractedData);\n  \n  // Return the comprehensive evaluation report\n  return [{\n    json: evaluationReport\n  }];\n  \n} catch (error) {\n  logEvaluationEvent('ERROR', 'N8N execution failed', { error: error.message });\n  \n  // Return error response that won't break the workflow\n  return [{\n    json: {\n      error: `N8N execution failed: ${error.message}`,\n      score: { \n        numeric: 0, \n        final: \"0.00%\", \n        recommendation: \"ERROR - N8N execution failed\" \n      },\n      workflowMetadata: {\n        completenessScore: 0,\n        hasSufficientData: false,\n        isComplete: false,\n        error: error.message,\n        timestamp: new Date().toISOString()\n      }\n    }\n  }];\n}"
        },
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          176,
          176
        ],
        "id": "a797d72f-6299-426a-a1fd-37f6ec9e1782",
        "name": "Generate Yes/No answers scorecard questions1"
      },
      {
        "parameters": {},
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.2,
        "position": [
          1328,
          288
        ],
        "id": "c7784521-4d40-4785-934a-8607705c057f",
        "name": "Merge"
      },
      {
        "parameters": {
          "jsonSchemaExample": "{\n  \"companyName\": \"DataFlow AI\",\n  \"scorecardRating\": \"78% - STRONG BUY. Market-leading platform positioned in rapidly expanding $47.2B AI automation market with demonstrated product-market fit, 147% YoY revenue growth, and experienced leadership team from Google, Salesforce, and Microsoft.\",\n  \"investmentThesis\": \"DataFlow AI represents a compelling investment opportunity in the high-growth enterprise AI automation sector. The company has achieved strong product-market fit with 450+ enterprise customers, maintains healthy unit economics (4.2:1 LTV/CAC), and targets a $47.2B TAM growing at 18.5% CAGR. With proprietary AI algorithms and 5x faster implementation than competitors, the company is positioned to capture 3-5% market share within 4 years, supporting a 4-6x return profile.\",\n  \"recommendedAction\": \"STRONG BUY\",\n  \"keyRisks\": \"Key risks include intense competition from well-funded incumbents (UiPath $842M funding, Automation Anywhere $840M funding), potential regulatory changes affecting AI governance and data privacy, dependency on founder leadership for strategic direction and customer relationships, technical scalability challenges with rapid enterprise customer growth, and market timing risks in current economic environment with enterprise budget constraints.\",\n  \"expectedReturnProfile\": \"4-6x cash-on-cash return within 4-6 years based on comparable AI automation transaction multiples of 8-12x revenue. Exit opportunities include strategic acquisition by enterprise software leaders (Microsoft, Salesforce, Oracle) or growth equity recapitalization. Revenue projection to $45M by Year 4 supports $360-540M valuation at exit.\",\n  \"marketPercent\": \"30%\",\n  \"marketScore\": \"26\",\n  \"productPercent\": \"20%\",\n  \"productScore\": \"16\", \n  \"operationsPercent\": \"20%\",\n  \"operationsScore\": \"15\",\n  \"financialPercent\": \"30%\",\n  \"financialScore\": \"21\",\n  \"overallScorePercent\": \"100%\",\n  \"overallScore\": \"78\",\n  \"foundingYear\": \"2021\",\n  \"headquartersLocation\": \"San Francisco, CA\",\n  \"website\": \"www.dataflow-ai.com\",\n  \"fundingStage\": \"Series A\",\n  \"employeesCount\": \"45\",\n  \"amount\": \"8.5\",\n  \"rounds\": \"3\",\n  \"crunchbasePitchbookLink\": \"https://www.crunchbase.com/organization/dataflow-ai\",\n  \"name\": \"Sarah Chen\",\n  \"keyExecutives\": \"CTO: Alex Rodriguez, former Principal Engineer at Google Cloud with 8 years in ML/AI infrastructure; VP Sales: Maria Thompson, former Enterprise Sales Director at Salesforce with 10 years enterprise software experience; Head of Product: David Kim, former Senior PM at Microsoft Azure with 6 years enterprise platform experience; VP Marketing: Jennifer Liu, former Marketing Director at Snowflake with 7 years B2B SaaS experience\",\n  \"boardComposition\": \"Sarah Chen (CEO), Alex Rodriguez (CTO), plus 3 independent directors including former Salesforce VP Enterprise, Bessemer Venture Partners General Partner, and ex-Google Cloud VP Engineering. Advisory board includes former Workday Chief Product Officer and ex-UiPath Head of Strategy.\",\n  \"teamScorecardAlignment\": \"Team demonstrates strong execution capability with 3 of 3 operations criteria met including full-time dedication from all founders, documented 12-month growth plan with quarterly milestones, and proven GTM strategy validated by 147% YoY revenue growth.\",\n  \"valueProposition\": \"AI-powered enterprise automation platform that reduces manual document processing by 85% while improving accuracy to 99.2%, enabling Fortune 1000 companies to scale operations efficiently. Platform processes 10M+ documents monthly, saving average customer $2.3M annually in operational costs while reducing processing time from days to minutes.\",\n  \"revenueModel\": \"SaaS subscription model with tiered pricing: Starter ($2,500/month for up to 10K documents), Professional ($8,500/month for up to 50K documents), Enterprise (custom pricing starting at $25,000/month for unlimited processing). Annual contracts provide 15% discount. Average customer starts at Professional tier and expands to Enterprise within 18 months.\",\n  \"customerSegments\": \"Mid-market to enterprise companies (1,000-50,000 employees) in financial services (40% of revenue), healthcare (25%), insurance (20%), and professional services (15%) sectors. Primary buyers are Chief Operations Officers and VP Finance roles managing high-volume document workflows. Sweet spot customers process 25K+ documents monthly with $100M+ annual revenue.\",\n  \"competitiveAdvantage\": \"Proprietary multi-modal AI algorithms trained on 500M+ enterprise documents, achieving 99.2% accuracy vs industry average 94%. 5x faster implementation than competitors (2 weeks vs 10+ weeks) through pre-built integrations with 50+ enterprise systems. Deep learning models continuously improve with customer data, creating defensible data network effects.\",\n  \"currentMarketSize\": \"Global enterprise AI automation market valued at $47.2B in 2024 with strong growth driven by digital transformation initiatives, regulatory compliance requirements, and labor shortage pressures across Fortune 1000 companies (Source: Gartner Magic Quadrant Enterprise AI Platforms 2024)\",\n  \"scorecardCheckX\": \"âœ“\",\n  \"geographicBreakdown\": \"North America: $18.5B (39%) driven by regulatory compliance and early AI adoption, Europe: $14.2B (30%) led by GDPR data processing requirements, Asia-Pacific: $12.8B (27%) growing fastest at 22% CAGR with digital transformation acceleration, Rest of World: $1.7B (4%) emerging markets with government digitization initiatives\",\n  \"segmentAnalysis\": \"Enterprise (5,000+ employees): $28.3B representing 60% of market with highest willingness to pay for AI solutions, Mid-market (1,000-4,999 employees): $13.7B growing 20% annually as AI becomes more accessible, Small business (100-999 employees): $5.2B early adoption phase with 25% CAGR reflecting increasing automation needs across all company sizes\",\n  \"cagrPercent\": \"18.5%\",\n  \"tamIncreasing\": \"âœ“\",\n  \"growthDriver1\": \"Digital transformation acceleration post-COVID driving 40% increase in automation budget allocation across Fortune 500 companies, with 78% of enterprises planning AI investments in next 24 months (McKinsey Global Institute Enterprise AI Survey 2024)\",\n  \"growthDriver2\": \"Regulatory compliance requirements including SOX, GDPR, and industry-specific mandates creating demand for automated audit trails and process documentation, representing $8.2B compliance-driven automation market (Deloitte Regulatory Technology Report 2024)\",\n  \"growthDriver3\": \"Severe labor shortage in skilled back-office positions driving 65% of enterprises to evaluate automation solutions, with average 23% reduction in available qualified candidates for document processing roles (Bureau of Labor Statistics, Enterprise Workforce Report 2024)\",\n  \"competitorCompA\": \"UiPath\",\n  \"fundingX1\": \"842\",\n  \"valuation1\": \"35000\",\n  \"marketSharePercent1\": \"35%\",\n  \"competitorCompB\": \"Automation Anywhere\", \n  \"fundingX2\": \"840\",\n  \"valuation2\": \"6800\",\n  \"marketSharePercent2\": \"25%\",\n  \"competitorCompC\": \"Microsoft Power Platform\",\n  \"fundingX3\": \"N/A\",\n  \"valuation3\": \"Embedded\",\n  \"marketSharePercent3\": \"15%\",\n  \"marketPosition\": \"Emerging AI-first challenger targeting 3-5% market share within 4 years through vertical-specific solutions and superior AI accuracy. Positioned between legacy RPA providers (UiPath, AA) and platform giants (Microsoft) with focused enterprise document automation specialization.\",\n  \"differentiationAnalysis\": \"Proprietary multi-modal AI achieving 99.2% accuracy vs 94% industry average, 5x faster implementation through pre-built integrations, continuous learning improving with customer data, and vertical-specific models for financial services, healthcare, and insurance industries providing immediate value.\",\n  \"barrierToEntryAssessment\": \"High - requires significant R&D investment ($10M+ annually), access to large-scale enterprise document training data, regulatory compliance expertise across multiple industries, and established relationships with enterprise software vendors for integration partnerships. Technical moat strengthens with customer data network effects.\",\n  \"scorecardCheck\": \"âœ“\",\n  \"currentRegulations\": \"GDPR Article 22 automated decision-making requirements, SOX Section 404 internal controls documentation, HIPAA automation audit trail requirements, PCI DSS automated data processing standards, and state-level AI bias regulations (California SB-1001) affecting document processing automation deployment across enterprise customers\",\n  \"pendingChanges\": \"EU AI Act implementation (2025-2026) requiring AI system documentation and bias testing, US federal AI governance framework expected Q2 2025, enhanced data localization requirements across 15+ states, and sector-specific AI regulations in financial services (GDPR successor) and healthcare (HITECH expansion) creating compliance opportunities\",\n  \"complianceStatus\": \"Fully compliant with current GDPR, SOX, HIPAA, and PCI DSS requirements through built-in audit trails, data encryption, and compliance reporting features. Proactive compliance strategy includes EU AI Act readiness program and partnership with legal compliance specialists for regulatory changes.\",\n  \"sources\": \"Government regulatory sites (regulations.gov, eur-lex.europa.eu), legal databases (Westlaw, LexisNexis), industry compliance reports (Deloitte, PwC), AI governance organizations (Partnership on AI, AI Ethics Institute)\",\n  \"productStage\": \"GA (Generally Available)\",\n  \"launchDate\": \"March 2023\",\n  \"activeUsersCustomersNumber\": \"450+ active enterprise customers with 15,000+ daily active users processing 10M+ documents monthly\",\n  \"q1Features\": \"Advanced analytics dashboard with ROI tracking, enhanced API rate limits (10x increase), real-time collaboration features\",\n  \"q1TechnicalRisk\": \"Low\",\n  \"q1EvidenceLinks\": \"Product roadmap documentation validated with 15+ enterprise customers, beta testing completed with 89% satisfaction rate\",\n  \"q2Features\": \"Mobile application for iOS/Android, expanded marketplace integrations (Slack, Teams, Notion), multi-language support (Spanish, French, German)\",\n  \"q2TechnicalRisk\": \"Medium\", \n  \"q2EvidenceLinks\": \"Technical specifications reviewed with engineering team, mobile development partner contracted, customer demand validated through 200+ feature requests\",\n  \"q3Features\": \"Enterprise security enhancements (SSO, SCIM), multi-tenant architecture for MSP partners, advanced workflow automation builder\",\n  \"q3TechnicalRisk\": \"Medium\",\n  \"q3EvidenceLinks\": \"Security audit requirements from 25+ Fortune 500 prospects, MSP partner program development initiated, workflow builder prototyped\",\n  \n  \"q4Features\": \"International data residency (EU, APAC), AI model customization platform, advanced reporting and analytics suite\",\n  \"q4TechnicalRisk\": \"High\",\n  \"q4EvidenceLinks\": \"International expansion market research completed, AI customization technical feasibility study, advanced analytics requirements gathered from enterprise customers\",\n  \"patentsFiledNumber\": \"5\",\n  \"patentsGrantedNumber\": \"2\",\n  \"tradeSecrets\": \"Proprietary multi-modal AI training methodologies, document classification algorithms optimized for enterprise workflows, customer data processing optimization techniques, and integration framework for enterprise software ecosystems\",\n  \"technologyStack\": \"Python/TensorFlow for AI models, React/TypeScript frontend, Node.js/PostgreSQL backend, AWS cloud infrastructure with Kubernetes orchestration, Redis caching, Elasticsearch for document indexing\",\n  \"proprietaryAlgorithms\": \"Multi-modal transformer models combining OCR, NLP, and computer vision trained on 500M+ enterprise documents, achieving 99.2% accuracy. Custom neural architecture for document layout understanding and automated workflow generation with continuous learning capabilities.\",\n  \"dataAdvantages\": \"Exclusive access to 500M+ enterprise document dataset across financial services, healthcare, and insurance verticals. Proprietary training data includes document variants, edge cases, and domain-specific terminology creating defensive moat against competitors.\",\n  \"networkEffects\": \"Platform value increases exponentially with customer adoption as AI models improve with more training data. Each new customer contributes document diversity improving accuracy for all users. Integration ecosystem strengthens with partner adoption creating switching costs.\",\n  \"technicalDebtAssessment\": \"Low - modern cloud-native architecture deployed 2023, automated testing coverage 85%, regular refactoring cycles, comprehensive monitoring and observability, scalable microservices design supporting 10x growth without major architectural changes\",\n  \"npsScore\": \"68\",\n  \"customerRetentionPercent\": \"94%\",\n  \"usageMetrics\": \"Daily Active Users: 15,000, Monthly Active Users: 42,000, 82% weekly active user rate, average 45 minutes daily usage, 340% increase in document processing volume year-over-year\",\n  \"customerReviews\": \"4.7/5.0 average rating across G2 (4.8/5, 150+ reviews), Capterra (4.6/5, 89+ reviews), and TrustPilot (4.7/5, 67+ reviews) with consistent praise for accuracy, implementation speed, and customer support quality\",\n  \"currentHeadcount\": \"45\",\n  \"foundingSize\": \"3\",\n  \"scorecardCheckFullTime\": \"âœ“\",\n  \"engineeringHeadcount\": \"22\",\n  \"salesMarketingHeadcount\": \"12\", \n  \"operationsHeadcount\": \"6\",\n  \"leadershipHeadcount\": \"5\",\n  \"linkedinProfileLink\": \"https://linkedin.com/company/dataflow-ai\",\n  \"previousExperience\": \"78% of leadership team from Fortune 500/FAANG companies including Google, Microsoft, Salesforce, Oracle, and Snowflake\",\n  \"technicalExpertise\": \"AI/ML (TensorFlow, PyTorch), enterprise software architecture, cloud infrastructure (AWS, Azure), cybersecurity (SOC2, GDPR), API development, and enterprise integration platforms\",\n  \"industryVeterans\": \"Former executives from Salesforce (VP Enterprise), Google Cloud (Engineering Director), Microsoft Azure (Senior PM), Workday (Chief Product Officer), and UiPath (Head of Strategy) providing deep enterprise software expertise\",\n  \"glassdoorRating\": \"4.3\",\n  \"scorecardCheckGTM\": \"âœ“\",\n  \"salesModel\": \"Direct enterprise sales with growing channel partner network including systems integrators (Accenture, Deloitte) and technology partners (Salesforce AppExchange, Microsoft Partner Network)\",\n  \"cacAmount\": \"1850\",\n  \"salesCycle\": \"4.5 months\",\n  \"pipelineCoverageX\": \"3.8\",\n  \"websiteTrafficMonthlyVisitors\": \"85000\",\n  \"seoPerformanceDomainAuthority\": \"52\",\n  \"socialPresenceFollowersEngagement\": \"LinkedIn: 8,500 followers (4.2% engagement rate), Twitter: 3,200 followers (2.8% engagement), YouTube: 1,800 subscribers with 45K+ monthly views\",\n  \"contentStrategy\": \"Weekly thought leadership blog posts (avg 2,500 readers), monthly industry whitepapers (12+ published, 15K+ downloads), quarterly enterprise automation reports, bi-weekly webinar series (avg 350 attendees)\",\n  \"currentBurnRateAmount\": \"420\",\n  \"runwayMonths\": \"22\",\n  \"unitEconomicsLtvCacRatio\": \"4.2:1\",\n  \"operationalEfficiencyMetrics\": \"Revenue per employee: $126K (vs $95K industry average), Gross margin: 82% (vs 75% industry average), Customer support efficiency: 4.8/5.0 CSAT with 2.1 hours average resolution time\",\n  \"scorecardCheckRevenue\": \"âœ“\",\n  \"revenue2023\": \"2100\",\n  \"growth2023\": \"-\",\n  \"mrrArr2023\": \"175\",\n  \"source2023\": \"Audited financial statements (Grant Thornton)\",\n  \n  \"revenue2024\": \"5200\", \n  \"growth2024\": \"147%\",\n  \"mrrArr2024\": \"433\",\n  \"source2024\": \"Management reporting (verified by board)\",\n  \n  \"revenue2025\": \"11800\",\n  \"growth2025\": \"127%\", \n  \"mrrArr2025\": \"983\",\n  \"source2025\": \"Financial projections (validated with CFO)\"\n}"
        },
        "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
        "typeVersion": 1.3,
        "position": [
          3008,
          624
        ],
        "id": "c4058f09-048c-4758-b81d-b2d29bedca0a",
        "name": "Structured Output Parser"
      },
      {
        "parameters": {
          "operation": "update",
          "documentURL": "={{ $('Report Data Prep').item.json.investmentAnalystReportId }}",
          "actionsUi": {
            "actionFields": [
              {
                "action": "replaceAll",
                "text": "[Company Name]",
                "replaceText": "={{ $json.output.companyName }}"
              },
              {
                "action": "replaceAll",
                "text": "[Scorecard Rating]",
                "replaceText": "={{ $json.output.scorecardRating }}"
              },
              {
                "action": "replaceAll",
                "text": "[Investment Thesis]",
                "replaceText": "={{ $json.output.investmentThesis }}"
              },
              {
                "action": "replaceAll",
                "text": "[Recommended Action]",
                "replaceText": "={{ $json.output.recommendedAction }}"
              },
              {
                "action": "replaceAll",
                "text": "[Key Risks]",
                "replaceText": "={{ $json.output.keyRisks }}"
              },
              {
                "action": "replaceAll",
                "text": "[Expected Return Profile]",
                "replaceText": "={{ $json.output.expectedReturnProfile }}"
              },
              {
                "action": "replaceAll",
                "text": "[Market %]",
                "replaceText": "={{ $json.output.marketPercent }}"
              },
              {
                "action": "replaceAll",
                "text": "[Market Score]",
                "replaceText": "={{ $json.output.marketScore }}"
              },
              {
                "action": "replaceAll",
                "text": "[Product %]",
                "replaceText": "={{ $json.output.productPercent }}"
              },
              {
                "action": "replaceAll",
                "text": "[Product Score]",
                "replaceText": "={{ $json.output.productScore }}"
              },
              {
                "action": "replaceAll",
                "text": "[Operations %]",
                "replaceText": "={{ $json.output.operationsPercent }}"
              },
              {
                "action": "replaceAll",
                "text": "[Operations Score]",
                "replaceText": "={{ $json.output.operationsScore }}"
              },
              {
                "action": "replaceAll",
                "text": "[Financial %]",
                "replaceText": "={{ $json.output.financialPercent }}"
              },
              {
                "action": "replaceAll",
                "text": "[Financial Score]",
                "replaceText": "={{ $json.output.financialScore }}"
              },
              {
                "action": "replaceAll",
                "text": "[Overall Score %]",
                "replaceText": "={{ $json.output.overallScorePercent }}"
              },
              {
                "action": "replaceAll",
                "text": "[Overall Score]",
                "replaceText": "={{ $json.output.overallScore }}"
              },
              {
                "action": "replaceAll",
                "text": "[Founding Year]",
                "replaceText": "={{ $json.output.foundingYear }}"
              },
              {
                "action": "replaceAll",
                "text": "[Headquarters Location]",
                "replaceText": "={{ $json.output.headquartersLocation }}"
              },
              {
                "action": "replaceAll",
                "text": "[Website]",
                "replaceText": "={{ $json.output.website }}"
              },
              {
                "action": "replaceAll",
                "text": "[Funding Stage]",
                "replaceText": "={{ $json.output.fundingStage }}"
              },
              {
                "action": "replaceAll",
                "text": "[Employees Count]",
                "replaceText": "={{ $json.output.employeesCount }}"
              },
              {
                "action": "replaceAll",
                "text": "[Amount]",
                "replaceText": "={{ $json.output.amount }}"
              },
              {
                "action": "replaceAll",
                "text": "[X]",
                "replaceText": "={{ $json.output.rounds }}"
              },
              {
                "action": "replaceAll",
                "text": "[Crunchbase PitchBook link]",
                "replaceText": "={{ $json.output.crunchbasePitchbookLink }}"
              },
              {
                "action": "replaceAll",
                "text": "[Name]",
                "replaceText": "={{ $json.output.name }}"
              },
              {
                "action": "replaceAll",
                "text": "[ Key Executives]",
                "replaceText": "={{ $json.output.keyExecutives }}"
              },
              {
                "action": "replaceAll",
                "text": "[Board Composition]",
                "replaceText": "={{ $json.output.boardComposition }}"
              },
              {
                "action": "replaceAll",
                "text": "[Team Scorecard Alignment]",
                "replaceText": "={{ $json.output.teamScorecardAlignment }}"
              },
              {
                "action": "replaceAll",
                "text": "[Value Proposition]",
                "replaceText": "={{ $json.output.valueProposition }}"
              },
              {
                "action": "replaceAll",
                "text": "[Revenue Model]",
                "replaceText": "={{ $json.output.revenueModel }}"
              },
              {
                "action": "replaceAll",
                "text": "[Customer Segments]",
                "replaceText": "={{ $json.output.customerSegments }}"
              },
              {
                "action": "replaceAll",
                "text": "[Competitive Advantage]",
                "replaceText": "={{ $json.output.competitiveAdvantage }}"
              },
              {
                "action": "replaceAll",
                "text": "[Current Market Size]",
                "replaceText": "={{ $json.output.currentMarketSize }}"
              },
              {
                "action": "replaceAll",
                "text": "[Scorecard Check X]",
                "replaceText": "={{ $json.output.scorecardCheckX }}"
              },
              {
                "action": "replaceAll",
                "text": "[Geographic Breakdown - Regional market sizes with source links]",
                "replaceText": "={{ $json.output.geographicBreakdown }}"
              },
              {
                "action": "replaceAll",
                "text": "[Segment Analysis]",
                "replaceText": "={{ $json.output.segmentAnalysis }}"
              },
              {
                "action": "replaceAll",
                "text": "[CAGR%]",
                "replaceText": "={{ $json.output.cagrPercent }}"
              },
              {
                "action": "replaceAll",
                "text": "[TAM increasing]",
                "replaceText": "={{ $json.output.tamIncreasing }}"
              },
              {
                "action": "replaceAll",
                "text": "[Growth Driver 1]",
                "replaceText": "={{ $json.output.growthDriver1 }}"
              },
              {
                "action": "replaceAll",
                "text": "[Growth Driver 2]",
                "replaceText": "={{ $json.output.growthDriver2 }}"
              },
              {
                "action": "replaceAll",
                "text": "[Growth Driver 3]",
                "replaceText": "={{ $json.output.growthDriver3 }}"
              },
              {
                "action": "replaceAll",
                "text": "[Competitor-Comp A]",
                "replaceText": "={{ $json.output.competitorCompA }}"
              },
              {
                "action": "replaceAll",
                "text": "$[FundingX]M",
                "replaceText": "=${{ $json.output.fundingX1 }}M"
              },
              {
                "action": "replaceAll",
                "text": "$[Valuation]M",
                "replaceText": "=${{ $json.output.valuation1 }}M"
              },
              {
                "action": "replaceAll",
                "text": "[Market Share%]",
                "replaceText": "={{ $json.output.marketSharePercent1 }}"
              },
              {
                "action": "replaceAll",
                "text": "[Competitor-Comp B]",
                "replaceText": "={{ $json.output.competitorCompB }}"
              },
              {
                "action": "replaceAll",
                "text": "[Competitor-Comp C]",
                "replaceText": "={{ $json.output.competitorCompC }}"
              },
              {
                "action": "replaceAll",
                "text": "[ Market Position ]",
                "replaceText": "={{ $json.output.marketPosition }}"
              },
              {
                "action": "replaceAll",
                "text": "[Differentiation Analysis]",
                "replaceText": "={{ $json.output.differentiationAnalysis }}"
              },
              {
                "action": "replaceAll",
                "text": "[Barrier to Entry Assessment]",
                "replaceText": "={{ $json.output.barrierToEntryAssessment }}"
              },
              {
                "action": "replaceAll",
                "text": "[Scorecard Check]",
                "replaceText": "={{ $json.output.scorecardCheck }}"
              },
              {
                "action": "replaceAll",
                "text": "[Current Regulations - Key regulations affecting business]",
                "replaceText": "={{ $json.output.currentRegulations }}"
              },
              {
                "action": "replaceAll",
                "text": "[ Pending Changes - Upcoming regulatory shifts]",
                "replaceText": "={{ $json.output.pendingChanges }}"
              },
              {
                "action": "replaceAll",
                "text": "[Compliance Status - Company's regulatory position]",
                "replaceText": "={{ $json.output.complianceStatus }}"
              },
              {
                "action": "replaceAll",
                "text": "[Sources - Government sites, legal databases]",
                "replaceText": "={{ $json.output.sources }}"
              },
              {
                "action": "replaceAll",
                "text": "[Product Stage - MVP/Beta/GA/Mature]",
                "replaceText": "={{ $json.output.productStage }}"
              },
              {
                "action": "replaceAll",
                "text": "[Launch Date]",
                "replaceText": "={{ $json.output.launchDate }}"
              },
              {
                "action": "replaceAll",
                "text": "[Active Users/Customers Number]",
                "replaceText": "={{ $json.output.activeUsersCustomersNumber }}"
              },
              {
                "action": "replaceAll",
                "text": "[Features]",
                "replaceText": "={{ $json.output.q1Features }}"
              },
              {
                "action": "replaceAll",
                "text": "[Technical Risk - Low/Med/High\\]",
                "replaceText": "={{ $json.output.q1TechnicalRisk }}"
              },
              {
                "action": "replaceAll",
                "text": "[Evidence links ]",
                "replaceText": "={{ $json.output.q1EvidenceLinks }}"
              },
              {
                "action": "replaceAll",
                "text": "[Patents Filed - Number]",
                "replaceText": "={{ $json.output.patentsFiledNumber }}"
              },
              {
                "action": "replaceAll",
                "text": "[Patents Granted - Number]",
                "replaceText": "={{ $json.output.patentsGrantedNumber }}"
              },
              {
                "action": "replaceAll",
                "text": "[Trade Secrets - Description of proprietary technology]",
                "replaceText": "={{ $json.output.tradeSecrets }}"
              },
              {
                "action": "replaceAll",
                "text": "[Technology Stack - Core technologies used]",
                "replaceText": "={{ $json.output.technologyStack }}"
              },
              {
                "action": "replaceAll",
                "text": "[Proprietary Algorithms - Description with technical validation]",
                "replaceText": "={{ $json.output.proprietaryAlgorithms }}"
              },
              {
                "action": "replaceAll",
                "text": "[Data Advantages - Unique data assets]",
                "replaceText": "={{ $json.output.dataAdvantages }}"
              },
              {
                "action": "replaceAll",
                "text": "[ Network Effects - Platform dynamics]",
                "replaceText": "={{ $json.output.networkEffects }}"
              },
              {
                "action": "replaceAll",
                "text": "[Technical Debt Assessment - Low Medium High]",
                "replaceText": "={{ $json.output.technicalDebtAssessment }}"
              },
              {
                "action": "replaceAll",
                "text": "[NPS Score]",
                "replaceText": "={{ $json.output.npsScore }}"
              },
              {
                "action": "replaceAll",
                "text": "[Customer Retention %]",
                "replaceText": "={{ $json.output.customerRetentionPercent }}"
              },
              {
                "action": "replaceAll",
                "text": "[Usage Metrics - DAU/MAU, engagement rates]",
                "replaceText": "={{ $json.output.usageMetrics }}"
              },
              {
                "action": "replaceAll",
                "text": "[Customer Reviews - Aggregate rating]",
                "replaceText": "={{ $json.output.customerReviews }}"
              },
              {
                "action": "replaceAll",
                "text": "[Current Headcount - Number]",
                "replaceText": "={{ $json.output.currentHeadcount }}"
              },
              {
                "action": "replaceAll",
                "text": "[Current Headcount - Founding size]",
                "replaceText": "={{ $json.output.foundingSize }}"
              },
              {
                "action": "replaceAll",
                "text": "[Scorecard Check ]",
                "replaceText": "={{ $json.output.scorecardCheckFullTime }}"
              },
              {
                "action": "replaceAll",
                "text": "[Headcount Number]",
                "replaceText": "={{ $json.output.engineeringHeadcount }}"
              },
              {
                "action": "replaceAll",
                "text": "[LinkedIn Profile Link]",
                "replaceText": "={{ $json.output.linkedinProfileLink }}"
              },
              {
                "action": "replaceAll",
                "text": "[Previous Experience - % from Fortune 500/FAANG]",
                "replaceText": "={{ $json.output.previousExperience }}"
              },
              {
                "action": "replaceAll",
                "text": "[Technical Expertise - Key capabilities]",
                "replaceText": "={{ $json.output.technicalExpertise }}"
              },
              {
                "action": "replaceAll",
                "text": "[Industry Veterans - Notable hires with LinkedIn verification]",
                "replaceText": "={{ $json.output.industryVeterans }}"
              },
              {
                "action": "replaceAll",
                "text": "[Glassdoor Rating - Score]",
                "replaceText": "={{ $json.output.glassdoorRating }}"
              },
              {
                "action": "replaceAll",
                "text": "[ Scorecard Check X ]",
                "replaceText": "={{ $json.output.scorecardCheckGTM }}"
              },
              {
                "action": "replaceAll",
                "text": "[Sales Model - Direct/Channel/PLG]",
                "replaceText": "={{ $json.output.salesModel }}"
              },
              {
                "action": "replaceAll",
                "text": "[CAC Amount]",
                "replaceText": "={{ $json.output.cacAmount }}"
              },
              {
                "action": "replaceAll",
                "text": "[Sales Cycle - Days/Months]",
                "replaceText": "={{ $json.output.salesCycle }}"
              },
              {
                "action": "replaceAll",
                "text": "[ Pipeline Coverage X]",
                "replaceText": "={{ $json.output.pipelineCoverageX }}"
              },
              {
                "action": "replaceAll",
                "text": "[Website Traffic Monthly visitors]",
                "replaceText": "={{ $json.output.websiteTrafficMonthlyVisitors }}"
              },
              {
                "action": "replaceAll",
                "text": "[SEO Performance - Domain authority]",
                "replaceText": "={{ $json.output.seoPerformanceDomainAuthority }}"
              },
              {
                "action": "replaceAll",
                "text": "[Social Presence - Followers/engagement]",
                "replaceText": "={{ $json.output.socialPresenceFollowersEngagement }}"
              },
              {
                "action": "replaceAll",
                "text": "[Content Strategy - Blog posts, whitepapers with links]",
                "replaceText": "={{ $json.output.contentStrategy }}"
              },
              {
                "action": "replaceAll",
                "text": "[Current Burn Rate - Amount]",
                "replaceText": "={{ $json.output.currentBurnRateAmount }}"
              },
              {
                "action": "replaceAll",
                "text": "[Runway - Months]",
                "replaceText": "={{ $json.output.runwayMonths }}"
              },
              {
                "action": "replaceAll",
                "text": "[Unit Economics - LTV CAC ratio]",
                "replaceText": "={{ $json.output.unitEconomicsLtvCacRatio }}"
              },
              {
                "action": "replaceAll",
                "text": "[Operational Efficiency Metrics - Revenue per employee, etc.]",
                "replaceText": "={{ $json.output.operationalEfficiencyMetrics }}"
              },
              {
                "action": "replaceAll",
                "text": "[Scorecard Check X ]",
                "replaceText": "={{ $json.output.scorecardCheckRevenue }}"
              },
              {
                "action": "replaceAll",
                "text": "[Revenue X]",
                "replaceText": "={{ $json.output.revenue2023 }}"
              },
              {
                "action": "replaceAll",
                "text": "[MRR/ARR X]",
                "replaceText": "={{ $json.output.mrrArr2023 }}"
              },
              {
                "action": "replaceAll",
                "text": "[Source Audited/reported]",
                "replaceText": "={{ $json.output.source2023 }}"
              },
              {
                "action": "replaceAll",
                "text": "[RevenueX]",
                "replaceText": "={{ $json.output.revenue2024 }}"
              },
              {
                "action": "replaceAll",
                "text": "[Growth X%]",
                "replaceText": "={{ $json.output.growth2024 }}"
              },
              {
                "action": "replaceAll",
                "text": "[Source Projection/actual]",
                "replaceText": "={{ $json.output.source2024 }}"
              }
            ]
          }
        },
        "type": "n8n-nodes-base.googleDocs",
        "typeVersion": 2,
        "position": [
          2992,
          288
        ],
        "id": "79cb2024-ff91-40f0-be86-ba68c12ccf29",
        "name": "Update Investment Report2",
        "credentials": {
          "googleDocsOAuth2Api": {
            "id": "yhVzCIwJbhQKWmQJ",
            "name": "Google Docs account"
          }
        }
      },
      {
        "parameters": {
          "operation": "copy",
          "fileId": {
            "__rl": true,
            "value": "={{ $json.fileId }}",
            "mode": "id"
          },
          "name": "=Investment Analysis Report-{{$json.companyName}}",
          "options": {}
        },
        "type": "n8n-nodes-base.googleDriveTool",
        "typeVersion": 3,
        "position": [
          2672,
          624
        ],
        "id": "689079ec-c4dc-4c3a-b02a-c51f5d56685b",
        "name": "Use Investment Analysis Report Template",
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "DQWWWj2hk7oMPymA",
            "name": "Google Drive account"
          }
        }
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "extracted-text",
                "name": "File ID",
                "value": "={{ $json.id }}",
                "type": "string"
              },
              {
                "id": "a4357a68-9c99-48c6-b3cd-ea62a11eb01e",
                "name": "text",
                "value": "={{ $json.text }}",
                "type": "string"
              },
              {
                "id": "ef6926a0-e443-4ff8-a4de-dfbe1cc1e02c",
                "name": "Contact Person",
                "value": "={{ $('Form Data').item.json['Contact Person'] }}",
                "type": "string"
              },
              {
                "id": "6d105e4e-d8cb-4ecb-8850-da2db265a91e",
                "name": "Company Name",
                "value": "={{ $('Form Data').item.json['Company Name'] }}",
                "type": "string"
              },
              {
                "id": "e479c193-8228-4813-891a-78f143a9350b",
                "name": "Contact Person's Email Address",
                "value": "={{ $('Form Data').item.json['Contact Person\\'s Email Address'] }}",
                "type": "string"
              },
              {
                "id": "8fb511c6-abe2-4bee-90ae-1f538effd675",
                "name": "submittedAt",
                "value": "={{ $('Form Data').item.json.submittedAt }}",
                "type": "string"
              },
              {
                "id": "4213cf21-51bc-44eb-81ea-b7384f7fcea4",
                "name": "Contact Person LinkedIn Url",
                "value": "={{ $('Form Data').item.json['Founders LinkedIn Url'] }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -752,
          160
        ],
        "id": "78812b3e-ed54-4096-8634-fdeba5043635",
        "name": "Data-Prep"
      },
      {
        "parameters": {
          "multipleMethods": true,
          "httpMethod": [
            "POST"
          ],
          "path": "investment-analyst-agent",
          "options": {
            "allowedOrigins": "*"
          }
        },
        "type": "n8n-nodes-base.webhook",
        "typeVersion": 2,
        "position": [
          -1680,
          -16
        ],
        "id": "47f8bde0-1476-4964-86bf-28f4914b3ecc",
        "name": "Webhook",
        "webhookId": "521bbba0-5e15-410d-9ff8-7661bcd2bfb1",
        "notesInFlow": false
      },
      {
        "parameters": {
          "inputDataFieldName": "Upload_Deal",
          "name": "={{ $json['Upload Deal'][0].filename }}",
          "driveId": {
            "__rl": true,
            "mode": "list",
            "value": "My Drive"
          },
          "folderId": {
            "__rl": true,
            "value": "1b1sPURoqP4PO7KCpxwXubaE9Pij1aXEI",
            "mode": "list",
            "cachedResultName": "Deal-flow-demo",
            "cachedResultUrl": "https://drive.google.com/drive/folders/1b1sPURoqP4PO7KCpxwXubaE9Pij1aXEI"
          },
          "options": {}
        },
        "type": "n8n-nodes-base.googleDrive",
        "typeVersion": 3,
        "position": [
          -1232,
          -16
        ],
        "id": "452a2cc6-2542-4769-ad2d-19f14320dfe1",
        "name": "Upload File",
        "credentials": {
          "googleDriveOAuth2Api": {
            "id": "DQWWWj2hk7oMPymA",
            "name": "Google Drive account"
          }
        }
      },
      {
        "parameters": {
          "operation": "pdf",
          "binaryPropertyName": "Upload_Deal",
          "options": {}
        },
        "type": "n8n-nodes-base.extractFromFile",
        "typeVersion": 1,
        "position": [
          -1232,
          160
        ],
        "id": "afa81cb1-2d83-4da7-b7b4-0acf3395d0ca",
        "name": "Extract Text From PDF"
      },
      {
        "parameters": {
          "formTitle": "Upload Deal",
          "formFields": {
            "values": [
              {
                "fieldLabel": "Upload Deal",
                "fieldType": "file",
                "acceptFileTypes": ".pdf",
                "requiredField": true
              },
              {
                "fieldLabel": "Contact Person"
              },
              {
                "fieldLabel": "Company Name"
              },
              {
                "fieldLabel": "Contact Person's Email Address",
                "fieldType": "email"
              },
              {
                "fieldLabel": "Founders LinkedIn Url"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.formTrigger",
        "typeVersion": 2.2,
        "position": [
          -1664,
          336
        ],
        "id": "39388e1e-cf47-4884-9412-fc33f75b8de4",
        "name": "Upload Deal2",
        "webhookId": "aa163ce1-2e56-4e23-b8cf-84947cd44c5c"
      },
      {
        "parameters": {
          "assignments": {
            "assignments": [
              {
                "id": "45060307-7036-4384-9f44-dcfa6a1e1f36",
                "name": "Contact Person",
                "value": "={{ $json['Contact Person'] }}",
                "type": "string"
              },
              {
                "id": "9d406c7d-f399-4efe-8a63-60318a9ba7eb",
                "name": "Company Name",
                "value": "={{ $json['Company Name'] }}",
                "type": "string"
              },
              {
                "id": "da84067b-3cdd-4ef4-8def-7a76aacfe2c3",
                "name": "Contact Person's Email Address",
                "value": "={{ $json['Contact Person\\'s Email Address'] }}",
                "type": "string"
              },
              {
                "id": "ed5073c1-ce8a-4d47-9a66-6e9f2dc9ea57",
                "name": "Founders LinkedIn Url",
                "value": "={{ $json['Founders LinkedIn Url'] }}",
                "type": "string"
              },
              {
                "id": "31d22324-e054-4605-9623-a77adc11329d",
                "name": "submittedAt",
                "value": "={{ $json.submittedAt }}",
                "type": "string"
              }
            ]
          },
          "options": {}
        },
        "type": "n8n-nodes-base.set",
        "typeVersion": 3.4,
        "position": [
          -1232,
          336
        ],
        "id": "6dc38d6b-9e23-40c7-9164-d30dcc70920e",
        "name": "Form Data"
      },
      {
        "parameters": {
          "sendTo": "={{ $json['IC Team Email Message'].recipient.emailAddresses }}",
          "subject": "={{ $('Prep Emails').item.json['IC Team Email Message'].subject }}",
          "message": "={{ $('Prep Emails').item.json['IC Team Email Message'].message }}",
          "options": {
            "attachmentsUi": {
              "attachmentsBinary": [
                {
                  "property": "=data"
                }
              ]
            }
          }
        },
        "type": "n8n-nodes-base.gmail",
        "typeVersion": 2.1,
        "position": [
          4512,
          528
        ],
        "id": "16813c1f-b93b-405d-8b22-e912cc8d6af4",
        "name": "Send New Deal Assessment Report",
        "webhookId": "f7b58bed-8ec3-43a3-a05e-b17c4029274d",
        "credentials": {
          "gmailOAuth2": {
            "id": "vMzyaTna175lWQkR",
            "name": "Gmail account"
          }
        }
      },
      {
        "parameters": {
          "mode": "combine",
          "combineBy": "combineByPosition",
          "numberInputs": 3,
          "options": {}
        },
        "type": "n8n-nodes-base.merge",
        "typeVersion": 3.2,
        "position": [
          -992,
          144
        ],
        "id": "06eda78b-7ca5-4c2e-814b-1f4b372435d2",
        "name": "Merge1"
      },
      {
        "parameters": {
          "jsCode": "// Universal Pitch Deck Data Extractor - ENHANCED WITH FORM DATA INTEGRATION\n// Works with any business proposal or pitch deck format\n// Enhanced for n8n workflow integration with proper conditional routing\n// Now includes form field values in the output\n\n/**\n * NOTE: This script is intended for n8n Function node environment.\n * It reads from $input.first().json and returns an array of { json } objects.\n * Now processes both PDF extraction data AND form field values.\n */\n\n/* eslint-disable no-useless-escape */\n\n// Extraction logging for debugging\nfunction logExtraction(level, message, context = {}) {\n  const logEntry = {\n    timestamp: new Date().toISOString(),\n    level: level,\n    message: message,\n    context: context\n  };\n  \n  if (level === 'ERROR' || level === 'WARN') {\n    console.warn(`[EXTRACTION ${level}] ${message}`, context);\n  } else {\n    console.log(`[EXTRACTION ${level}] ${message}`, context);\n  }\n  \n  return logEntry;\n}\n\n// Enhanced error handling wrapper\nfunction safeExtract(extractionFunc, funcName, ...args) {\n  try {\n    const result = extractionFunc(...args);\n    logExtraction('DEBUG', `${funcName} completed successfully`);\n    return result;\n  } catch (error) {\n    logExtraction('ERROR', `${funcName} failed`, { error: error.message });\n    // Return appropriate fallback based on expected return type\n    if (funcName.includes('Team')) return { founders: [], ceo: null, cto: null, cmo: null, cfo: null, teamMembers: [] };\n    if (funcName.includes('Contact')) return { primaryEmail: null, primaryPhone: null, primaryLinkedIn: null, website: null, address: {}, additionalResources: {} };\n    if (funcName.includes('Company')) return null;\n    if (funcName.includes('Market')) return { primary: 'Unknown', secondary: null, confidence: 'low', allMatches: [] };\n    return '';\n  }\n}\n\n// Input validation and initialization - ENHANCED FOR FORM DATA\nlet pitchData, pdfText, formData;\n\ntry {\n  const inputData = $input.first().json;\n  \n  // Check if we have form data in the input\n  formData = {\n    uploadDeal: inputData['Upload Deal'] || null,\n    contactPerson: inputData['Contact Person'] || null,\n    companyName: inputData['Company Name'] || null,\n    contactEmail: inputData['Contact Person\\'s Email Address'] || null,\n    foundersLinkedIn: inputData['Founders LinkedIn Url'] || null,\n    submittedAt: inputData['submittedAt'] || null\n  };\n  \n  // Extract PDF data (could be from previous node or embedded in current input)\n  pitchData = inputData.pdfData || inputData; // Fallback to entire input if no pdfData key\n  pdfText = (pitchData && pitchData.text) ? String(pitchData.text) : '';\n  \n  // If no PDF text but we have form data, we can still process\n  if (!pdfText || pdfText.trim().length === 0) {\n    if (formData.companyName) {\n      logExtraction('WARN', 'No PDF text found, but form data available - proceeding with form data only');\n      pdfText = ''; // Empty string for processing\n    } else {\n      logExtraction('ERROR', 'No text content found in input and no form data');\n      throw new Error('No text content or form data available for extraction');\n    }\n  }\n  \n  logExtraction('INFO', 'Input validation successful', { \n    textLength: pdfText.length,\n    hasFormData: !!(formData.companyName || formData.contactPerson),\n    formCompany: formData.companyName,\n    formContact: formData.contactPerson\n  });\n} catch (error) {\n  logExtraction('ERROR', 'Input validation failed', { error: error.message });\n  return [{ \n    json: { \n      error: `Input validation failed: ${error.message}`,\n      companyName: 'Error',\n      formData: formData || {},\n      workflowMetadata: {\n        isProposalComplete: false,\n        completenessScore: 0,\n        error: error.message\n      }\n    } \n  }];\n}\n\n/**\n * Extract content of a section bounded by a start label and next section labels\n * Enhanced with flexible pattern matching\n * @param {string} text - Full deck text\n * @param {string} sectionName - Section header pattern (string or regex source)\n * @param {string} nextSection - Alternation of next possible section headers\n * @returns {string} - Extracted section substring\n */\nfunction extractSection(text, sectionName, nextSection) {\n  try {\n    // Allow nextSection to be optional; default to end of text\n    const boundary = nextSection && nextSection.length > 0 ? nextSection : '$^';\n    \n    // Enhanced pattern that handles various section header formats\n    // Accounts for: \"Business Model\", \"Go-To-Market\", \"Company Overview\", etc.\n    const sectionRegex = new RegExp(\n      '(?:^|\\\\n)\\\\s*(?:â€¢\\\\s*|\\\\d+\\\\.\\\\s*)?(' + sectionName + ')\\\\b[\\\\s\\\\S]*?(?=(?:^|\\\\n)\\\\s*(?:â€¢\\\\s*|\\\\d+\\\\.\\\\s*)?(?:' + boundary + ')|$)', \n      'i'\n    );\n    \n    const match = text.match(sectionRegex);\n    return match ? match[0] : '';\n  } catch (error) {\n    logExtraction('WARN', `Section extraction failed for ${sectionName}`, { error: error.message });\n    return '';\n  }\n}\n\n/**\n * Determine if a section body has meaningful content with tiered thresholds\n * @param {string} sectionText\n * @param {string} sectionType - Type of section for tiered evaluation\n * @returns {boolean}\n */\nfunction hasMeaningfulContent(sectionText, sectionType = 'standard') {\n  if (!sectionText) return false;\n  \n  try {\n    const cleanedText = sectionText\n      // Strip section headers more precisely\n      .replace(/^(?:^|\\\\n)\\\\s*(?:â€¢\\\\s*|\\\\d+\\\\.\\\\s*)?(?:Company\\\\s+)?(?:Overview|Problem|Challenge|Solution|Market|Traction|Business\\\\s+Model|Team|Leadership|Financial|Investment|Contact)\\\\s*$/gim, '')\n      .replace(/\\\\s+/g, ' ')\n      .trim();\n    \n    // Tiered thresholds based on section importance\n    const thresholds = {\n      critical: { minLength: 80, minWords: 12 }, // problem, solution, market\n      important: { minLength: 60, minWords: 10 }, // team, financial\n      standard: { minLength: 40, minWords: 8 },   // overview, traction\n      supplementary: { minLength: 25, minWords: 5 } // contact, investment\n    };\n    \n    const criticalSections = ['problem', 'solution', 'market'];\n    const importantSections = ['team', 'financial'];\n    const supplementarySections = ['contact', 'investment'];\n    \n    let threshold;\n    if (criticalSections.includes(sectionType)) {\n      threshold = thresholds.critical;\n    } else if (importantSections.includes(sectionType)) {\n      threshold = thresholds.important;\n    } else if (supplementarySections.includes(sectionType)) {\n      threshold = thresholds.supplementary;\n    } else {\n      threshold = thresholds.standard;\n    }\n    \n    const hasContent = cleanedText.length >= threshold.minLength;\n    const hasEnoughWords = cleanedText.split(' ').length >= threshold.minWords;\n    const isNotJustPunctuation = /[a-zA-Z0-9]/.test(cleanedText);\n    const hasBusinessContent = /(?:revenue|customer|market|product|team|technology|growth|strategy|solution|problem)/i.test(cleanedText);\n    \n    return hasContent && hasEnoughWords && isNotJustPunctuation && hasBusinessContent;\n  } catch (error) {\n    logExtraction('WARN', `Content evaluation failed`, { error: error.message });\n    return false;\n  }\n}\n\n/**\n * Infer market sector based on keyword frequency\n * @param {string} text\n */\nfunction extractMarketSector(text) {\n  try {\n    const marketSectors = {};\n\n    // Tech sectors\n    marketSectors[\"SaaS\"] = [\"saas\", \"software as a service\", \"cloud software\", \"subscription software\"];\n    marketSectors[\"Enterprise Software\"] = [\"enterprise software\", \"b2b software\", \"business software\", \"enterprise solutions\"];\n    marketSectors[\"FinTech\"] = [\"fintech\", \"financial technology\", \"payments\", \"banking technology\", \"digital banking\", \"cryptocurrency\", \"blockchain\", \"defi\"];\n    marketSectors[\"HealthTech\"] = [\"healthtech\", \"health technology\", \"medical technology\", \"medtech\", \"digital health\", \"telemedicine\", \"healthcare\", \"clinical trials\", \"patient recruitment\", \"clinical research\"];\n    marketSectors[\"EdTech\"] = [\"edtech\", \"education technology\", \"e-learning\", \"online education\", \"educational software\"];\n    marketSectors[\"E-commerce\"] = [\"e-commerce\", \"ecommerce\", \"online retail\", \"marketplace\", \"online shopping\"];\n    marketSectors[\"AIML\"] = [\"artificial intelligence\", \"ai\", \"machine learning\", \"ml\", \"deep learning\", \"neural network\", \"nlp\", \"computer vision\", \"ai-powered\", \"predictive\"];\n    marketSectors[\"Cybersecurity\"] = [\"cybersecurity\", \"security\", \"data protection\", \"network security\", \"information security\", \"infosec\"];\n    marketSectors[\"IoT\"] = [\"iot\", \"internet of things\", \"smart devices\", \"connected devices\", \"smart home\"];\n    marketSectors[\"Biotech\"] = [\"biotech\", \"biotechnology\", \"life sciences\", \"pharmaceuticals\", \"drug discovery\", \"genomics\", \"pharma\"];\n\n    // Clean and green tech\n    marketSectors[\"CleanTech\"] = [\"cleantech\", \"clean technology\", \"renewable energy\", \"sustainability\", \"green technology\", \"solar\", \"wind energy\"];\n    marketSectors[\"AgTech\"] = [\"agtech\", \"agriculture technology\", \"farming technology\", \"precision agriculture\", \"agritech\"];\n\n    // Property and finance\n    marketSectors[\"PropTech\"] = [\"proptech\", \"property technology\", \"real estate technology\", \"realestate tech\", \"construction tech\"];\n    marketSectors[\"InsurTech\"] = [\"insurtech\", \"insurance technology\", \"digital insurance\"];\n    marketSectors[\"LegalTech\"] = [\"legaltech\", \"legal technology\", \"law technology\", \"legal software\"];\n    marketSectors[\"Regtech\"] = [\"regtech\", \"regulatory technology\", \"compliance technology\", \"compliance platform\"];\n    marketSectors[\"Wealthtech\"] = [\"wealthtech\", \"wealth management\", \"investment platform\", \"robo-advisor\", \"personal finance\"];\n\n    // Business operations\n    marketSectors[\"HRTech\"] = [\"hrtech\", \"hr technology\", \"human resources\", \"recruitment technology\", \"talent management\"];\n    marketSectors[\"MarTech\"] = [\"martech\", \"marketing technology\", \"adtech\", \"advertising technology\", \"digital marketing\"];\n    marketSectors[\"Sales Tech\"] = [\"sales technology\", \"salestech\", \"crm\", \"sales automation\", \"sales enablement\", \"revenue operations\", \"revenue intelligence\"];\n    marketSectors[\"Customer Service\"] = [\"customer service\", \"customer support\", \"help desk\", \"customer experience\", \"cx platform\"];\n    marketSectors[\"Collaboration Tools\"] = [\"collaboration\", \"team collaboration\", \"productivity tools\", \"project management\", \"workflow\"];\n\n    // Logistics and commerce\n    marketSectors[\"Logistics\"] = [\"logistics\", \"supply chain\", \"transportation\", \"delivery\", \"shipping\", \"freight\"];\n    marketSectors[\"B2B Marketplace\"] = [\"b2b marketplace\", \"business marketplace\", \"wholesale platform\"];\n    marketSectors[\"B2C Marketplace\"] = [\"b2c marketplace\", \"consumer marketplace\", \"retail marketplace\"];\n    marketSectors[\"Retail Tech\"] = [\"retail technology\", \"retailtech\", \"point of sale\", \"pos\", \"inventory management\"];\n\n    // Consumer sectors\n    marketSectors[\"Gaming\"] = [\"gaming\", \"video games\", \"mobile games\", \"game development\", \"esports\"];\n    marketSectors[\"Social Media\"] = [\"social media\", \"social network\", \"social platform\", \"community platform\"];\n    marketSectors[\"Travel Tech\"] = [\"travel technology\", \"traveltech\", \"hospitality tech\", \"tourism technology\", \"booking platform\"];\n    marketSectors[\"FoodTech\"] = [\"foodtech\", \"food technology\", \"food delivery\", \"restaurant technology\", \"meal delivery\"];\n    marketSectors[\"Restaurant Tech\"] = [\"restaurant technology\", \"restaurant management\", \"pos system\", \"quickserve\", \"dining\"];\n    marketSectors[\"Fashion Tech\"] = [\"fashion technology\", \"fashiontech\", \"apparel tech\", \"fashion commerce\"];\n    marketSectors[\"Beauty Tech\"] = [\"beauty technology\", \"beautytech\", \"cosmetics tech\"];\n    marketSectors[\"Sports Tech\"] = [\"sports technology\", \"sportstech\", \"fitness tech\", \"athletic performance\"];\n    marketSectors[\"Mental Health\"] = [\"mental health\", \"wellness\", \"meditation\", \"therapy platform\", \"behavioral health\"];\n\n    // Emerging tech\n    marketSectors[\"Automotive\"] = [\"automotive\", \"autonomous vehicles\", \"electric vehicles\", \"ev\", \"mobility\", \"transportation\"];\n    marketSectors[\"Telecom\"] = [\"telecommunications\", \"telecom\", \"wireless\", \"networking\"];\n    marketSectors[\"MediaEntertainment\"] = [\"media\", \"entertainment\", \"streaming\", \"content platform\", \"digital media\"];\n    marketSectors[\"Data Analytics\"] = [\"data analytics\", \"big data\", \"business intelligence\", \"data science\", \"analytics platform\"];\n    marketSectors[\"DevOps\"] = [\"devops\", \"developer tools\", \"development tools\", \"infrastructure\"];\n    marketSectors[\"APIIntegration\"] = [\"api\", \"integration platform\", \"ipaas\", \"middleware\", \"api management\"];\n    marketSectors[\"Robotics\"] = [\"robotics\", \"automation\", \"rpa\", \"robotic process automation\", \"industrial automation\"];\n    marketSectors[\"ARVR\"] = [\"augmented reality\", \"ar\", \"virtual reality\", \"vr\", \"mixed reality\", \"metaverse\"];\n    marketSectors[\"Quantum Computing\"] = [\"quantum computing\", \"quantum technology\", \"quantum software\"];\n    marketSectors[\"Space Tech\"] = [\"space technology\", \"spacetech\", \"satellite\", \"aerospace\"];\n\n    // Medical specific\n    marketSectors[\"Clinical Trials\"] = [\"clinical trials\", \"clinical research\", \"patient recruitment\", \"trial management\", \"drug development\"];\n    marketSectors[\"Medical Devices\"] = [\"medical devices\", \"medical equipment\", \"diagnostic devices\", \"therapeutic devices\"];\n\n    const sectorScores = {};\n    const lowerText = text.toLowerCase();\n\n    for (const [sector, keywords] of Object.entries(marketSectors)) {\n      let score = 0;\n      const matches = [];\n      for (const keyword of keywords) {\n        const regex = new RegExp(`\\\\b${keyword.replace(/[.*+?^${}()|[\\\\]\\\\\\\\]/g, '\\\\\\\\$&')}\\\\b`, 'gi');\n        const keywordMatches = lowerText.match(regex);\n        if (keywordMatches) {\n          score += keywordMatches.length;\n          matches.push(keyword);\n        }\n      }\n      if (score > 0) sectorScores[sector] = { score, matches };\n    }\n\n    const sortedSectors = Object.entries(sectorScores).sort((a, b) => b[1].score - a[1].score);\n    const primary = sortedSectors[0] ? sortedSectors[0][0] : 'Unknown';\n    const secondary = sortedSectors[1] ? sortedSectors[1][0] : null;\n    const confidence = sortedSectors[0] && sortedSectors[0][1].score > 5 ? 'high' : (sortedSectors[0] && sortedSectors[0][1].score > 2 ? 'medium' : 'low');\n\n    return {\n      primary,\n      secondary,\n      allMatches: sortedSectors.map(([sector, info]) => ({ sector, score: info.score, keywords: info.matches })),\n      confidence,\n    };\n  } catch (error) {\n    logExtraction('ERROR', 'Market sector extraction failed', { error: error.message });\n    return { primary: 'Unknown', secondary: null, confidence: 'low', allMatches: [] };\n  }\n}\n\n/**\n * Extract company details with enhanced financial pattern matching\n * @param {string} text\n */\nfunction extractCompanyDetails(text) {\n  try {\n    const details = {\n      foundingDate: null,\n      headquarters: null,\n      stage: null,\n      currentARR: null,\n      fundingRequest: null,\n      valuation: null,\n      previousFunding: [],\n      keyMetrics: {\n        mrr: null,\n        nrr: null,\n        grossMargin: null,\n        ltv: null,\n        cac: null,\n        ltvCacRatio: null,\n        customerCount: null,\n        logoRetention: null,\n        npsScore: null,\n      },\n    };\n    \n    // Enhanced founding date patterns\n    const foundingPatterns = [\n      /(?:Founding Date|Founded|Established|Started)[\\s:]*([A-Za-z]+\\s+\\d{4}|\\d{4})/i,\n      /(?:Company\\s+)?(?:founded|established|started)\\s+(?:in\\s+)?(\\d{4})/i\n    ];\n    for (const pattern of foundingPatterns) {\n      const match = text.match(pattern);\n      if (match) {\n        details.foundingDate = match[1].trim();\n        break;\n      }\n    }\n    \n    // Enhanced headquarters patterns\n    const hqPatterns = [\n      /(?:Headquarters|HQ|Based in|Located in)[\\s:]*([A-Za-z\\s]+,\\s*[A-Z]{2})/i,\n      /(?:Headquarters|HQ|Based in|Located in)[\\s:]*([A-Za-z\\s]+)/i\n    ];\n    for (const pattern of hqPatterns) {\n      const match = text.match(pattern);\n      if (match) {\n        details.headquarters = match[1].trim();\n        break;\n      }\n    }\n    \n    // Enhanced stage patterns\n    const stagePatterns = [\n      /(?:Stage|Round|Funding\\s+Stage)[\\s:]*(?:Series\\s+)?([A-Z]|Seed|Pre-Seed|Pre\\s+Seed)/i,\n      /(?:Series\\s+([A-Z])|Seed|Pre-Seed)\\s+(?:round|funding|stage)/i\n    ];\n    for (const pattern of stagePatterns) {\n      const match = text.match(pattern);\n      if (match) {\n        const stage = match[1];\n        details.stage = stage && stage.length === 1 ? `Series ${stage}` : stage;\n        break;\n      }\n    }\n    \n    // Enhanced ARR patterns\n    const arrPatterns = [\n      /(?:Current\\s+)?(?:Annual\\s+Recurring\\s+Revenue|ARR)[\\s:]*\\$?([\\d.]+)\\s*([MBK])/i,\n      /ARR[\\s:]*\\$?([\\d.]+)\\s*([MBK]?)/i,\n      /\\$?([\\d.]+)\\s*([MBK])\\s+ARR/i\n    ];\n    for (const pattern of arrPatterns) {\n      const match = text.match(pattern);\n      if (match) {\n        const value = match[1];\n        const unit = match[2] || '';\n        details.currentARR = `$${value}${unit}`;\n        break;\n      }\n    }\n    \n    // Enhanced funding request patterns\n    const fundingPatterns = [\n      /(?:Seeking|Raising|Looking for)\\s*\\$?([\\d.]+)\\s*(Million|M|K|Thousand)/i,\n      /\\$?([\\d.]+)\\s*(Million|M)\\s+(?:Series\\s+[A-Z]|funding|investment)/i,\n      /(?:Series\\s+[A-Z])\\s*[:\\s]*\\$?([\\d.]+)\\s*(Million|M)/i\n    ];\n    for (const pattern of fundingPatterns) {\n      const match = text.match(pattern);\n      if (match) {\n        const value = match[1];\n        const unit = match[2].replace(/Million/, 'M').replace(/Thousand/, 'K');\n        details.fundingRequest = `$${value}${unit}`;\n        break;\n      }\n    }\n    \n    // Enhanced valuation patterns\n    const valuationPatterns = [\n      /(?:Pre-Money\\s+|Post-Money\\s+)?(?:Valuation|Valued at)[\\s:]*\\$?([\\d.]+)\\s*(Million|M|Billion|B)/i,\n      /\\$?([\\d.]+)\\s*(Million|M|Billion|B)\\s+(?:valuation|value)/i\n    ];\n    for (const pattern of valuationPatterns) {\n      const match = text.match(pattern);\n      if (match) {\n        const value = match[1];\n        const unit = match[2].replace(/Million/, 'M').replace(/Billion/, 'B');\n        details.valuation = `$${value}${unit}`;\n        break;\n      }\n    }\n    \n    // Enhanced metrics patterns\n    const metricsPatterns = {\n      mrr: [\n        /(?:Monthly\\s+Recurring\\s+Revenue|MRR)[\\s:]*\\$?([\\d,]+)/i,\n        /MRR\\s+(?:Growth|Rate)[\\s:]*(\\d+%)/i\n      ],\n      nrr: [\n        /(?:Net\\s+Revenue\\s+Retention|NRR)[\\s:]*(\\d+%)/i,\n        /(?:Revenue\\s+Retention|NRR)[\\s:]*(\\d+%)/i\n      ],\n      grossMargin: [\n        /(?:Gross\\s+)?Margin[\\s:]*(\\d+%)/i,\n        /(\\d+)%\\s+(?:gross\\s+)?margin/i\n      ],\n      ltv: [\n        /(?:Customer\\s+)?(?:Lifetime\\s+Value|LTV)[\\s:]*\\$?([\\d,]+)/i,\n        /LTV[\\s:]*\\$?([\\d,]+)/i\n      ],\n      cac: [\n        /(?:Customer\\s+Acquisition\\s+Cost|CAC)[\\s:]*\\$?([\\d,]+)/i,\n        /CAC[\\s:]*\\$?([\\d,]+)/i\n      ],\n      ltvCacRatio: [\n        /(?:LTV\\/CAC|LTV:CAC)\\s+(?:Ratio[\\s:]*)?(\\d+\\.?\\d*x?)/i,\n        /(\\d+\\.?\\d*)x?\\s+LTV\\/CAC/i\n      ],\n      customerCount: [\n        /(?:Total\\s+)?(?:Customers|Customer\\s+Count)[\\s:]*(\\d+)/i,\n        /(\\d+)\\s+(?:paying\\s+)?customers/i\n      ],\n      logoRetention: [\n        /(?:Logo\\s+Retention|Customer\\s+Retention)[\\s:]*(\\d+%)/i,\n        /(\\d+)%\\s+(?:logo\\s+)?retention/i\n      ],\n      npsScore: [\n        /(?:NPS|Net\\s+Promoter\\s+Score)[\\s:]*(\\d+)/i,\n        /(\\d+)\\s+NPS/i\n      ],\n    };\n    \n    for (const [key, patterns] of Object.entries(metricsPatterns)) {\n      for (const pattern of patterns) {\n        const match = text.match(pattern);\n        if (match) {\n          details.keyMetrics[key] = match[1];\n          break;\n        }\n      }\n    }\n    \n    return details;\n  } catch (error) {\n    logExtraction('ERROR', 'Company details extraction failed', { error: error.message });\n    return {\n      foundingDate: null, headquarters: null, stage: null, currentARR: null,\n      fundingRequest: null, valuation: null, previousFunding: [],\n      keyMetrics: { mrr: null, nrr: null, grossMargin: null, ltv: null, cac: null, ltvCacRatio: null, customerCount: null, logoRetention: null, npsScore: null }\n    };\n  }\n}\n\n/**\n * Extract company name with enhanced heuristics\n * @param {string} text\n * @returns {string|null}\n */\nfunction extractCompanyName(text) {\n  try {\n    const patterns = [\n      // Explicit company name labels\n      /(?:Company\\s+Name|Business\\s+Name)[\\s:]+([A-Z][A-Za-z0-9\\s&.,-]+?)(?:\\s+(?:Founding|Founded|Inc|LLC)|\\n)/i,\n      // Title-style company names at start of lines\n      /^([A-Z][A-Za-z0-9]+(?:\\s+[A-Z][A-Za-z0-9]+)*(?:\\s+(?:AI|Tech|Labs|Inc|LLC))?)\\s*$/m,\n      // Company name with legal entity\n      /^([A-Z][A-Za-z0-9\\s&.,-]+,?\\s+(?:Inc|LLC|Ltd|Corp|Corporation)\\.?)(?:\\s|$)/m,\n      // Company name before pitch/deck keywords\n      /^([A-Z][A-Za-z0-9]+(?:\\s+[A-Z][A-Za-z0-9]+)*)\\s+(?:Series|Funding|Deck|Pitch|Proposal)/im,\n      // Company name in headers or titles\n      /^([A-Z][A-Za-z0-9]+(?:\\s+[A-Z][A-Za-z0-9]+){0,3})\\s*(?:\\n|Pitch|Deck|Proposal)/im\n    ];\n    \n    for (const pattern of patterns) {\n      const match = text.match(pattern);\n      if (match && match[1]) {\n        const name = match[1]\n          .trim()\n          .replace(/\\s+/g, ' ')\n          .replace(/,?\\s*(Inc|LLC|Ltd|Corp|Corporation)\\.?$/i, '');\n        \n        // Validate name quality\n        if (name.length > 2 && name.length < 50 && !/^(the|and|or|but|for|with|by)$/i.test(name)) {\n          return name;\n        }\n      }\n    }\n    return null;\n  } catch (error) {\n    logExtraction('WARN', 'Company name extraction failed', { error: error.message });\n    return null;\n  }\n}\n\n/**\n * Extract team members with simplified, more reliable patterns\n * @param {string} text\n */\nfunction extractTeamMembers(text) {\n  try {\n    const team = {\n      founders: [],\n      ceo: null,\n      cto: null,\n      cmo: null,\n      cfo: null,\n      teamMembers: [],\n    };\n    \n    // Simplified, more reliable pattern for name-role extraction\n    const teamPattern = /(?:Dr\\.?\\s+)?([A-Z][a-z]+(?:\\s+[A-Z]\\.?\\s*)?[A-Z][a-z]+)[\\s,]*[-â€“â€”:]*\\s*(CEO|CTO|CFO|CMO|COO|CBO|CPO|CSO|Co-Founder|Founder|Chief\\s+\\w+\\s+Officer|VP\\s+(?:of\\s+)?\\w+|Head\\s+of\\s+\\w+|President|Director)/gi;\n    \n    const uniqueMatches = new Map();\n    const matches = [...text.matchAll(teamPattern)];\n    \n    for (const match of matches) {\n      const name = match[1].replace(/^Dr\\.?\\s+/, '').trim();\n      const role = match[2].trim();\n      \n      // Validate name format\n      if (name && role && name.split(' ').length >= 2 && !uniqueMatches.has(name)) {\n        uniqueMatches.set(name, role);\n      }\n    }\n\n    // Process each unique team member\n    for (const [name, role] of uniqueMatches) {\n      const teamMember = { name, role, email: null, phone: null, linkedin: null };\n      \n      // Look for contact info near the name\n      const nameIndex = text.indexOf(name);\n      if (nameIndex > -1) {\n        const contextStart = Math.max(0, nameIndex - 200);\n        const contextEnd = Math.min(text.length, nameIndex + 500);\n        const nearbyText = text.substring(contextStart, contextEnd);\n        \n        // Extract contact information\n        const emailMatch = nearbyText.match(/([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,})/);\n        if (emailMatch) teamMember.email = emailMatch[1];\n        \n        const phoneMatch = nearbyText.match(/(\\(?\\d{3}\\)?[\\s.-]?\\d{3}[\\s.-]?\\d{4})/);\n        if (phoneMatch) teamMember.phone = phoneMatch[1];\n        \n        const liMatch = nearbyText.match(/linkedin\\.com\\/in\\/([a-zA-Z0-9-]+)/i);\n        if (liMatch) teamMember.linkedin = `linkedin.com/in/${liMatch[1]}`;\n      }\n\n      team.teamMembers.push(teamMember);\n\n      // Assign to specific roles\n      const roleLower = role.toLowerCase();\n      if (roleLower.includes('ceo') && !team.ceo) team.ceo = name;\n      if (roleLower.includes('cto') && !team.cto) team.cto = name;\n      if (roleLower.includes('cmo') && !team.cmo) team.cmo = name;\n      if (roleLower.includes('cfo') && !team.cfo) team.cfo = name;\n      if (roleLower.includes('founder') && !team.founders.includes(name)) team.founders.push(name);\n    }\n    \n    return team;\n  } catch (error) {\n    logExtraction('ERROR', 'Team member extraction failed', { error: error.message });\n    return { founders: [], ceo: null, cto: null, cmo: null, cfo: null, teamMembers: [] };\n  }\n}\n\n/**\n * Extract general contact info with enhanced patterns\n * @param {string} text\n */\nfunction extractContactInfo(text) {\n  try {\n    const contactInfo = {\n      primaryEmail: null,\n      primaryPhone: null,\n      primaryLinkedIn: null,\n      website: null,\n      address: { street: null, suite: null, city: null, state: null, zip: null, full: null },\n      additionalResources: {},\n    };\n\n    // Enhanced email pattern\n    const emailPatterns = [\n      /(?:Email|Contact|E-mail)[\\s:]*([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,})/i,\n      /([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,})/\n    ];\n    for (const pattern of emailPatterns) {\n      const match = text.match(pattern);\n      if (match) {\n        contactInfo.primaryEmail = match[1];\n        break;\n      }\n    }\n\n    // Enhanced phone pattern\n    const phonePatterns = [\n      /(?:Phone|Tel|Call)[\\s:]*(\\(?\\d{3}\\)?[\\s.-]?\\d{3}[\\s.-]?\\d{4})/i,\n      /(\\(?\\d{3}\\)?[\\s.-]?\\d{3}[\\s.-]?\\d{4})/\n    ];\n    for (const pattern of phonePatterns) {\n      const match = text.match(pattern);\n      if (match) {\n        contactInfo.primaryPhone = match[1];\n        break;\n      }\n    }\n\n    // Enhanced LinkedIn pattern\n    const liPatterns = [\n      /(?:LinkedIn|Connect)[\\s:]*(?:https?:\\/\\/)?(?:www\\.)?linkedin\\.com\\/in\\/([a-zA-Z0-9-]+)/i,\n      /(?:https?:\\/\\/)?(?:www\\.)?linkedin\\.com\\/in\\/([a-zA-Z0-9-]+)/i\n    ];\n    for (const pattern of liPatterns) {\n      const match = text.match(pattern);\n      if (match) {\n        contactInfo.primaryLinkedIn = `linkedin.com/in/${match[1]}`;\n        break;\n      }\n    }\n\n    // Enhanced website pattern\n    const websitePatterns = [\n      /(?:Website|Web|URL|Site)[\\s:]*(?:https?:\\/\\/)?([a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}(?:\\/[^\\s]*)?)/i,\n      /(?:https?:\\/\\/)?([a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}(?:\\/[^\\s]*)?)/\n    ];\n    for (const pattern of websitePatterns) {\n      const match = text.match(pattern);\n      if (match && !match[1].includes('@') && !match[1].includes('linkedin')) {\n        contactInfo.website = match[1];\n        break;\n      }\n    }\n\n    // Enhanced address pattern\n    const addressPatterns = [\n      /(\\d+[^,\\n]+(?:Drive|Street|Avenue|Road|Boulevard|Lane|Way|Place|Court|Park))[,\\s]+(?:Suite\\s+(\\d+))?[,\\s]*([A-Za-z\\s]+)[,\\s]+([A-Z]{2})\\s+(\\d{5}(?:-\\d{4})?)/i,\n      /(?:Address|Located)[\\s:]*(\\d+[^,\\n]+(?:Drive|Street|Avenue|Road|Boulevard|Lane|Way|Place|Court|Park))[,\\s]+([A-Za-z\\s]+)[,\\s]+([A-Z]{2})\\s+(\\d{5})/i\n    ];\n    for (const pattern of addressPatterns) {\n      const match = text.match(pattern);\n      if (match) {\n        contactInfo.address.street = match[1].trim();\n        contactInfo.address.suite = match[2] ? `Suite ${match[2]}` : null;\n        contactInfo.address.city = (match[3] || match[2]).trim();\n        contactInfo.address.state = match[4] || match[3];\n        contactInfo.address.zip = match[5] || match[4];\n        contactInfo.address.full = `${contactInfo.address.street}${contactInfo.address.suite ? ', ' + contactInfo.address.suite : ''}, ${contactInfo.address.city}, ${contactInfo.address.state} ${contactInfo.address.zip}`;\n        break;\n      }\n    }\n    \n    // Enhanced resource patterns\n    const resourcePatterns = [\n      { pattern: /(?:Investor\\s+(?:Data\\s+)?(?:Room|Deck))[\\s:]*([a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}(?:\\/[^\\s]*)?)/i, key: 'investorResources' },\n      { pattern: /(?:Product\\s+)?Demo[\\s:]*([a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}(?:\\/[^\\s]*)?)/i, key: 'productDemo' },\n      { pattern: /(?:Case\\s+Studies|Success\\s+Stories|Customer\\s+References)[\\s:]*([a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}(?:\\/[^\\s]*)?)/i, key: 'caseStudies' }\n    ];\n    \n    for (const { pattern, key } of resourcePatterns) {\n      const match = text.match(pattern);\n      if (match && match[1]) {\n        contactInfo.additionalResources[key] = match[1];\n      }\n    }\n    \n    return contactInfo;\n  } catch (error) {\n    logExtraction('ERROR', 'Contact info extraction failed', { error: error.message });\n    return {\n      primaryEmail: null, primaryPhone: null, primaryLinkedIn: null, website: null,\n      address: { street: null, suite: null, city: null, state: null, zip: null, full: null },\n      additionalResources: {}\n    };\n  }\n}\n\n// Process PDF text only if available\nlet sections = {};\nlet sectionCompleteness = {};\nlet completenessScore = 0;\nlet isComplete = false;\n\nif (pdfText && pdfText.trim().length > 0) {\n  // Extract key sections with error handling\n  sections = {\n    overview: safeExtract(extractSection, 'extractSection-overview', pdfText, 'Company Overview|Overview', 'Problem|Challenge'),\n    problem: safeExtract(extractSection, 'extractSection-problem', pdfText, '(?:Problem|Challenge|Pain Points)', 'Solution'),\n    solution: safeExtract(extractSection, 'extractSection-solution', pdfText, 'Solution', 'Market|Traction'),\n    market: safeExtract(extractSection, 'extractSection-market', pdfText, 'Market', 'Traction|Revenue|Business Model'),\n    traction: safeExtract(extractSection, 'extractSection-traction', pdfText, 'Traction', 'Business Model|Financial|Team'),\n    businessModel: safeExtract(extractSection, 'extractSection-businessModel', pdfText, 'Business Model', 'Team|Financial|Leadership'),\n    team: safeExtract(extractSection, 'extractSection-team', pdfText, '(?:Team|Leadership)', 'Financial|Investment|Contact'),\n    financial: safeExtract(extractSection, 'extractSection-financial', pdfText, 'Financial', 'Investment|Series|Contact'),\n    investment: safeExtract(extractSection, 'extractSection-investment', pdfText, '(?:Investment|Series)', 'Contact|Risk|Use of Funds'),\n    contact: safeExtract(extractSection, 'extractSection-contact', pdfText, 'Contact', 'This document|Disclaimer|Appendix|Thank you|$^'),\n  };\n\n  // Section completeness with tiered evaluation\n  sectionCompleteness = {\n    overview: hasMeaningfulContent(sections.overview, 'standard'),\n    problem: hasMeaningfulContent(sections.problem, 'critical'),\n    solution: hasMeaningfulContent(sections.solution, 'critical'),\n    market: hasMeaningfulContent(sections.market, 'critical'),\n    traction: hasMeaningfulContent(sections.traction, 'standard'),\n    businessModel: hasMeaningfulContent(sections.businessModel, 'standard'),\n    team: hasMeaningfulContent(sections.team, 'important'),\n    financial: hasMeaningfulContent(sections.financial, 'important'),\n    investment: hasMeaningfulContent(sections.investment, 'supplementary'),\n    contact: hasMeaningfulContent(sections.contact, 'supplementary'),\n  };\n\n  // Enhanced completeness scoring\n  const requiredSections = ['problem', 'solution', 'market', 'team', 'financial'];\n  const presentRequiredSections = requiredSections.filter(section => sectionCompleteness[section]);\n  completenessScore = (presentRequiredSections.length / requiredSections.length) * 100;\n  isComplete = completenessScore >= 80; // Require at least 4 out of 5 sections (80%)\n\n  logExtraction('INFO', 'Section extraction completed', {\n    sectionsFound: Object.values(sectionCompleteness).filter(Boolean).length,\n    completenessScore: completenessScore.toFixed(1) + '%',\n    isComplete\n  });\n\n  // Normalize sections: never null/undefined for downstream checks\n  Object.keys(sections).forEach(key => { \n    if (!sections[key]) sections[key] = ''; \n  });\n} else {\n  // No PDF text available - set defaults\n  sections = {\n    overview: '', problem: '', solution: '', market: '', traction: '',\n    businessModel: '', team: '', financial: '', investment: '', contact: ''\n  };\n  sectionCompleteness = {\n    overview: false, problem: false, solution: false, market: false, traction: false,\n    businessModel: false, team: false, financial: false, investment: false, contact: false\n  };\n}\n\n// Enhanced company name extraction with form data priority\nlet companyName = formData.companyName; // Priority to form data\n\nif (!companyName && pdfText) {\n  companyName = safeExtract(extractCompanyName, 'extractCompanyName-start', pdfText.substring(0, 1000)) || \n                safeExtract(extractCompanyName, 'extractCompanyName-overview', sections.overview) || \n                safeExtract(extractCompanyName, 'extractCompanyName-full', pdfText);\n}\n\nif (!companyName && pitchData && pitchData.name) {\n  companyName = String(pitchData.name)\n    .replace(/\\.pdf$/i, '')\n    .replace(/pitch[\\s_-]?deck/gi, '')\n    .replace(/proposal/gi, '')\n    .replace(/[_-]/g, ' ')\n    .trim();\n}\ncompanyName = companyName || 'Unknown Company';\n\n// Extract derived entities with error handling (only if PDF text available)\nlet teamInfo, marketSectorInfo, contactInfo, companyDetails;\n\nif (pdfText && pdfText.trim().length > 0) {\n  teamInfo = safeExtract(extractTeamMembers, 'extractTeamMembers', pdfText);\n  marketSectorInfo = safeExtract(extractMarketSector, 'extractMarketSector', pdfText);\n  contactInfo = safeExtract(extractContactInfo, 'extractContactInfo', sections.contact || pdfText);\n  companyDetails = safeExtract(extractCompanyDetails, 'extractCompanyDetails', pdfText);\n} else {\n  // Fallback defaults when no PDF text\n  teamInfo = { founders: [], ceo: null, cto: null, cmo: null, cfo: null, teamMembers: [] };\n  marketSectorInfo = { primary: 'Unknown', secondary: null, confidence: 'low', allMatches: [] };\n  contactInfo = { \n    primaryEmail: null, primaryPhone: null, primaryLinkedIn: null, website: null, \n    address: {}, additionalResources: {} \n  };\n  companyDetails = {\n    foundingDate: null, headquarters: null, stage: null, currentARR: null,\n    fundingRequest: null, valuation: null, previousFunding: [],\n    keyMetrics: { mrr: null, nrr: null, grossMargin: null, ltv: null, cac: null, ltvCacRatio: null, customerCount: null, logoRetention: null, npsScore: null }\n  };\n}\n\n// ENHANCE WITH FORM DATA - Override/supplement extracted data with form values\nif (formData.contactEmail) {\n  contactInfo.primaryEmail = formData.contactEmail;\n}\n\nif (formData.foundersLinkedIn) {\n  contactInfo.primaryLinkedIn = formData.foundersLinkedIn;\n  // Also add to founder info if we found founders\n  if (teamInfo.founders.length > 0) {\n    const founderMember = teamInfo.teamMembers.find(m => m.name === teamInfo.founders[0]);\n    if (founderMember) {\n      founderMember.linkedin = formData.foundersLinkedIn;\n    }\n  }\n}\n\n// Extract filename information if available\nlet uploadedFileInfo = null;\nif (formData.uploadDeal && Array.isArray(formData.uploadDeal) && formData.uploadDeal.length > 0) {\n  uploadedFileInfo = {\n    filename: formData.uploadDeal[0].filename || 'Unknown',\n    mimetype: formData.uploadDeal[0].mimetype || 'Unknown',\n    size: formData.uploadDeal[0].size || 0\n  };\n}\n\nlogExtraction('INFO', 'Data extraction completed', {\n  companyName,\n  teamMembersFound: teamInfo.teamMembers.length,\n  marketSector: marketSectorInfo.primary,\n  foundersFound: teamInfo.founders.length,\n  hasFormData: !!(formData.contactPerson || formData.companyName),\n  formDataUsed: {\n    companyName: !!formData.companyName,\n    contactEmail: !!formData.contactEmail,\n    foundersLinkedIn: !!formData.foundersLinkedIn\n  }\n});\n\n// Final structured output for n8n routing - ENHANCED WITH FORM DATA\nconst output = {\n  companyName,\n  \n  // FORM DATA INTEGRATION - Top-level form fields\n  formData: {\n    contactPerson: formData.contactPerson,\n    companyName: formData.companyName,\n    contactEmail: formData.contactEmail,\n    foundersLinkedIn: formData.foundersLinkedIn,\n    submittedAt: formData.submittedAt,\n    uploadedFile: uploadedFileInfo\n  },\n  \n  // Primary founder information (prioritizing form data)\n  founderName: formData.contactPerson || teamInfo.ceo || teamInfo.founders[0] || 'Not found',\n  founderEmail: formData.contactEmail || teamInfo.teamMembers.find(m => m.name === teamInfo.ceo)?.email || contactInfo.primaryEmail || null,\n  founderPhone: teamInfo.teamMembers.find(m => m.name === teamInfo.ceo)?.phone || contactInfo.primaryPhone || null,\n  founderLinkedIn: formData.foundersLinkedIn || teamInfo.teamMembers.find(m => m.name === teamInfo.ceo)?.linkedin || contactInfo.primaryLinkedIn || null,\n  \n  // Co-founder information\n  cofounderName: teamInfo.cto || teamInfo.founders[1] || 'Not found',\n  cofounderEmail: teamInfo.teamMembers.find(m => m.name === teamInfo.cto)?.email || null,\n  cofounderPhone: teamInfo.teamMembers.find(m => m.name === teamInfo.cto)?.phone || null,\n  cofounderLinkedIn: teamInfo.teamMembers.find(m => m.name === teamInfo.cto)?.linkedin || null,\n  \n  // Lists and detailed information\n  allFounders: teamInfo.founders,\n  \n  marketSector: {\n    primary: marketSectorInfo.primary,\n    secondary: marketSectorInfo.secondary,\n    confidence: marketSectorInfo.confidence,\n    allDetected: marketSectorInfo.allMatches.slice(0, 5),\n  },\n  \n  companyContact: {\n    email: formData.contactEmail || contactInfo.primaryEmail,\n    phone: contactInfo.primaryPhone,\n    linkedin: formData.foundersLinkedIn || contactInfo.primaryLinkedIn,\n    website: contactInfo.website,\n    address: contactInfo.address,\n    additionalResources: contactInfo.additionalResources,\n  },\n  \n  companyDetails: {\n    foundingDate: companyDetails.foundingDate,\n    headquarters: companyDetails.headquarters,\n    stage: companyDetails.stage,\n    currentARR: companyDetails.currentARR,\n    fundingRequest: companyDetails.fundingRequest,\n    valuation: companyDetails.valuation,\n    previousFunding: companyDetails.previousFunding,\n    keyMetrics: companyDetails.keyMetrics,\n  },\n  \n  teamInfo: {\n    ceo: teamInfo.ceo,\n    cto: teamInfo.cto,\n    cmo: teamInfo.cmo,\n    cfo: teamInfo.cfo,\n    allFounders: teamInfo.founders,\n    teamMembers: teamInfo.teamMembers,\n  },\n  \n  rawExtraction: {\n    sections,\n    sectionCompleteness,\n    completenessScore,\n    isComplete,\n  },\n\n  workflowMetadata: {\n    isProposalComplete: isComplete,\n    completenessScore,\n    missingRequiredSections: pdfText ? ['problem', 'solution', 'market', 'team', 'financial'].filter(s => !sectionCompleteness[s]) : ['No PDF processed'],\n    presentRequiredSections: pdfText ? ['problem', 'solution', 'market', 'team', 'financial'].filter(s => sectionCompleteness[s]) : [],\n    totalSectionsFound: Object.values(sectionCompleteness).filter(Boolean).length,\n    totalSectionsPossible: Object.keys(sectionCompleteness).length,\n    hasFormData: !!(formData.contactPerson || formData.companyName),\n    hasPdfData: !!(pdfText && pdfText.trim().length > 0),\n    dataSource: pdfText && pdfText.trim().length > 0 ? 'PDF + Form' : 'Form Only',\n  },\n  \n  metadata: {\n    filename: uploadedFileInfo ? uploadedFileInfo.filename : ((pitchData && pitchData.name) || 'Unknown'),\n    extractionTimestamp: new Date().toISOString(),\n    sectorsDetected: marketSectorInfo.allMatches.length,\n    teamMembersFound: teamInfo.teamMembers.length,\n    foundersIdentified: teamInfo.founders.length,\n    confidenceLevel: marketSectorInfo.confidence,\n    proposalStatus: isComplete ? 'complete' : 'incomplete',\n    completenessPercentage: `${completenessScore.toFixed(1)}%`,\n    formDataIncluded: true,\n    submissionTimestamp: formData.submittedAt,\n  },\n};\n\nlogExtraction('INFO', 'Final output prepared', {\n  companyName: output.companyName,\n  completenessScore: output.workflowMetadata.completenessScore,\n  isComplete: output.workflowMetadata.isProposalComplete,\n  sectionsFound: output.workflowMetadata.totalSectionsFound,\n  hasFormData: output.workflowMetadata.hasFormData,\n  dataSource: output.workflowMetadata.dataSource\n});\n\n// Return the extracted data to n8n\nreturn [{ json: output }];"
        },
        "id": "9307b732-86e1-4d47-8da6-ffaae48184d0",
        "name": "Extract Proposal Data Requirements",
        "type": "n8n-nodes-base.code",
        "typeVersion": 2,
        "position": [
          -512,
          160
        ]
      },
      {
        "parameters": {
          "options": {}
        },
        "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
        "typeVersion": 1,
        "position": [
          2016,
          624
        ],
        "id": "a3b86b16-ce79-45e4-b075-3261b0f932dc",
        "name": "Google Gemini Chat Model",
        "credentials": {
          "googlePalmApi": {
            "id": "p769RMRL1jNxNyEk",
            "name": "Google Gemini(PaLM) Api account"
          }
        }
      }
    ],
    "connections": {
      "Send Acknowledgment Email To Founder": {
        "main": [
          []
        ]
      },
      "Search Market Size & Trends": {
        "ai_tool": [
          [
            {
              "node": "Investment Analyst Report Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Search Founders linkedIn profile": {
        "ai_tool": [
          [
            {
              "node": "Investment Analyst Report Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Communication Agent": {
        "main": [
          [
            {
              "node": "Split Out1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "OpenAI Chat Model1": {
        "ai_languageModel": [
          [
            {
              "node": "Communication Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Get IC Team Member Email": {
        "ai_tool": [
          [
            {
              "node": "Communication Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser2": {
        "ai_outputParser": [
          [
            {
              "node": "Communication Agent",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Get List of Investment Criteria Questions": {
        "ai_tool": [
          [
            {
              "node": "Investment Analyst Report Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Split Out1": {
        "main": [
          [
            {
              "node": "Prep Emails",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prep Emails": {
        "main": [
          [
            {
              "node": "Send Acknowledgment Email To Founder",
              "type": "main",
              "index": 0
            },
            {
              "node": "Download file3",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Anthropic Chat Model3": {
        "ai_languageModel": [
          [
            {
              "node": "Send Proposal Rejection Email",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      },
      "Download file3": {
        "main": [
          [
            {
              "node": "Upload Investment Analysis Report2",
              "type": "main",
              "index": 0
            },
            {
              "node": "Send New Deal Assessment Report",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload Investment Analysis Report2": {
        "main": [
          []
        ]
      },
      "Code": {
        "main": [
          [
            {
              "node": "Send Rejection Email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Investment Analyst Report Agent": {
        "main": [
          [
            {
              "node": "Update Investment Report2",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Is Proposal Incomplete? (FIXED)": {
        "main": [
          [
            {
              "node": "Set INCOMPLETE Rejection",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Generate Yes/No answers scorecard questions1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Get deal scorecard results": {
        "ai_tool": [
          [
            {
              "node": "Investment Analyst Report Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Save Scorecard Results": {
        "main": [
          [
            {
              "node": "Use Investment Analysis Report Template 1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Report Data Prep": {
        "main": [
          [
            {
              "node": "Investment Analyst Report Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Use Investment Analysis Report Template 1": {
        "main": [
          [
            {
              "node": "Report Data Prep",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set INCOMPLETE Rejection": {
        "main": [
          [
            {
              "node": "Send Proposal Rejection Email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Send Proposal Rejection Email": {
        "main": [
          [
            {
              "node": "Code",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check Score Tier (FAIL vs MONITOR/PASS)": {
        "main": [
          [
            {
              "node": "Set FAIL Rejection",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Check MONITOR vs PASS",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check MONITOR vs PASS": {
        "main": [
          [
            {
              "node": "Set MONITOR Rejection",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Check BUY vs CONSIDER",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set FAIL Rejection": {
        "main": [
          [
            {
              "node": "Send Proposal Rejection Email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set MONITOR Rejection": {
        "main": [
          [
            {
              "node": "Send Proposal Rejection Email",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Check BUY vs CONSIDER": {
        "main": [
          [
            {
              "node": "Set BUY/STRONG_BUY Approval1",
              "type": "main",
              "index": 0
            }
          ],
          [
            {
              "node": "Set CONSIDER Approval1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Set CONSIDER Approval1": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Set BUY/STRONG_BUY Approval1": {
        "main": [
          [
            {
              "node": "Merge",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Prep Scorecard Data1": {
        "main": [
          [
            {
              "node": "Save Scorecard Results",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Generate Yes/No answers scorecard questions1": {
        "main": [
          [
            {
              "node": "Check Score Tier (FAIL vs MONITOR/PASS)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Merge": {
        "main": [
          [
            {
              "node": "Prep Scorecard Data1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Structured Output Parser": {
        "ai_outputParser": [
          [
            {
              "node": "Investment Analyst Report Agent",
              "type": "ai_outputParser",
              "index": 0
            }
          ]
        ]
      },
      "Update Investment Report2": {
        "main": [
          [
            {
              "node": "Communication Agent",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Use Investment Analysis Report Template": {
        "ai_tool": [
          [
            {
              "node": "Investment Analyst Report Agent",
              "type": "ai_tool",
              "index": 0
            }
          ]
        ]
      },
      "Data-Prep": {
        "main": [
          [
            {
              "node": "Extract Proposal Data Requirements",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Webhook": {
        "main": [
          [
            {
              "node": "Upload File",
              "type": "main",
              "index": 0
            },
            {
              "node": "Extract Text From PDF",
              "type": "main",
              "index": 0
            },
            {
              "node": "Form Data",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Upload File": {
        "main": [
          [
            {
              "node": "Merge1",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Text From PDF": {
        "main": [
          [
            {
              "node": "Merge1",
              "type": "main",
              "index": 1
            }
          ]
        ]
      },
      "Upload Deal2": {
        "main": [
          [
            {
              "node": "Form Data",
              "type": "main",
              "index": 0
            },
            {
              "node": "Extract Text From PDF",
              "type": "main",
              "index": 0
            },
            {
              "node": "Upload File",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Form Data": {
        "main": [
          [
            {
              "node": "Merge1",
              "type": "main",
              "index": 2
            }
          ]
        ]
      },
      "Merge1": {
        "main": [
          [
            {
              "node": "Data-Prep",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Extract Proposal Data Requirements": {
        "main": [
          [
            {
              "node": "Is Proposal Incomplete? (FIXED)",
              "type": "main",
              "index": 0
            }
          ]
        ]
      },
      "Google Gemini Chat Model": {
        "ai_languageModel": [
          [
            {
              "node": "Investment Analyst Report Agent",
              "type": "ai_languageModel",
              "index": 0
            }
          ]
        ]
      }
    },
    "pinData": {},
    "meta": {
      "templateCredsSetupCompleted": true,
      "instanceId": "d8c98c7335776e04cc3cf40527eb4aeb8cb18606c0e1a169e66c3bc56059553e"
    }
  }