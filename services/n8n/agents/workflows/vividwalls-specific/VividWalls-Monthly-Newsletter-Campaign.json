{
  "name": "VividWalls Monthly Newsletter Campaign",
  "nodes": [
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "months",
              "triggerAtDay": 1,
              "triggerAtHour": 9
            }
          ]
        }
      },
      "id": "schedule-trigger",
      "name": "Monthly Schedule (1st of Month)",
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1,
      "position": [250, 300]
    },
    {
      "parameters": {
        "agent": "Marketing Research Agent",
        "prompt": "Analyze the following data to determine the best content focus for this month's VividWalls newsletter:\n\n1. Current season and holidays\n2. Popular art trends\n3. Home decor trends\n4. Customer purchase patterns from last month\n5. Inventory highlights\n\nProvide recommendations for:\n- Newsletter theme\n- Featured collections\n- Content topics\n- Target audience segments",
        "options": {
          "systemPrompt": "You are the VividWalls Marketing Research Agent. Analyze market trends, customer behavior, and seasonal factors to recommend data-driven newsletter strategies that drive engagement and sales."
        }
      },
      "id": "research-agent",
      "name": "Marketing Research Agent",
      "type": "n8n-nodes-base.aiAgent",
      "typeVersion": 1,
      "position": [450, 300]
    },
    {
      "parameters": {
        "operation": "getProducts",
        "additionalFields": {
          "limit": 20,
          "status": "active",
          "sort": "best-selling"
        }
      },
      "id": "get-products",
      "name": "Get Best Selling Products",
      "type": "n8n-nodes-base.shopify",
      "typeVersion": 1,
      "position": [450, 450]
    },
    {
      "parameters": {
        "agent": "Marketing Campaign Agent",
        "prompt": "Create a monthly newsletter campaign strategy based on:\n\nResearch insights: {{ $node['research-agent'].json.recommendations }}\n\nBest selling products: {{ $node['get-products'].json }}\n\nDefine:\n1. Campaign name and theme\n2. Subject lines (A/B test variants)\n3. Content sections\n4. Product features\n5. Call-to-action strategy\n6. Audience segments",
        "options": {
          "systemPrompt": "You are the VividWalls Marketing Campaign Agent. Create compelling, conversion-focused newsletter campaigns that blend artistic storytelling with strategic product promotion."
        }
      },
      "id": "campaign-agent",
      "name": "Marketing Campaign Agent",
      "type": "n8n-nodes-base.aiAgent",
      "typeVersion": 1,
      "position": [650, 300]
    },
    {
      "parameters": {
        "operation": "get-file",
        "fileId": "{{ $env.FIGMA_EMAIL_TEMPLATE_ID }}",
        "options": {
          "version": "latest"
        }
      },
      "id": "get-figma-template",
      "name": "Get Figma Email Template",
      "type": "n8n-nodes-base.figmaMcp",
      "typeVersion": 1,
      "position": [850, 450]
    },
    {
      "parameters": {
        "agent": "Email Marketing Agent",
        "prompt": "Generate the complete newsletter content based on:\n\nCampaign strategy: {{ $node['campaign-agent'].json }}\nFigma template: {{ $node['get-figma-template'].json }}\n\nCreate:\n1. Compelling header copy\n2. Product showcase sections\n3. Artist spotlight or design tips\n4. Seasonal content\n5. Clear CTAs\n6. Footer with social links\n\nEnsure content matches VividWalls brand voice and visual style.",
        "options": {
          "systemPrompt": "You are the VividWalls Email Marketing Agent. Create visually stunning, engaging newsletter content that drives clicks and conversions while maintaining brand consistency."
        }
      },
      "id": "email-agent",
      "name": "Email Marketing Agent",
      "type": "n8n-nodes-base.aiAgent",
      "typeVersion": 1,
      "position": [850, 300]
    },
    {
      "parameters": {
        "operation": "create_listmonk_campaign",
        "name": "{{ $node['campaign-agent'].json.campaign_name }}",
        "subject": "{{ $node['campaign-agent'].json.subject_line_a }}",
        "lists": [1, 2, 3],
        "template_type": "monthly_newsletter",
        "content": "={{ $node['email-agent'].json.content }}",
        "schedule_type": "scheduled",
        "send_at": "={{ new Date().toISOString() }}",
        "tags": ["monthly", "{{ new Date().toLocaleString('default', { month: 'long' }).toLowerCase() }}"]
      },
      "id": "create-campaign",
      "name": "Create Listmonk Campaign",
      "type": "n8n-nodes-base.aiAgent",
      "typeVersion": 1,
      "position": [1050, 300]
    },
    {
      "parameters": {
        "channel": "#marketing",
        "text": "ðŸŽ¨ Monthly Newsletter Campaign Created!\n\nCampaign: {{ $node['campaign-agent'].json.campaign_name }}\nTheme: {{ $node['campaign-agent'].json.theme }}\nScheduled for: {{ new Date().toLocaleDateString() }}\n\nReview campaign: {{ $env.LISTMONK_URL }}/campaigns",
        "options": {
          "attachments": [
            {
              "color": "#6B46C1",
              "fields": [
                {
                  "title": "Subject Line",
                  "value": "{{ $node['campaign-agent'].json.subject_line_a }}",
                  "short": false
                },
                {
                  "title": "Target Segments",
                  "value": "{{ $node['campaign-agent'].json.segments.join(', ') }}",
                  "short": true
                },
                {
                  "title": "Featured Products",
                  "value": "{{ $node['campaign-agent'].json.featured_products.length }} products",
                  "short": true
                }
              ]
            }
          ]
        }
      },
      "id": "notify-slack",
      "name": "Notify Team",
      "type": "n8n-nodes-base.slack",
      "typeVersion": 1,
      "position": [1250, 300]
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "INSERT INTO newsletter_campaigns (campaign_name, trigger_type, seo_keywords, figma_template_id, content, sent_date, metrics) VALUES ($1, $2, $3, $4, $5, $6, $7)",
        "additionalFields": {
          "queryParams": "={{ $node['campaign-agent'].json.campaign_name }},scheduled,{{ JSON.stringify($node['research-agent'].json.keywords) }},{{ $env.FIGMA_EMAIL_TEMPLATE_ID }},{{ JSON.stringify($node['email-agent'].json) }},{{ new Date().toISOString() }},{}"
        }
      },
      "id": "log-campaign",
      "name": "Log Campaign to DB",
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 1,
      "position": [1250, 450]
    }
  ],
  "connections": {
    "Monthly Schedule (1st of Month)": {
      "main": [
        [
          {
            "node": "Marketing Research Agent",
            "type": "main",
            "index": 0
          },
          {
            "node": "Get Best Selling Products",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Marketing Research Agent": {
      "main": [
        [
          {
            "node": "Marketing Campaign Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Best Selling Products": {
      "main": [
        [
          {
            "node": "Marketing Campaign Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Marketing Campaign Agent": {
      "main": [
        [
          {
            "node": "Get Figma Email Template",
            "type": "main",
            "index": 0
          },
          {
            "node": "Email Marketing Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Figma Email Template": {
      "main": [
        [
          {
            "node": "Email Marketing Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Email Marketing Agent": {
      "main": [
        [
          {
            "node": "Create Listmonk Campaign",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create Listmonk Campaign": {
      "main": [
        [
          {
            "node": "Notify Team",
            "type": "main",
            "index": 0
          },
          {
            "node": "Log Campaign to DB",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [
    {
      "name": "newsletter",
      "createdAt": "2024-01-01T00:00:00.000Z"
    },
    {
      "name": "scheduled",
      "createdAt": "2024-01-01T00:00:00.000Z"
    },
    {
      "name": "monthly-campaign",
      "createdAt": "2024-01-01T00:00:00.000Z"
    }
  ]
}